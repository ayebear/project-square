!function(){"use strict";function e(e,t){if(e&&"function"==typeof e[t]){for(var n,i=arguments.length,r=Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];return(n=e[t]).call.apply(n,[e].concat(r))}}function t(e){return"function"==typeof e}function n(e,t){for(var n=-1,i=t.length,r=e.length;++n<i;)e[r+n]=t[n];return e}function i(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function r(e,t){return t={exports:{}},e(t,t.exports),t.exports}function o(e){var t=rn.call(e,an),n=e[an];try{e[an]=void 0;var i=!0}catch(e){}var r=on.call(e);return i&&(t?e[an]=n:delete e[an]),r}function a(e){return ln.call(e)}function s(e){return null==e?void 0===e?hn:dn:fn&&fn in Object(e)?sn(e):cn(e)}function u(e){return null!=e&&"object"==(void 0===e?"undefined":It(e))}function l(e){return vn(e)&&pn(e)==_n}function c(e){return An(e)||wn(e)||!!(Sn&&e&&e[Sn])}function d(e,t,n,i,r){var o=-1,a=e.length;for(n||(n=zn),r||(r=[]);++o<a;){var s=e[o];t>0&&n(s)?t>1?d(s,t-1,n,i,r):Xt(r,s):i||(r[r.length]=s)}return r}function h(e,t){for(var n=-1,i=null==e?0:e.length,r=Array(i);++n<i;)r[n]=t(e[n],n,e);return r}function f(){this.__data__=[],this.size=0}function p(e,t){return e===t||e!==e&&t!==t}function v(e,t){for(var n=e.length;n--;)if(Tn(e[n][0],t))return n;return-1}function _(e){var t=this.__data__,n=En(t,e);return!(n<0)&&(n==t.length-1?t.pop():Mn.call(t,n,1),--this.size,!0)}function y(e){var t=this.__data__,n=En(t,e);return n<0?void 0:t[n][1]}function m(e){return En(this.__data__,e)>-1}function g(e,t){var n=this.__data__,i=En(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}function b(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function k(){this.__data__=new Fn,this.size=0}function w(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function x(e){return this.__data__.get(e)}function A(e){return this.__data__.has(e)}function S(e){var t=void 0===e?"undefined":It(e);return null!=e&&("object"==t||"function"==t)}function z(e){if(!Nn(e))return!1;var t=pn(e);return t==Hn||t==Vn||t==Un||t==Kn}function O(e){return!!Qn&&Qn in e}function I(e){if(null!=e){try{return ei.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function P(e){return!(!Nn(e)||Yn(e))&&(Xn(e)?ui:ii).test(ti(e))}function T(e,t){return null==e?void 0:e[t]}function E(e,t){var n=ci(e,t);return li(n)?n:void 0}function j(){this.__data__=vi?vi(null):{},this.size=0}function M(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function D(e){var t=this.__data__;if(vi){var n=t[e];return n===mi?void 0:n}return bi.call(t,e)?t[e]:void 0}function C(e){var t=this.__data__;return vi?void 0!==t[e]:xi.call(t,e)}function L(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=vi&&void 0===t?Si:t,this}function B(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function F(){this.size=0,this.__data__={hash:new Oi,map:new(fi||Fn),string:new Oi}}function W(e){var t=void 0===e?"undefined":It(e);return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function G(e,t){var n=e.__data__;return Pi(t)?n["string"==typeof t?"string":"hash"]:n.map}function q(e){var t=Ti(this,e).delete(e);return this.size-=t?1:0,t}function R(e){return Ti(this,e).get(e)}function N(e){return Ti(this,e).has(e)}function U(e,t){var n=Ti(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}function H(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function V(e,t){var n=this.__data__;if(n instanceof Fn){var i=n.__data__;if(!fi||i.length<Li-1)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new Ci(i)}return n.set(e,t),this.size=n.size,this}function K(e){var t=this.__data__=new Fn(e);this.size=t.size}function X(e){return this.__data__.set(e,Wi),this}function $(e){return this.__data__.has(e)}function J(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Ci;++t<n;)this.add(e[t])}function Q(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}function Y(e,t){return e.has(t)}function Z(e,t,n,i,r,o){var a=n&Hi,s=e.length,u=t.length;if(s!=u&&!(a&&u>s))return!1;var l=o.get(e);if(l&&o.get(t))return l==t;var c=-1,d=!0,h=n&Vi?new Ri:void 0;for(o.set(e,t),o.set(t,e);++c<s;){var f=e[c],p=t[c];if(i)var v=a?i(p,f,c,t,e,o):i(f,p,c,e,t,o);if(void 0!==v){if(v)continue;d=!1;break}if(h){if(!Ni(t,function(e,t){if(!Ui(h,t)&&(f===e||r(f,e,n,i,o)))return h.push(t)})){d=!1;break}}else if(f!==p&&!r(f,p,n,i,o)){d=!1;break}}return o.delete(e),o.delete(t),d}function ee(e){var t=-1,n=Array(e.size);return e.forEach(function(e,i){n[++t]=[i,e]}),n}function te(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function ne(e,t,n,i,r,o,a){switch(n){case cr:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case lr:return!(e.byteLength!=t.byteLength||!o(new $i(e),new $i(t)));case er:case tr:case rr:return Tn(+e,+t);case nr:return e.name==t.name&&e.message==t.message;case or:case sr:return e==t+"";case ir:var s=Ji;case ar:var u=i&Yi;if(s||(s=Qi),e.size!=t.size&&!u)return!1;var l=a.get(e);if(l)return l==t;i|=Zi,a.set(e,t);var c=Ki(s(e),s(t),i,r,o,a);return a.delete(e),c;case ur:if(hr)return hr.call(e)==hr.call(t)}return!1}function ie(e,t,n){var i=t(e);return An(e)?i:Xt(i,n(e))}function re(e,t){for(var n=-1,i=null==e?0:e.length,r=0,o=[];++n<i;){var a=e[n];t(a,n,e)&&(o[r++]=a)}return o}function oe(){return[]}function ae(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}function se(){return!1}function ue(e,t){return!!(t=null==t?Sr:t)&&("number"==typeof e||zr.test(e))&&e>-1&&e%1==0&&e<t}function le(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Ir}function ce(e){return vn(e)&&Pr(e.length)&&!!Tr[pn(e)]}function de(e){return function(t){return e(t)}}function he(e,t){var n=An(e),i=!n&&wn(e),r=!n&&!i&&Ar(e),o=!n&&!i&&!r&&Lr(e),a=n||i||r||o,s=a?wr(e.length,String):[],u=s.length;for(var l in e)!t&&!Fr.call(e,l)||a&&("length"==l||r&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Or(l,u))||s.push(l);return s}function fe(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Gr)}function pe(e,t){return function(n){return e(t(n))}}function ve(e){if(!qr(e))return Ur(e);var t=[];for(var n in Object(e))Vr.call(e,n)&&"constructor"!=n&&t.push(n);return t}function _e(e){return null!=e&&Pr(e.length)&&!Xn(e)}function ye(e){return Xr(e)?Wr(e):Kr(e)}function me(e){return pr(e,$r,kr)}function ge(e,t,n,i,r,o){var a=n&Qr,s=Jr(e),u=s.length;if(u!=Jr(t).length&&!a)return!1;for(var l=u;l--;){var c=s[l];if(!(a?c in t:Zr.call(t,c)))return!1}var d=o.get(e);if(d&&o.get(t))return d==t;var h=!0;o.set(e,t),o.set(t,e);for(var f=a;++l<u;){c=s[l];var p=e[c],v=t[c];if(i)var _=a?i(v,p,c,t,e,o):i(p,v,c,e,t,o);if(!(void 0===_?p===v||r(p,v,n,i,o):_)){h=!1;break}f||(f="constructor"==c)}if(h&&!f){var y=e.constructor,m=t.constructor;y!=m&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof m&&m instanceof m)&&(h=!1)}return o.delete(e),o.delete(t),h}function be(e,t,n,i,r,o){var a=An(e),s=An(t),u=a?go:_o(e),l=s?go:_o(t);u=u==mo?bo:u,l=l==mo?bo:l;var c=u==bo,d=l==bo,h=u==l;if(h&&Ar(e)){if(!Ar(t))return!1;a=!0,c=!1}if(h&&!c)return o||(o=new Fi),a||Lr(e)?Ki(e,t,n,i,r,o):fr(e,t,u,n,i,r,o);if(!(n&yo)){var f=c&&wo.call(e,"__wrapped__"),p=d&&wo.call(t,"__wrapped__");if(f||p){var v=f?e.value():e,_=p?t.value():t;return o||(o=new Fi),r(v,_,n,i,o)}}return!!h&&(o||(o=new Fi),eo(e,t,n,i,r,o))}function ke(e,t,n,i,r){return e===t||(null==e||null==t||!vn(e)&&!vn(t)?e!==e&&t!==t:xo(e,t,n,i,ke,r))}function we(e,t,n,i){var r=n.length,o=r,a=!i;if(null==e)return!o;for(e=Object(e);r--;){var s=n[r];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++r<o;){s=n[r];var u=s[0],l=e[u],c=s[1];if(a&&s[2]){if(void 0===l&&!(u in e))return!1}else{var d=new Fi;if(i)var h=i(l,c,u,e,t,d);if(!(void 0===h?Ao(c,l,So|zo,i,d):h))return!1}}return!0}function xe(e){return e===e&&!Nn(e)}function Ae(e){for(var t=$r(e),n=t.length;n--;){var i=t[n],r=e[i];t[n]=[i,r,Io(r)]}return t}function Se(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}function ze(e){var t=Po(e);return 1==t.length&&t[0][2]?To(t[0][0],t[0][1]):function(n){return n===e||Oo(n,e,t)}}function Oe(e){return"symbol"==(void 0===e?"undefined":It(e))||vn(e)&&pn(e)==jo}function Ie(e,t){if(An(e))return!1;var n=void 0===e?"undefined":It(e);return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Mo(e))||(Co.test(e)||!Do.test(e)||null!=t&&e in Object(t))}function Pe(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(Bo);var n=function n(){var i=arguments,r=t?t.apply(this,i):i[0],o=n.cache;if(o.has(r))return o.get(r);var a=e.apply(this,i);return n.cache=o.set(r,a)||o,a};return n.cache=new(Pe.Cache||Ci),n}function Te(e){var t=Fo(e,function(e){return n.size===Wo&&n.clear(),e}),n=t.cache;return t}function Ee(e){if("string"==typeof e)return e;if(An(e))return In(e,Ee)+"";if(Mo(e))return Xo?Xo.call(e):"";var t=e+"";return"0"==t&&1/e==-Vo?"-0":t}function je(e){return null==e?"":$o(e)}function Me(e,t){return An(e)?e:Lo(e,t)?[e]:Ho(Jo(e))}function De(e){if("string"==typeof e||Mo(e))return e;var t=e+"";return"0"==t&&1/e==-Yo?"-0":t}function Ce(e,t){t=Qo(t,e);for(var n=0,i=t.length;null!=e&&n<i;)e=e[Zo(t[n++])];return n&&n==i?e:void 0}function Le(e,t,n){var i=null==e?void 0:ea(e,t);return void 0===i?n:i}function Be(e,t){return null!=e&&t in Object(e)}function Fe(e,t,n){t=Qo(t,e);for(var i=-1,r=t.length,o=!1;++i<r;){var a=Zo(t[i]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++i!=r?o:!!(r=null==e?0:e.length)&&Pr(r)&&Or(a,r)&&(An(e)||wn(e))}function We(e,t){return null!=e&&ia(e,t,na)}function Ge(e,t){return Lo(e)&&Io(t)?To(Zo(e),t):function(n){var i=ta(n,e);return void 0===i&&i===t?ra(n,e):Ao(t,i,oa|aa)}}function qe(e){return e}function Re(e){return function(t){return null==t?void 0:t[e]}}function Ne(e){return function(t){return ea(t,e)}}function Ue(e){return Lo(e)?la(Zo(e)):ca(e)}function He(e){return"function"==typeof e?e:null==e?ua:"object"==(void 0===e?"undefined":It(e))?An(e)?sa(e[0],e[1]):Eo(e):da(e)}function Ve(e){return function(t,n,i){for(var r=-1,o=Object(t),a=i(t),s=a.length;s--;){var u=a[e?s:++r];if(!1===n(o[u],u,o))break}return t}}function Ke(e,t){return e&&va(e,t,$r)}function Xe(e,t){return function(n,i){if(null==n)return n;if(!Xr(n))return e(n,i);for(var r=n.length,o=t?r:-1,a=Object(n);(t?o--:++o<r)&&!1!==i(a[o],o,a););return n}}function $e(e,t){var n=-1,i=Xr(e)?Array(e.length):[];return ga(e,function(e,r,o){i[++n]=t(e,r,o)}),i}function Je(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}function Qe(e,t){if(e!==t){var n=void 0!==e,i=null===e,r=e===e,o=Mo(e),a=void 0!==t,s=null===t,u=t===t,l=Mo(t);if(!s&&!l&&!o&&e>t||o&&a&&u&&!s&&!l||i&&a&&u||!n&&u||!r)return 1;if(!i&&!o&&!l&&e<t||l&&n&&r&&!i&&!o||s&&n&&r||!a&&r||!u)return-1}return 0}function Ye(e,t,n){for(var i=-1,r=e.criteria,o=t.criteria,a=r.length,s=n.length;++i<a;){var u=wa(r[i],o[i]);if(u){if(i>=s)return u;return u*("desc"==n[i]?-1:1)}}return e.index-t.index}function Ze(e,t,n){var i=-1;t=In(t.length?t:[ua],jr(ha));var r=ba(e,function(e,n,r){return{criteria:In(t,function(t){return t(e)}),index:++i,value:e}});return ka(r,function(e,t){return xa(e,t,n)})}function et(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function tt(e,t,n){return t=za(void 0===t?e.length-1:t,0),function(){for(var i=arguments,r=-1,o=za(i.length-t,0),a=Array(o);++r<o;)a[r]=i[t+r];r=-1;for(var s=Array(t+1);++r<t;)s[r]=i[r];return s[t]=n(a),Sa(e,this,s)}}function nt(e){return function(){return e}}function it(e){var t=0,n=0;return function(){var i=Ca(),r=Da-(i-n);if(n=i,r>0){if(++t>=Ma)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function rt(e,t){return Fa(Oa(e,t,ua),e+"")}function ot(e,t,n){if(!Nn(n))return!1;var i=void 0===t?"undefined":It(t);return!!("number"==i?Xr(n)&&Or(t,n.length):"string"==i&&t in n)&&Tn(n[t],e)}function at(e){return(e.x||0)+","+(e.y||0)}function st(e){var t=e.split(",");return t.length=2,{x:parseInt(t[0])||0,y:parseInt(t[1])||0}}function ut(e){e.children.sort(function(e,t){return e.zIndex=e.zIndex||0,t.zIndex=t.zIndex||0,e.zIndex-t.zIndex})}function lt(e,t){if(e&&"debug"in e&&console.log("invoke("+t+"): "+e.debug),e&&"function"==typeof e[t]){for(var n,i=arguments.length,r=Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];return(n=e[t]).call.apply(n,[e].concat(r))}}function ct(e){if("function"==typeof e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return e.apply(void 0,n)}}function dt(e,t){return(e%t+t)%t}function ht(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;return{x:e.x+(t.x-e.x)*n,y:e.y+(t.y-e.y)*n}}function ft(e){var t=void 0;return e.text?(t=new PIXI.Text(e.text,e.style),console.warn("Memory leak will occur soon, do not use PIXI.Text objects...")):e.texture?(t=new PIXI.Sprite(e.texture),t.anchor.x=e.anchor.x,t.anchor.y=e.anchor.y,t.tint=e.tint):t=new PIXI.Container,t.x=e.x,t.y=e.y,t.scale.x=e.scale.x,t.scale.y=e.scale.y,t.zIndex=e.zIndex,t.alpha=e.alpha,t.visible=e.visible,t}function pt(e){var t=ft(e);if(e.children){var n=!0,i=!1,r=void 0;try{for(var o,a=e.children[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;t.addChild(pt(s))}}catch(e){i=!0,r=e}finally{try{!n&&a.return&&a.return()}finally{if(i)throw r}}}return t}function vt(e,t){return Math.floor(Math.random()*(t-e))+e}function _t(e){if(e.length)return e[vt(0,e.length)]}function yt(e,t){var n="floor",i=e.find(t,void 0,"terrain");return i&&(n=i.get("terrain")),n}function mt(e){return Ra(e,function(e){return e.has("sprite")?e.get("sprite").zIndex||0:0})}function gt(e){return!!(e&&e.valid()&&e.has("timeImmune"))}function bt(){var e=localStorage.getItem("playerPosition");return e?JSON.parse(atob(e)):{x:128,y:128}}function kt(e){localStorage.setItem("playerPosition",btoa(JSON.stringify(e)))}function wt(e,t){for(var n=e.get("position"),i=arguments.length,r=Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];return r.map(function(e){var i={x:n.x+e[0],y:n.y+e[1]};return is.has(i,t)})}function xt(e){return is.has(e,"energySource")}function At(){document.body.appendChild(Za.view),PIXI.loader.add("textures","data/textures-1.json").load(St)}function St(e,t){Ya.initialize(),Za.ticker.add(function(e){var t=Za.ticker.elapsedMS/1e3;Ya.run(t)})}var zt=e,Ot={invoke:zt},It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pt=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Tt=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),Et=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},jt=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},Mt=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},Dt=function e(t,n,i,r){var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var a=Object.getPrototypeOf(t);null!==a&&e(a,n,i,r)}else if("value"in o&&o.writable)o.value=i;else{var s=o.set;void 0!==s&&s.call(r,i)}return i},Ct=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},Lt=Ot.invoke,Bt=function(){function e(t,n){Pt(this,e),this.world=t,this.id=n,this.data={},this.valid()&&this.world.index.add(this)}return Tt(e,[{key:"has",value:function(){for(var e=this,t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];return[].concat(n).every(function(t){return t in e.data})}},{key:"get",value:function(e){if(this.has(e))return this.data[e]}},{key:"access",value:function(e){return this.has(e)||this.set(e),this.data[e]}},{key:"set",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return this.valid()&&e in this.world.components?(this.data[e]=new(Function.prototype.bind.apply(this.world.components[e],[null].concat(n))),Lt.apply(void 0,[this.data[e],"onCreate",this].concat(n))):n.length>0?this.data[e]=n[0]:this.data[e]={},this.valid()&&this.world.index.add(this,e),this}},{key:"update",value:function(e,t){var n=this.access(e);for(var i in t)n[i]=t[i];return this}},{key:"remove",value:function(e){return e in this.data&&(this.valid()&&this.world.index.remove(this,e),Lt(this.data[e],"onRemove"),delete this.data[e]),this}},{key:"removeAll",value:function(){for(var e in this.data)this.remove(e);this.data={}}},{key:"destroy",value:function(){this.removeAll(),this.valid()&&(this.world.index.remove(this),delete this.world.entities[this.id],this.id=void 0)}},{key:"valid",value:function(){return this.world&&void 0!==this.id}},{key:"toString",value:function(){return String(this.id)}},{key:"toJSON",value:function(){return JSON.stringify(this.data)}},{key:"fromJSON",value:function(e){var t=JSON.parse(e);for(var n in t){var i=this.access(n);"function"==typeof i.fromJSON?i.fromJSON(t[n]):this.update(n,t[n])}return this}},{key:"attach",value:function(e){e&&!this.valid()&&(this.world=e,this.id=this.world.idCounter++,this.world.entities[this.id]=this,this.world.index.addEntity(this))}},{key:"detach",value:function(){this.valid()&&(this.world.index.removeEntity(this),delete this.world.entities[this.id],this.id=void 0,this.world=void 0)}}]),e}(),Ft=Bt,Wt={Entity:Ft},Gt=function(){function e(t){Pt(this,e),this.clear(t)}return Tt(e,[{key:"clear",value:function(e){this.entities=e,this.index={}}},{key:"query",value:function(e){var t=this.hashComponents(e);return t in this.index?this.index[t].entities:this.build(t,e).entities}},{key:"hashComponents",value:function(e){return e.concat().sort().join(":")}},{key:"build",value:function(e,t){var n=new Map;for(var i in this.entities){var r=this.entities[i];r.has.apply(r,Ct(t))&&n.set(r.toString(),r)}return this.index[e]={components:new Set(t),entities:n}}},{key:"apply",value:function(e,t){var n=this;for(var i in this.index)!function(i){var r=n.index[i],o=e.some(function(e){return r.components.has(e)}),a=(void 0==e||0===e.length)&&0==r.components.size;(o||a)&&t(r.entities)}(i)}},{key:"add",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.apply(n,function(t){t.set(e.toString(),e)})}},{key:"remove",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.apply(n,function(t){t.delete(e.toString())})}},{key:"addEntity",value:function(e){this.add.apply(this,[e].concat(Ct(Object.keys(e.data))))}},{key:"removeEntity",value:function(e){this.remove.apply(this,[e].concat(Ct(Object.keys(e.data))))}}]),e}(),qt=Gt,Rt={Index:qt},Nt=Ot.invoke,Ut=Wt.Entity,Ht=Rt.Index,Vt=function(){function e(){Pt(this,e),this.systems=[],this.entities={},this.components={},this.entityTemplates={},this.idCounter=1,this.index=new Ht(this.entities)}return Tt(e,[{key:"clear",value:function(){for(var e in this.entities){var t=this.entities[e];for(var n in t.data){var i=t.data[n];"function"==typeof i.onRemove&&i.onRemove()}}this.entities={},this.index.clear(this.entities)}},{key:"component",value:function(e,t){if("function"==typeof t)return this.components[e]=t,e}},{key:"entity",value:function(e){var t=this.idCounter++,n=new Ut(this,t);if(e&&e in this.entityTemplates){var i=this.entityTemplates[e];for(var r in i){var o=JSON.parse(i[r]);n.update(r,o)}}return this.entities[t]=n,n}},{key:"system",value:function(e,n){if(t(n)){for(var i=arguments.length,r=Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];var a=new(Function.prototype.bind.apply(n,[null].concat(r)));return a.components=e,this.systems.push(a),this.systems.length-1}}},{key:"initialize",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=!0,r=!1,o=void 0;try{for(var a,s=this.systems[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value;Nt.apply(void 0,[u,"initialize"].concat(t))}}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}}},{key:"run",value:function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=!0,o=!1,a=void 0;try{for(var s,u=this.systems[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var l=s.value;Nt.apply(void 0,[l,"pre"].concat(n)),t(l.every)&&this.every.apply(this,[l.components,l.every.bind(l)].concat(n)),Nt.apply(void 0,[l,"post"].concat(n))}}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}}},{key:"every",value:function(e,n){var i=this.index.query(e);if(t(n)){for(var r=arguments.length,o=Array(r>2?r-2:0),a=2;a<r;a++)o[a-2]=arguments[a];var s=!0,u=!1,l=void 0;try{for(var c,d=i.values()[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;!function(t){if(t.has.apply(t,Ct(e))){var i=e.map(function(e){return t.get(e)});n.apply(void 0,Ct(i).concat([t],o))}}(h)}}catch(e){u=!0,l=e}finally{try{!s&&d.return&&d.return()}finally{if(u)throw l}}}return i.values()}},{key:"get",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return[].concat(Ct(this.every([].concat(t))))}},{key:"prototype",value:function(e){var t=0;if("string"==typeof e&&(e=JSON.parse(e)),"object"===(void 0===e?"undefined":It(e)))for(var n in e){var i=e[n],r={};for(var o in i)r[o]=JSON.stringify(i[o]);this.entityTemplates[n]=r,++t}return t}}]),e}(),Kt=Vt,Xt=n,$t="object"==("undefined"==typeof global?"undefined":It(global))&&global&&global.Object===Object&&global,Jt=$t,Qt="object"==("undefined"==typeof self?"undefined":It(self))&&self&&self.Object===Object&&self,Yt=Jt||Qt||Function("return this")(),Zt=Yt,en=Zt.Symbol,tn=en,nn=Object.prototype,rn=nn.hasOwnProperty,on=nn.toString,an=tn?tn.toStringTag:void 0,sn=o,un=Object.prototype,ln=un.toString,cn=a,dn="[object Null]",hn="[object Undefined]",fn=tn?tn.toStringTag:void 0,pn=s,vn=u,_n="[object Arguments]",yn=l,mn=Object.prototype,gn=mn.hasOwnProperty,bn=mn.propertyIsEnumerable,kn=yn(function(){return arguments}())?yn:function(e){return vn(e)&&gn.call(e,"callee")&&!bn.call(e,"callee")},wn=kn,xn=Array.isArray,An=xn,Sn=tn?tn.isConcatSpreadable:void 0,zn=c,On=d,In=h,Pn=f,Tn=p,En=v,jn=Array.prototype,Mn=jn.splice,Dn=_,Cn=y,Ln=m,Bn=g;b.prototype.clear=Pn,b.prototype.delete=Dn,b.prototype.get=Cn,b.prototype.has=Ln,b.prototype.set=Bn;var Fn=b,Wn=k,Gn=w,qn=x,Rn=A,Nn=S,Un="[object AsyncFunction]",Hn="[object Function]",Vn="[object GeneratorFunction]",Kn="[object Proxy]",Xn=z,$n=Zt["__core-js_shared__"],Jn=$n,Qn=function(){var e=/[^.]+$/.exec(Jn&&Jn.keys&&Jn.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Yn=O,Zn=Function.prototype,ei=Zn.toString,ti=I,ni=/[\\^$.*+?()[\]{}|]/g,ii=/^\[object .+?Constructor\]$/,ri=Function.prototype,oi=Object.prototype,ai=ri.toString,si=oi.hasOwnProperty,ui=RegExp("^"+ai.call(si).replace(ni,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),li=P,ci=T,di=E,hi=di(Zt,"Map"),fi=hi,pi=di(Object,"create"),vi=pi,_i=j,yi=M,mi="__lodash_hash_undefined__",gi=Object.prototype,bi=gi.hasOwnProperty,ki=D,wi=Object.prototype,xi=wi.hasOwnProperty,Ai=C,Si="__lodash_hash_undefined__",zi=L;B.prototype.clear=_i,B.prototype.delete=yi,B.prototype.get=ki,B.prototype.has=Ai,B.prototype.set=zi;var Oi=B,Ii=F,Pi=W,Ti=G,Ei=q,ji=R,Mi=N,Di=U;H.prototype.clear=Ii,H.prototype.delete=Ei,H.prototype.get=ji,H.prototype.has=Mi,H.prototype.set=Di;var Ci=H,Li=200,Bi=V;K.prototype.clear=Wn,K.prototype.delete=Gn,K.prototype.get=qn,K.prototype.has=Rn,K.prototype.set=Bi;var Fi=K,Wi="__lodash_hash_undefined__",Gi=X,qi=$;J.prototype.add=J.prototype.push=Gi,J.prototype.has=qi;var Ri=J,Ni=Q,Ui=Y,Hi=1,Vi=2,Ki=Z,Xi=Zt.Uint8Array,$i=Xi,Ji=ee,Qi=te,Yi=1,Zi=2,er="[object Boolean]",tr="[object Date]",nr="[object Error]",ir="[object Map]",rr="[object Number]",or="[object RegExp]",ar="[object Set]",sr="[object String]",ur="[object Symbol]",lr="[object ArrayBuffer]",cr="[object DataView]",dr=tn?tn.prototype:void 0,hr=dr?dr.valueOf:void 0,fr=ne,pr=ie,vr=re,_r=oe,yr=Object.prototype,mr=yr.propertyIsEnumerable,gr=Object.getOwnPropertySymbols,br=gr?function(e){return null==e?[]:(e=Object(e),vr(gr(e),function(t){return mr.call(e,t)}))}:_r,kr=br,wr=ae,xr=se,Ar=r(function(e,t){var n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,r=i&&i.exports===n,o=r?Zt.Buffer:void 0,a=o?o.isBuffer:void 0,s=a||xr;e.exports=s}),Sr=9007199254740991,zr=/^(?:0|[1-9]\d*)$/,Or=ue,Ir=9007199254740991,Pr=le,Tr={};Tr["[object Float32Array]"]=Tr["[object Float64Array]"]=Tr["[object Int8Array]"]=Tr["[object Int16Array]"]=Tr["[object Int32Array]"]=Tr["[object Uint8Array]"]=Tr["[object Uint8ClampedArray]"]=Tr["[object Uint16Array]"]=Tr["[object Uint32Array]"]=!0,Tr["[object Arguments]"]=Tr["[object Array]"]=Tr["[object ArrayBuffer]"]=Tr["[object Boolean]"]=Tr["[object DataView]"]=Tr["[object Date]"]=Tr["[object Error]"]=Tr["[object Function]"]=Tr["[object Map]"]=Tr["[object Number]"]=Tr["[object Object]"]=Tr["[object RegExp]"]=Tr["[object Set]"]=Tr["[object String]"]=Tr["[object WeakMap]"]=!1;var Er=ce,jr=de,Mr=r(function(e,t){var n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,r=i&&i.exports===n,o=r&&Jt.process,a=function(){try{return o&&o.binding&&o.binding("util")}catch(e){}}();e.exports=a}),Dr=Mr&&Mr.isTypedArray,Cr=Dr?jr(Dr):Er,Lr=Cr,Br=Object.prototype,Fr=Br.hasOwnProperty,Wr=he,Gr=Object.prototype,qr=fe,Rr=pe,Nr=Rr(Object.keys,Object),Ur=Nr,Hr=Object.prototype,Vr=Hr.hasOwnProperty,Kr=ve,Xr=_e,$r=ye,Jr=me,Qr=1,Yr=Object.prototype,Zr=Yr.hasOwnProperty,eo=ge,to=di(Zt,"DataView"),no=to,io=di(Zt,"Promise"),ro=io,oo=di(Zt,"Set"),ao=oo,so=di(Zt,"WeakMap"),uo=so,lo=ti(no),co=ti(fi),ho=ti(ro),fo=ti(ao),po=ti(uo),vo=pn;(no&&"[object DataView]"!=vo(new no(new ArrayBuffer(1)))||fi&&"[object Map]"!=vo(new fi)||ro&&"[object Promise]"!=vo(ro.resolve())||ao&&"[object Set]"!=vo(new ao)||uo&&"[object WeakMap]"!=vo(new uo))&&(vo=function(e){var t=pn(e),n="[object Object]"==t?e.constructor:void 0,i=n?ti(n):"";if(i)switch(i){case lo:return"[object DataView]";case co:return"[object Map]";case ho:return"[object Promise]";case fo:return"[object Set]";case po:return"[object WeakMap]"}return t});var _o=vo,yo=1,mo="[object Arguments]",go="[object Array]",bo="[object Object]",ko=Object.prototype,wo=ko.hasOwnProperty,xo=be,Ao=ke,So=1,zo=2,Oo=we,Io=xe,Po=Ae,To=Se,Eo=ze,jo="[object Symbol]",Mo=Oe,Do=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Co=/^\w*$/,Lo=Ie,Bo="Expected a function";Pe.Cache=Ci;var Fo=Pe,Wo=500,Go=Te,qo=/^\./,Ro=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,No=/\\(\\)?/g,Uo=Go(function(e){var t=[];return qo.test(e)&&t.push(""),e.replace(Ro,function(e,n,i,r){t.push(i?r.replace(No,"$1"):n||e)}),t}),Ho=Uo,Vo=1/0,Ko=tn?tn.prototype:void 0,Xo=Ko?Ko.toString:void 0,$o=Ee,Jo=je,Qo=Me,Yo=1/0,Zo=De,ea=Ce,ta=Le,na=Be,ia=Fe,ra=We,oa=1,aa=2,sa=Ge,ua=qe,la=Re,ca=Ne,da=Ue,ha=He,fa=Ve,pa=fa(),va=pa,_a=Ke,ya=Xe,ma=ya(_a),ga=ma,ba=$e,ka=Je,wa=Qe,xa=Ye,Aa=Ze,Sa=et,za=Math.max,Oa=tt,Ia=nt,Pa=function(){try{var e=di(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Ta=Pa,Ea=Ta?function(e,t){return Ta(e,"toString",{configurable:!0,enumerable:!1,value:Ia(t),writable:!0})}:ua,ja=Ea,Ma=800,Da=16,Ca=Date.now,La=it,Ba=La(ja),Fa=Ba,Wa=rt,Ga=ot,qa=Wa(function(e,t){if(null==e)return[];var n=t.length;return n>1&&Ga(e,t[0],t[1])?t=[]:n>2&&Ga(t[0],t[1],t[2])&&(t=[t[0]]),Aa(e,On(t,1),[])}),Ra=qa;Array.prototype.top=function(){if(this.length>=1)return this[this.length-1]};var Na=function(){function e(){Pt(this,e),this.gameSize=this.getGameSize()}return Tt(e,[{key:"clear",value:function(){this.bounds=void 0}},{key:"update",value:function(){this.gameSize=this.getGameSize(),this.bounds=this.getBounds(),this.puzzleCenter=this.getPuzzleCenter(this.bounds),this.puzzleSize=this.getPuzzleSize(this.bounds)}},{key:"getGameSize",value:function(){return{width:window.innerWidth,height:window.innerHeight}}},{key:"getBounds",value:function(){var e={};return e.upperLeft={x:1/0,y:1/0},e.bottomRight={x:-1/0,y:-1/0},Ya.every(["partOfLayer","position"],function(t,n){e.upperLeft.x=Math.min(e.upperLeft.x,n.x),e.upperLeft.y=Math.min(e.upperLeft.y,n.y),e.bottomRight.x=Math.max(e.bottomRight.x,n.x),e.bottomRight.y=Math.max(e.bottomRight.y,n.y)}),e.size={width:1+e.bottomRight.x-e.upperLeft.x,height:1+e.bottomRight.y-e.upperLeft.y},e}},{key:"getPuzzleCenter",value:function(e){return rs.getVisualPosition({x:(e.bottomRight.x+e.upperLeft.x)/2,y:(e.bottomRight.y+e.upperLeft.y)/2})}},{key:"getPuzzleSize",value:function(e){var t=rs.getVisualPosition(this.bounds.upperLeft),n=rs.getVisualPosition({x:this.bounds.bottomRight.x+1,y:this.bounds.bottomRight.y+1});return{width:n.x-t.x,height:n.y-t.y}}},{key:"getZeroPosition",value:function(e){return{x:e.x-this.bounds.upperLeft.x,y:e.y-this.bounds.upperLeft.y}}},{key:"getFullPosition",value:function(e){return{x:e.x+this.bounds.upperLeft.x,y:e.y+this.bounds.upperLeft.y}}}]),e}(),Ua=new Na,Ha=function(){function e(){Pt(this,e),this.clear()}return Tt(e,[{key:"clear",value:function(){this.index={},this.previous={}}},{key:"update",value:function(e){var t=e.get("position");if(t&&e.valid()){this.wrap(t);var n=at(t);n in this.index||(this.index[n]=new Map),this.index[n].has(e.toString())||(this.index[n].set(e.toString(),e),e.toString()in this.previous&&this.index[this.previous[e.toString()]].delete(e.toString()),this.previous[e.toString()]=n)}}},{key:"get",value:function(e){var t=this.getWrapped(e),n=this.index[at(t)];return n||new Map}},{key:"getSorted",value:function(e){var t=this.get(e);return mt([].concat(Ct(t.values())))}},{key:"remove",value:function(e){var t=e.get("position");if(t){var n=at(t);n in this.index&&this.index[n].delete(e.toString()),delete this.previous[e.toString()]}}},{key:"has",value:function(e){for(var t=this.get(e),n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];var o=!0,a=!1,s=void 0;try{for(var u,l=t.values()[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=u.value;if(c.has.apply(c,i))return!0}}catch(e){a=!0,s=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw s}}return!1}},{key:"find",value:function(e,t){for(var n=this.getSorted(e),i=arguments.length,r=Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];var a=!0,s=!1,u=void 0;try{for(var l,c=n[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var d=l.value;if(d.has.apply(d,r)&&(!t||t.toString()!==d.toString()))return d}}catch(e){s=!0,u=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw u}}}},{key:"count",value:function(e){for(var t=0,n=this.get(e),i=arguments.length,r=Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];var a=!0,s=!1,u=void 0;try{for(var l,c=n.values()[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var d=l.value;d.has.apply(d,r)&&++t}}catch(e){s=!0,u=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw u}}return t}},{key:"getWrapped",value:function(e){if(Ua.bounds){var t=Ua.getZeroPosition(e),n={x:dt(t.x,Ua.bounds.size.width),y:dt(t.y,Ua.bounds.size.height)};if(n.x!==t.x||n.y!==t.y)return Ua.getFullPosition(n)}return e}},{key:"wrap",value:function(e){var t=this.getWrapped(e);e._x=t.x,e._y=t.y}}]),e}(),Va=function(){function e(){Pt(this,e),this.loaders={},
this.loadTile=this.loadTile.bind(this),this.middlewares=[],this.typesForWorld=new Set}return Tt(e,[{key:"setData",value:function(e){this.fullMapData=e.layers,this.options={tileSize:e.tileSize,idToName:e.idToName,nameToId:e.nameToId}}},{key:"middleware",value:function(e){"function"==typeof e&&this.middlewares.push(e)}},{key:"register",value:function(e,t){var n=!0,i=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;s in this.loaders?this.loaders[s].push(t):this.loaders[s]=[t]}}catch(e){i=!0,r=e}finally{try{!n&&a.return&&a.return()}finally{if(i)throw r}}}},{key:"loadOnWorld",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this.typesForWorld=new Set([].concat(Ct(this.typesForWorld),t))}},{key:"invokeLoaders",value:function(e,t){if(e.name in this.loaders){var n=!0,i=!1,r=void 0;try{for(var o,a=this.loaders[e.name][Symbol.iterator]();!(n=(o=a.next()).done);n=!0){(0,o.value)(t,e)}}catch(e){i=!0,r=e}finally{try{!n&&a.return&&a.return()}finally{if(i)throw r}}}}},{key:"inWorld",value:function(){return"world"===this.layer}},{key:"loadWorld",value:function(){var e=this;this.forEachTile("world",this.loadTile);for(var t in this.fullMapData)"world"!==t&&"portal_solved"!==as.get(t)&&this.forEachTile(t,function(t){var n=e.createEntity(t);e.typesForWorld.has(t.name)?e.invokeLoaders(t,n):(n.remove("position"),n.remove("logic"));var i=n.get("sprite");i&&(i.sprite.alpha=.8,i.sprite.tint=8947848)})}},{key:"loadTile",value:function(e,t){var n=this.createEntity(e,t);this.invokeLoaders(e,n)}},{key:"loadTiles",value:function(e){Ua.clear(),this.layer=e.layer,e.puzzle||(e.puzzle={}),e.puzzle.position||(e.puzzle.position={x:128,y:128}),this.clearEntities(),this.inWorld()?this.loadWorld():this.forEachTile(e.layer,this.loadTile),Ua.update()}},{key:"forEachTile",value:function(e,t){for(var n=arguments.length,i=Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];for(var o in this.fullMapData[e]){var a=this.fullMapData[e][o],s=0,u=!0,l=!1,c=void 0;try{for(var d,h=a[Symbol.iterator]();!(u=(d=h.next()).done);u=!0){var f=d.value,p={id:o,name:this.options.idToName[f],position:st(o),spritePosition:this.getVisualPosition(st(o)),layer:e,layerLevel:s};t.apply(void 0,[p].concat(i)),++s}}catch(e){l=!0,c=e}finally{try{!u&&h.return&&h.return()}finally{if(l)throw c}}}}},{key:"getVisualPosition",value:function(e){return{x:e.x*this.options.tileSize.width,y:e.y*this.options.tileSize.height}}},{key:"createEntity",value:function(e,t){t=t||e.layerLevel+1;var n=Ya.entity().set("position",e.position.x,e.position.y).set("sprite",ns,e.name,t,e.spritePosition).set("partOfLayer",e.layer),i=!0,r=!1,o=void 0;try{for(var a,s=this.middlewares[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){(0,a.value)({entity:n,tile:e,loaders:this.loaders})}}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}},{key:"clearEntities",value:function(){Ya.every(["partOfLayer"],function(e,t){t.destroy()})}}]),e}(),Ka=function(){function e(){Pt(this,e),this.buckets=new PIXI.Container,this.index=new Map,this.toUpdate=new Set}return Tt(e,[{key:"clear",value:function(){this.buckets.removeChildren(),this.index.clear(),this.toUpdate.clear()}},{key:"addChild",value:function(e){var t=parseInt(e.zIndex)||0;e.zIndex=t,this.index.has(t)||this.addBucket(t),this.getBucket(t).addChild(e),this.toUpdate.add(t)}},{key:"removeChild",value:function(e){var t=parseInt(e.zIndex)||0;this.index.has(t)&&(this.getBucket(t).removeChild(e),this.toUpdate.add(t))}},{key:"getBucket",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.buckets.children[this.index.get(e)]}},{key:"addBucket",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=new PIXI.Container;t.zIndex=e,this.buckets.addChild(t),ut(this.buckets),this.index=this.build(this.buckets)}},{key:"build",value:function(e){var t=new Map;return e.children.forEach(function(e,n){t.set(e.zIndex,n)}),t}}]),e}(),Xa=function(){function e(){Pt(this,e),this.data={}}return Tt(e,[{key:"exists",value:function(e){return this.data[e]&&this.data[e].length>0}},{key:"count",value:function(e){return e in this.data?this.data[e].length:0}},{key:"send",value:function(e,t){e in this.data||(this.data[e]=[]),this.data[e].push(t)}},{key:"loop",value:function(e,t){if(e in this.data){var n=this.data[e],i=!0,r=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){t(a.value)}}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}}}},{key:"process",value:function(e,t){this.loop(e,t),this.clear(e)}},{key:"clear",value:function(e){delete this.data[e]}},{key:"clearAll",value:function(){this.data={}}}]),e}(),$a=new Xa,Ja=function(){function e(t,n,i){Pt(this,e),this.stage=t.buckets,this.buckets=t,this.app=n,this.outputStage=i,this.gridSize={},this.diff={}}return Tt(e,[{key:"wrap",value:function(e){e.x=dt(e.x,this.bounds.width),e.y=dt(e.y,this.bounds.height)}},{key:"generateSprites",value:function(e,t,n){var i=new PIXI.Container;i.zIndex=e.zIndex;for(var r=0;r<t.y;++r)for(var o=0;o<t.x;++o){var a={x:o*this.bounds.width-n.x,y:r*this.bounds.height-n.y},s=pt(e);s.x=a.x-this.bounds.x,s.y=a.y-this.bounds.y,i.addChild(s)}return i}},{key:"runFullUpdate",value:function(){this.outputStage.removeChildren();for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=!0,r=!1,o=void 0;try{for(var a,s=this.stage.children[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value,l=this.generateSprites.apply(this,[u].concat(t));this.outputStage.addChild(l)}}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}}},{key:"runSmartUpdate",value:function(){for(var e=0;e<this.outputStage.children.length;){var t=this.outputStage.children[e].zIndex;this.buckets.toUpdate.has(t)?this.outputStage.removeChildAt(e):++e}for(var n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];var o=!0,a=!1,s=void 0;try{for(var u,l=this.stage.children[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=u.value;if(this.buckets.toUpdate.has(c.zIndex)){var d=this.generateSprites.apply(this,[c].concat(i));this.outputStage.addChild(d)}}}catch(e){a=!0,s=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw s}}ut(this.outputStage)}},{key:"renderLayers",value:function(){this.fullUpdate||this.outputStage.children.length!==this.stage.children.length?(this.runFullUpdate.apply(this,arguments),this.fullUpdate=void 0):this.runSmartUpdate.apply(this,arguments),this.buckets.toUpdate.clear()}},{key:"update",value:function(e){this.bounds=e;var t={x:this.app.renderer.width,y:this.app.renderer.height},n={x:Math.ceil(t.x/(this.bounds.width*this.scale))+1,y:Math.ceil(t.y/(this.bounds.height*this.scale))+1};this.gridSize.x===n.x&&this.gridSize.y===n.y||(this.gridSize=n,this.fullUpdate=!0);var i={x:Math.ceil(this.outputStage.x/this.scale/this.bounds.width)*this.bounds.width,y:Math.ceil(this.outputStage.y/this.scale/this.bounds.height)*this.bounds.height};if(!this.fullUpdate&&(this.diff.x!==i.x||this.diff.y!==i.y)){var r={x:this.diff.x-i.x,y:this.diff.y-i.y},o=!0,a=!1,s=void 0;try{for(var u,l=this.outputStage.children[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=u.value;c.x+=r.x,c.y+=r.y}}catch(e){a=!0,s=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw s}}}this.diff=i,this.renderLayers(n,i)}},{key:"scale",get:function(){return this.outputStage.scale.x},set:function(e){this.outputStage.scale.x=e,this.outputStage.scale.y=e,$a.send("updateCamera")}},{key:"offset",set:function(e){this._offset={x:e&&e.x||0,y:e&&e.y||0},this.update()},get:function(){return this._offset}}]),e}(),Qa=function(){function e(){Pt(this,e),this.load()}return Tt(e,[{key:"load",value:function(){var e=localStorage.getItem("puzzlePortals")||btoa("{}");this.puzzlePortals=JSON.parse(atob(e))}},{key:"save",value:function(){localStorage.setItem("puzzlePortals",btoa(JSON.stringify(this.puzzlePortals)))}},{key:"update",value:function(){var e=this;$a.process("updatePuzzlePortal",function(t){e.puzzlePortals[t.layer]=t.state,e.save()})}},{key:"get",value:function(e,t){return e in this.puzzlePortals?this.puzzlePortals[e]:t||"portal_unexplored"}}]),e}(),Ya=new Kt,Za=new PIXI.Application(window.innerWidth,window.innerHeight,{backgroundColor:3424325}),es=(Za.stage.addChild(new PIXI.Container),Za.stage.addChild(new PIXI.Container)),ts=Za.stage.addChild(new PIXI.Container),ns=new Ka,is=new Ha,rs=new Va,os=new Ja(ns,Za,es),as=new Qa;Ya.component("position",function(){function e(){Pt(this,e)}return Tt(e,[{key:"onCreate",value:function(e){this.entity=e;for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.set.apply(this,n)}},{key:"onRemove",value:function(){is.remove(this.entity)}},{key:"update",value:function(){this.entity.set("positionChanged"),is.update(this.entity)}},{key:"set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._x===e&&this._y===t||(this._x=e,this._y=t,this.update())}},{key:"read",value:function(){this.entity.remove("positionChanged")}},{key:"x",set:function(e){this._x!==e&&(this._x=e,this.update())},get:function(){return this._x}},{key:"y",set:function(e){this._y!==e&&(this._y=e,this.update())},get:function(){return this._y}}]),e}()),Ya.component("sprite",function(){function e(){Pt(this,e)}return Tt(e,[{key:"onCreate",value:function(e,t,n,i,r){this.entity=e,this.container=t,this.create(n,i,r)}},{key:"create",value:function(e,t,n){e?(e=this.getTIName(e),this.sprite=new PIXI.Sprite(PIXI.utils.TextureCache[e+".png"]),this.name=e):this.sprite=new PIXI.Sprite,this.sprite.anchor.set(.5),this.sprite.zIndex=t||0,n&&(this.sprite.position.x=n.x,this.sprite.position.y=n.y),this.onCreated()}},{key:"onRemove",value:function(){this.container.toUpdate.add(this.sprite.zIndex),this.container.removeChild(this.sprite)}},{key:"onCreated",value:function(){this.container.toUpdate.add(this.sprite.zIndex),this.container.addChild(this.sprite)}},{key:"set",value:function(e){return(e=this.getTIName(e))!==this.name&&(this.sprite.texture=PIXI.utils.TextureCache[e+".png"],this.name=e,this.container.toUpdate.add(this.sprite.zIndex),!0)}},{key:"updateTimeImmune",value:function(){this.set(this.name)}},{key:"getTIName",value:function(e){e.endsWith("_ti")&&(e=e.slice(0,-"_ti".length));var t=e+"_ti";return this.entity.has("timeImmune")&&PIXI.utils.TextureCache[t+".png"]&&(e=t),e}},{key:"zIndex",set:function(e){this.onRemove(),this.sprite.zIndex=e,this.onCreated()},get:function(){return this.sprite.zIndex}}]),e}()),Ya.component("inputMovement",function(){function e(){Pt(this,e),this.currentDirection={x:0,y:0},this.lastDirection={x:0,y:0}}return e}()),Ya.component("forcedMovement",function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0};Pt(this,e),this.direction=t}return e}()),Ya.component("cameraFollows",function(){function e(){Pt(this,e),this.update()}return Tt(e,[{key:"update",value:function(){this.center=!0;var e=os.scale;this.borderSize={x:Ua.gameSize.width/e*.33,y:Ua.gameSize.height/e*.33},this.deadzone=new PIXI.Rectangle(this.borderSize.x,this.borderSize.y,Ua.gameSize.width/e-2*this.borderSize.x,Ua.gameSize.height/e-2*this.borderSize.y)}}]),e}()),Ya.component("logicAction",function(){function e(t){Pt(this,e),this.action=t}return e}()),Ya.component("logic",function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Pt(this,e);for(var n in t)this[n]=t[n]}return e}()),Ya.component("partOfLayer",function(){function e(t){Pt(this,e),this.layer=t}return e}()),Ya.component("puzzlePortal",function(){function e(t){Pt(this,e),this.puzzle=t}return e}()),Ya.component("puzzleGoal",function(){function e(t){Pt(this,e),this.completed=t||!1}return e}()),Ya.component("pollutionImmune",function(){function e(t){Pt(this,e),this.count=t||0}return e}()),Ya.component("goal",function(){function e(){Pt(this,e)}return Tt(e,[{key:"onCreate",value:function(e,t,n,i){this.entity=e,this.unsolvedTexture=n,this.solvedTexture=i,this.solved=t}},{key:"solved",set:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state=e,this.solvedTexture&&this.unsolvedTexture&&this.entity.has("sprite")){var t=this.state?this.solvedTexture:this.unsolvedTexture;this.entity.get("sprite").set(t)}},get:function(){return this.state}}]),e}()),Ya.component("tween",function(){function e(){Pt(this,e)}return Tt(e,[{key:"onCreate",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e3;if(this.entity=e,this.target=n,this.time=i,this.total=0,t)this.start=t;else{var r=this.entity.get("sprite").sprite;this.start={x:r.x,y:r.y}}}},{key:"update",value:function(e,t){this.total+=e;var n=Math.min(1,this.total/this.time),i=ht(this.start,this.target,n),r=this.entity.get("sprite");r.sprite.x=i.x,r.sprite.y=i.y,r.container.toUpdate.add(r.sprite.zIndex),1===n&&(this.entity.remove("tween"),ct(t))}}]),e}()),Ya.component("attachable",function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;Pt(this,e),this.attached=t}return e}()),Ya.component("platform",function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;Pt(this,e),this.holding=t}return e}()),Ya.component("timeImmune",function(){function e(){Pt(this,e)}return Tt(e,[{key:"onCreate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.entity=e,this.permanent=t,this.updateSprite()}},{key:"onRemove",value:function(){this.updateSprite()}},{key:"updateSprite",value:function(){var e=this.entity.get("sprite");e&&e.updateTimeImmune()}}]),e}()),Ya.component("floats",function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Pt(this,e),this.floating=t}return e}()),Ya.component("directionSprite",function(){function e(){Pt(this,e)}return Tt(e,[{key:"onCreate",value:function(e,t){this.entity=e,this.directions=t}}]),e}()),Ya.component("waterSupply",function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Pt(this,e),this.current=t,this.max=n}return Tt(e,[{key:"refill",value:function(e){var t=this.current;return this.current=e||this.max,t}}]),e}());var ss={world:{"162,10":[73],"163,10":[73],"164,10":[73],"162,11":[73],"163,11":[73],"164,11":[73],"162,12":[73],"163,12":[73],"164,12":[73],"162,13":[73],"163,13":[73],"164,13":[73],"162,14":[73],"163,14":[73],"164,14":[73],"162,15":[73],"163,15":[73],"164,15":[73],"162,16":[73],"163,16":[73],"164,16":[73],"162,17":[73],"163,17":[73],"164,17":[73],"162,18":[73],"163,18":[73],"164,18":[73],"162,19":[73],"163,19":[73],"164,19":[73],"162,20":[73],"163,20":[73],"164,20":[73],"162,21":[73],"163,21":[73],"164,21":[73],"162,22":[73],"163,22":[73],"164,22":[73],"162,23":[73],"163,23":[73],"164,23":[73],"162,24":[73],"163,24":[73],"164,24":[73],"162,25":[73],"163,25":[73],"164,25":[73],"162,26":[73],"163,26":[73],"164,26":[73],"162,27":[73],"163,27":[73],"164,27":[73],"162,28":[73],"163,28":[73],"164,28":[73],"162,29":[73],"163,29":[73],"164,29":[73],"162,30":[73],"163,30":[73],"164,30":[73],"162,31":[73],"163,31":[73],"164,31":[73],"162,32":[73],"163,32":[73],"164,32":[73],"162,33":[73],"163,33":[73],"164,33":[73],"162,34":[73],"163,34":[73],"164,34":[73],"162,35":[73],"163,35":[73],"164,35":[73],"162,36":[73],"163,36":[73],"164,36":[73],"162,37":[73],"163,37":[73],"164,37":[73],"162,38":[73],"163,38":[73],"164,38":[73],"162,39":[73],"163,39":[73],"164,39":[73],"162,40":[73],"163,40":[73],"164,40":[73],"162,41":[73],"163,41":[73],"164,41":[73],"162,42":[73],"163,42":[73],"164,42":[73],"162,43":[73],"163,43":[73],"164,43":[73],"162,44":[73],"163,44":[73],"164,44":[73],"162,45":[73],"163,45":[73],"164,45":[73],"162,46":[73],"163,46":[73],"164,46":[73],"162,47":[73],"163,47":[73],"164,47":[73],"162,48":[73],"163,48":[73],"164,48":[73],"162,49":[73],"163,49":[73],"164,49":[73],"162,50":[73],"163,50":[73],"164,50":[73],"162,51":[73],"163,51":[73],"164,51":[73],"162,52":[73],"163,52":[73],"164,52":[73],"162,53":[73],"163,53":[73],"164,53":[73],"162,54":[73],"163,54":[73],"164,54":[73],"162,55":[73],"163,55":[73],"164,55":[73],"127,56":[83],"135,56":[83],"162,56":[73],"163,56":[73],"164,56":[73],"127,57":[73],"128,57":[73],"129,57":[73],"130,57":[73],"131,57":[73],"132,57":[73],"133,57":[73],"134,57":[73],"135,57":[126],"136,57":[73],"137,57":[73],"138,57":[73],"139,57":[73],"140,57":[73],"141,57":[73],"142,57":[73],"143,57":[73],"144,57":[73],"145,57":[73],"146,57":[73],"147,57":[73],"148,57":[73],"149,57":[73],"150,57":[73],"151,57":[73],"152,57":[73],"153,57":[73],"154,57":[73],"155,57":[73],"156,57":[73],"157,57":[73],"158,57":[73],"159,57":[73],"160,57":[73],"161,57":[73],"162,57":[73],"163,57":[73],"164,57":[73],"127,58":[73],"128,58":[73],"129,58":[73],"130,58":[73],"131,58":[73],"132,58":[73],"133,58":[73],"134,58":[73],"135,58":[73],"136,58":[73],"137,58":[73],"138,58":[73],"139,58":[73],"140,58":[73],"141,58":[73],"142,58":[73],"143,58":[73],"144,58":[73],"145,58":[73],"146,58":[73],"147,58":[73],"148,58":[73],"149,58":[73],"150,58":[73],"151,58":[73],"152,58":[73],"153,58":[73],"154,58":[73],"155,58":[73],"156,58":[73],"157,58":[73],"158,58":[73],"159,58":[73],"160,58":[73],"161,58":[73],"162,58":[73],"163,58":[73],"164,58":[73],"127,59":[73],"128,59":[73],"129,59":[73],"130,59":[73],"131,59":[73],"132,59":[73],"133,59":[73],"134,59":[73],"135,59":[73],"136,59":[73],"137,59":[73],"138,59":[73],"139,59":[73],"140,59":[73],"141,59":[73],"142,59":[73],"143,59":[73],"144,59":[73],"145,59":[73],"146,59":[73],"147,59":[73],"148,59":[73],"149,59":[73],"150,59":[73],"151,59":[73],"152,59":[73],"153,59":[73],"154,59":[73],"155,59":[73],"156,59":[73],"157,59":[73],"158,59":[73],"159,59":[73],"160,59":[73],"161,59":[73],"162,59":[73],"163,59":[73],"164,59":[73],"127,60":[73],"128,60":[73],"129,60":[73],"162,60":[136],"163,60":[136],"164,60":[136],"127,61":[73],"128,61":[73],"129,61":[73],"161,61":[83],"162,61":[73],"163,61":[73],"164,61":[73],"127,62":[73],"128,62":[73],"129,62":[73],"130,62":[83],"162,62":[73],"163,62":[73],"164,62":[73],"165,62":[83],"127,63":[73],"128,63":[73],"129,63":[73],"162,63":[73],"163,63":[73],"164,63":[73],"127,64":[73],"128,64":[73],"129,64":[73],"162,64":[73],"163,64":[73],"164,64":[73],"127,65":[73],"128,65":[73],"129,65":[73],"162,65":[73],"163,65":[73],"164,65":[73],"127,66":[73],"128,66":[73],"129,66":[73],"130,66":[83],"162,66":[73],"163,66":[73],"164,66":[73],"165,66":[83],"126,67":[83],"127,67":[73],"128,67":[73],"129,67":[73],"162,67":[73],"163,67":[73],"164,67":[73],"127,68":[73],"128,68":[73],"129,68":[73],"161,68":[83],"162,68":[73],"163,68":[73],"164,68":[73],"127,69":[73],"128,69":[73],"129,69":[73],"162,69":[73],"163,69":[73],"164,69":[73],"127,70":[73],"128,70":[73],"129,70":[73],"162,70":[73],"163,70":[73],"164,70":[73],"127,71":[73],"128,71":[73],"129,71":[73],"161,71":[83],"162,71":[73],"163,71":[73],"164,71":[73],"127,72":[73],"128,72":[73],"129,72":[73],"162,72":[73],"163,72":[73],"164,72":[73],"127,73":[73],"128,73":[73],"129,73":[73],"162,73":[73],"163,73":[73],"164,73":[73],"126,74":[83],"127,74":[73],"128,74":[73],"129,74":[73],"162,74":[73],"163,74":[73],"164,74":[73],"127,75":[73],"128,75":[73],"129,75":[73],"162,75":[73],"163,75":[73],"164,75":[73],"165,75":[83],"127,76":[73],"128,76":[73],"129,76":[73],"161,76":[83],"162,76":[73],"163,76":[73],"164,76":[73],"127,77":[73],"128,77":[73],"129,77":[73],"162,77":[73],"163,77":[73],"164,77":[73],"127,78":[73],"128,78":[73],"129,78":[73],"162,78":[73],"163,78":[73],"164,78":[73],"127,79":[73],"128,79":[73],"129,79":[73],"162,79":[73],"163,79":[73],"164,79":[73],"126,80":[83],"127,80":[73],"128,80":[73],"129,80":[73],"162,80":[73],"163,80":[73],"164,80":[73],"127,81":[73],"128,81":[73],"129,81":[73],"162,81":[73],"163,81":[73],"164,81":[73],"165,81":[83],"127,82":[73],"128,82":[73],"129,82":[73],"161,82":[83],"162,82":[73],"163,82":[73],"164,82":[73],"127,83":[73],"128,83":[73],"129,83":[73],"162,83":[73],"163,83":[73],"164,83":[73],"127,84":[73],"128,84":[73],"129,84":[73],"162,84":[73],"163,84":[73],"164,84":[73],"126,85":[83],"127,85":[73],"128,85":[73],"129,85":[73],"162,85":[73],"163,85":[73],"164,85":[73],"127,86":[73],"128,86":[73],"129,86":[73],"162,86":[73],"163,86":[73],"164,86":[73],"127,87":[73],"128,87":[73],"129,87":[73],"162,87":[73],"163,87":[73],"164,87":[73],"127,88":[73],"128,88":[73],"129,88":[73],"162,88":[73],"163,88":[73],"164,88":[73],"165,88":[83],"127,89":[73],"128,89":[73],"129,89":[73],"130,89":[83],"162,89":[73],"163,89":[73],"164,89":[73],"126,90":[83],"127,90":[73],"128,90":[73],"129,90":[73],"161,90":[83],"162,90":[73],"163,90":[73],"164,90":[73],"127,91":[73],"128,91":[73],"129,91":[73],"162,91":[73],"163,91":[73],"164,91":[73],"127,92":[73],"128,92":[73],"129,92":[73],"162,92":[73],"163,92":[73],"164,92":[73],"127,93":[73],"128,93":[73],"129,93":[73],"162,93":[73],"163,93":[73],"164,93":[73],"127,94":[73],"128,94":[73],"129,94":[73],"130,94":[83],"162,94":[73],"163,94":[73],"164,94":[73],"126,95":[83],"127,95":[73],"128,95":[73],"129,95":[73],"162,95":[73],"163,95":[73],"164,95":[73],"127,96":[73],"128,96":[73],"129,96":[73],"162,96":[73],"163,96":[73],"164,96":[73],"127,97":[73],"128,97":[73],"129,97":[73],"162,97":[73],"163,97":[73],"164,97":[73],"127,98":[73],"128,98":[73],"129,98":[73],"130,98":[83],"162,98":[73],"163,98":[73],"164,98":[73],"127,99":[73],"128,99":[73],"129,99":[73],"162,99":[73],"163,99":[73],"164,99":[73],"126,100":[83],"127,100":[73],"128,100":[73],"129,100":[73],"162,100":[73],"163,100":[73],"164,100":[73],"127,101":[73],"128,101":[73],"129,101":[73],"162,101":[73],"163,101":[73],"164,101":[73],"127,102":[73],"128,102":[73],"129,102":[73],"162,102":[73],"163,102":[73],"164,102":[73],"127,103":[73],"128,103":[73],"129,103":[73],"130,103":[83],"162,103":[73],"163,103":[73],"164,103":[73],"127,104":[73],"128,104":[73],"129,104":[73],"162,104":[73],"163,104":[73],"164,104":[73],"127,105":[73],"128,105":[73],"129,105":[73],"162,105":[73],"163,105":[73],"164,105":[73],"127,106":[73],"128,106":[73],"129,106":[73],"162,106":[73],"163,106":[73],"164,106":[73],"126,107":[83],"127,107":[73],"128,107":[73],"129,107":[73],"130,107":[83],"162,107":[73],"163,107":[73],"164,107":[73],"127,108":[73],"128,108":[73],"129,108":[73],"162,108":[73],"163,108":[73],"164,108":[73],"127,109":[73],"128,109":[73],"129,109":[73],"162,109":[73],"163,109":[73],"164,109":[73],"127,110":[73],"128,110":[73],"129,110":[73],"130,110":[83],"162,110":[73],"163,110":[73],"164,110":[73],"127,111":[73],"128,111":[73],"129,111":[73],"162,111":[73],"163,111":[73],"164,111":[73],"127,112":[73],"128,112":[73],"129,112":[73],"162,112":[73],"163,112":[73],"164,112":[73],"127,113":[73],"128,113":[73],"129,113":[73],"162,113":[73],"163,113":[73],"164,113":[73],"127,114":[73],"128,114":[73],"129,114":[73],"130,114":[83],"162,114":[73],"163,114":[73],"164,114":[73],"126,115":[83],"127,115":[73],"128,115":[73],"129,115":[73],"162,115":[73],"163,115":[73],"164,115":[73],"127,116":[73],"128,116":[73],"129,116":[73],"162,116":[73],"163,116":[73],"164,116":[73],"127,117":[73],"128,117":[73],"129,117":[73],"162,117":[73],"163,117":[73],"164,117":[73],"127,118":[73],"128,118":[73],"129,118":[73],"130,118":[83],"162,118":[73],"163,118":[73],"164,118":[73],"126,119":[83],"127,119":[73],"128,119":[73],"129,119":[73],"162,119":[73],"163,119":[73],"164,119":[73],"127,120":[73],"128,120":[73],"129,120":[73],"162,120":[73],"163,120":[73],"164,120":[73],"127,121":[73],"128,121":[73],"129,121":[73],"162,121":[73],"163,121":[73],"164,121":[73],"126,122":[83],"127,122":[73],"128,122":[73],"129,122":[73],"162,122":[73],"163,122":[73],"164,122":[73],"127,123":[73],"128,123":[73],"129,123":[73],"162,123":[73],"163,123":[73],"164,123":[73],"127,124":[73],"128,124":[73],"129,124":[73],"130,124":[83],"162,124":[73],"163,124":[73],"164,124":[73],"127,125":[73],"128,125":[73],"129,125":[73],"162,125":[73],"163,125":[73],"164,125":[73],"127,126":[88],"128,126":[88],"129,126":[88],"162,126":[73],"163,126":[73],"164,126":[73],"125,127":[111],"126,127":[111],"127,127":[73],"128,127":[73],"129,127":[73],"130,127":[111],"131,127":[111],"162,127":[73],"163,127":[73],"164,127":[73],"125,128":[111],"126,128":[73],"127,128":[73],"128,128":[73],"129,128":[73],"130,128":[73],"131,128":[111],"162,128":[73],"163,128":[73],"164,128":[73],"125,129":[111],"126,129":[73],"130,129":[73],"131,129":[111],"162,129":[73],"163,129":[73],"164,129":[73],"125,130":[111],"126,130":[73],"128,130":[113],"130,130":[73],"131,130":[111],"162,130":[73],"163,130":[73],"164,130":[73],"125,131":[111],"126,131":[73],"130,131":[73],"131,131":[111],"162,131":[73],"163,131":[73],"164,131":[73],"125,132":[111],"126,132":[73],"127,132":[73],"128,132":[73],"129,132":[73],"130,132":[73],"131,132":[129],"132,132":[129],"133,132":[129],"134,132":[129],"135,132":[129],"136,132":[129],"137,132":[129],"138,132":[129],"139,132":[129],"140,132":[129],"141,132":[129],"142,132":[129],"143,132":[129],"144,132":[129],"145,132":[129],"146,132":[129],"147,132":[129],"148,132":[129],"149,132":[129],"150,132":[129],"151,132":[129],"152,132":[129],"153,132":[129],"154,132":[129],"155,132":[129],"156,132":[129],"157,132":[129],"158,132":[129],"159,132":[129],"160,132":[129],"161,132":[129],"162,132":[73],"163,132":[73],"164,132":[73],"125,133":[111],"126,133":[111],"127,133":[111],"128,133":[111],"129,133":[111],"130,133":[111],"131,133":[111],"162,133":[73],"163,133":[73],"164,133":[73],"162,134":[73],"163,134":[73],"164,134":[73],"162,135":[73],"163,135":[73],"164,135":[73],"162,136":[73],"163,136":[73],"164,136":[73],"162,137":[73],"163,137":[73],"164,137":[73],"162,138":[73],"163,138":[73],"164,138":[73],"162,139":[73],"163,139":[73],"164,139":[73],"162,140":[73],"163,140":[73],"164,140":[73],"162,141":[73],"163,141":[73],"164,141":[73],"162,142":[73],"163,142":[73],"164,142":[73],"162,143":[73],"163,143":[73],"164,143":[73],"162,144":[73],"163,144":[73],"164,144":[73],"162,145":[73],"163,145":[73],"164,145":[73],"68,146":[83],"90,146":[83],"111,146":[83],"118,146":[83],"130,146":[83],"135,146":[83],"157,146":[83],"162,146":[73],"163,146":[73],"164,146":[73],"172,146":[83],"65,147":[73],"66,147":[73],"67,147":[73],"68,147":[73],"69,147":[73],"70,147":[73],"71,147":[73],"72,147":[73],"73,147":[73],"74,147":[73],"75,147":[73],"76,147":[73],"77,147":[73],"78,147":[73],"79,147":[73],"80,147":[73],"81,147":[73],"82,147":[73],"83,147":[73],"84,147":[73],"85,147":[73],"86,147":[73],"87,147":[73],"88,147":[73],"89,147":[73],"90,147":[73],"91,147":[73],"92,147":[73],"93,147":[73],"94,147":[73],"95,147":[73],"96,147":[73],"97,147":[73],"98,147":[73],"99,147":[73],"100,147":[73],"101,147":[73],"102,147":[73],"103,147":[73],"104,147":[73],"105,147":[73],"106,147":[73],"107,147":[73],"108,147":[73],"109,147":[73],"110,147":[73],"111,147":[73],"112,147":[73],"113,147":[73],"114,147":[73],"115,147":[73],"116,147":[73],"117,147":[73],"118,147":[73],"119,147":[73],"120,147":[73],"121,147":[73],"122,147":[73],"123,147":[73],"124,147":[73],"125,147":[73],"126,147":[73],"127,147":[73],"128,147":[73],"129,147":[73],"130,147":[73],"131,147":[73],"132,147":[73],"133,147":[73],"134,147":[73],"135,147":[73],"136,147":[73],"137,147":[73],"138,147":[73],"139,147":[73],"140,147":[73],"141,147":[73],"142,147":[73],"143,147":[73],"144,147":[73],"145,147":[73],"146,147":[73],"147,147":[73],"148,147":[73],"149,147":[73],"150,147":[73],"151,147":[73],"152,147":[73],"153,147":[73],"154,147":[73],"155,147":[73],"156,147":[73],"157,147":[73],"158,147":[73],"159,147":[73],"160,147":[73],"161,147":[129],"162,147":[73],"163,147":[73],"164,147":[73],"165,147":[126],"166,147":[73],"167,147":[73],"168,147":[73],"169,147":[73],"170,147":[73],"171,147":[73],"172,147":[73],"173,147":[73],"174,147":[73],"175,147":[73],"176,147":[73],"177,147":[73],"178,147":[73],"179,147":[73],"180,147":[73],"181,147":[73],"182,147":[73],"183,147":[73],"184,147":[73],"185,147":[73],"186,147":[73],"187,147":[73],"188,147":[73],"189,147":[73],"190,147":[73],"191,147":[73],"192,147":[73],"193,147":[73],"194,147":[73],"195,147":[73],"196,147":[73],"197,147":[73],"198,147":[73],"199,147":[73],"200,147":[73],"201,147":[73],"202,147":[73],"203,147":[73],"204,147":[73],"205,147":[73],"206,147":[73],"207,147":[73],"208,147":[73],"209,147":[73],"210,147":[73],"211,147":[73],"212,147":[73],"213,147":[73],"214,147":[73],"215,147":[73],"216,147":[73],"217,147":[73],"218,147":[73],"219,147":[73],"220,147":[73],"221,147":[73],"222,147":[73],"223,147":[73],"65,148":[73],"66,148":[73],"67,148":[73],"68,148":[73],"69,148":[73],"70,148":[73],"71,148":[73],"72,148":[73],"73,148":[73],"74,148":[73],"75,148":[73],"76,148":[73],"77,148":[73],"78,148":[73],"79,148":[73],"80,148":[73],"81,148":[73],"82,148":[73],"83,148":[73],"84,148":[73],"85,148":[73],"86,148":[73],"87,148":[73],"88,148":[73],"89,148":[73],"90,148":[73],"91,148":[73],"92,148":[73],"93,148":[73],"94,148":[73],"95,148":[73],"96,148":[73],"97,148":[73],"98,148":[73],"99,148":[73],"100,148":[73],"101,148":[73],"102,148":[73],"103,148":[73],"104,148":[73],"105,148":[73],"106,148":[73],"107,148":[73],"108,148":[73],"109,148":[73],"110,148":[73],"111,148":[73],"112,148":[73],"113,148":[73],"114,148":[73],"115,148":[73],"116,148":[73],"117,148":[73],"118,148":[73],"119,148":[73],"120,148":[73],"121,148":[73],"122,148":[73],"123,148":[73],"124,148":[73],"125,148":[73],"126,148":[73],"127,148":[73],"128,148":[73],"129,148":[73],"130,148":[73],"131,148":[73],"132,148":[73],"133,148":[73],"134,148":[73],"135,148":[73],"136,148":[73],"137,148":[73],"138,148":[73],"139,148":[73],"140,148":[73],"141,148":[73],"142,148":[73],"143,148":[73],"144,148":[73],"145,148":[73],"146,148":[73],"147,148":[73],"148,148":[73],"149,148":[73],"150,148":[73],"151,148":[73],"152,148":[73],"153,148":[73],"154,148":[73],"155,148":[73],"156,148":[73],"157,148":[73],"158,148":[73],"159,148":[73],"160,148":[73],"161,148":[129],"162,148":[73],"163,148":[73],"164,148":[73],"165,148":[126],"166,148":[73],"167,148":[73],"168,148":[73],"169,148":[73],"170,148":[73],"171,148":[73],"172,148":[73],"173,148":[73],"174,148":[73],"175,148":[73],"176,148":[73],"177,148":[73],"178,148":[73],"179,148":[73],"180,148":[73],"181,148":[73],"182,148":[73],"183,148":[73],"184,148":[73],"185,148":[73],"186,148":[73],"187,148":[73],"188,148":[73],"189,148":[73],"190,148":[73],"191,148":[73],"192,148":[73],"193,148":[73],"194,148":[73],"195,148":[73],"196,148":[73],"197,148":[73],"198,148":[73],"199,148":[73],"200,148":[73],"201,148":[73],"202,148":[73],"203,148":[73],"204,148":[73],"205,148":[73],"206,148":[73],"207,148":[73],"208,148":[73],"209,148":[73],"210,148":[73],"211,148":[73],"212,148":[73],"213,148":[73],"214,148":[73],"215,148":[73],"216,148":[73],"217,148":[73],"218,148":[73],"219,148":[73],"220,148":[73],"221,148":[73],"222,148":[73],"223,148":[73],"65,149":[73],"66,149":[73],"67,149":[73],"68,149":[73],"69,149":[73],"70,149":[73],"71,149":[73],"72,149":[73],"73,149":[73],"74,149":[126],"75,149":[126],"76,149":[126],"77,149":[126],"78,149":[126],"79,149":[73],"80,149":[73],"81,149":[73],"82,149":[73],"83,149":[73],"84,149":[73],"85,149":[73],"86,149":[73],"87,149":[73],"88,149":[73],"89,149":[73],"90,149":[73],"91,149":[73],"92,149":[73],"93,149":[73],"94,149":[73],"95,149":[73],"96,149":[73],"97,149":[73],"98,149":[73],"99,149":[73],"100,149":[73],"101,149":[73],"102,149":[73],"103,149":[73],"104,149":[73],"105,149":[73],"106,149":[73],"107,149":[73],"108,149":[73],"109,149":[73],"110,149":[73],"111,149":[73],"112,149":[73],"113,149":[73],"114,149":[73],"115,149":[73],"116,149":[73],"117,149":[73],"118,149":[73],"119,149":[73],"120,149":[73],"121,149":[73],"122,149":[73],"123,149":[73],"124,149":[73],"125,149":[73],"126,149":[73],"127,149":[73],"128,149":[73],"129,149":[73],"130,149":[73],
"131,149":[73],"132,149":[73],"133,149":[73],"134,149":[73],"135,149":[73],"136,149":[73],"137,149":[73],"138,149":[73],"139,149":[73],"140,149":[73],"141,149":[73],"142,149":[73],"143,149":[73],"144,149":[73],"145,149":[73],"146,149":[73],"147,149":[73],"148,149":[73],"149,149":[73],"150,149":[73],"151,149":[73],"152,149":[73],"153,149":[73],"154,149":[73],"155,149":[73],"156,149":[73],"157,149":[73],"158,149":[73],"159,149":[73],"160,149":[73],"161,149":[129],"162,149":[73],"163,149":[73],"164,149":[73],"165,149":[126],"166,149":[73],"167,149":[73],"168,149":[73],"169,149":[73],"170,149":[73],"171,149":[73],"172,149":[73],"173,149":[73],"174,149":[73],"175,149":[73],"176,149":[73],"177,149":[73],"178,149":[73],"179,149":[73],"180,149":[73],"181,149":[73],"182,149":[73],"183,149":[73],"184,149":[73],"185,149":[73],"186,149":[73],"187,149":[73],"188,149":[73],"189,149":[73],"190,149":[73],"191,149":[73],"192,149":[73],"193,149":[73],"194,149":[73],"195,149":[73],"196,149":[73],"197,149":[73],"198,149":[73],"199,149":[73],"200,149":[73],"201,149":[73],"202,149":[73],"203,149":[73],"204,149":[73],"205,149":[73],"206,149":[73],"207,149":[73],"208,149":[73],"209,149":[73],"210,149":[73],"211,149":[73],"212,149":[73],"213,149":[73],"214,149":[73],"215,149":[73],"216,149":[73],"217,149":[73],"218,149":[73],"219,149":[73],"220,149":[73],"221,149":[73],"222,149":[73],"223,149":[73],"77,150":[83],"81,150":[83],"95,150":[83],"104,150":[83],"131,150":[83],"136,150":[83],"153,150":[83],"159,150":[83],"162,150":[126],"163,150":[126],"164,150":[126],"162,151":[73],"163,151":[73],"164,151":[73],"162,152":[73],"163,152":[73],"164,152":[73],"162,153":[73],"163,153":[73],"164,153":[73],"162,154":[73],"163,154":[73],"164,154":[73],"162,155":[73],"163,155":[73],"164,155":[73],"162,156":[73],"163,156":[73],"164,156":[73],"162,157":[73],"163,157":[73],"164,157":[73],"162,158":[73],"163,158":[73],"164,158":[73],"162,159":[73],"163,159":[73],"164,159":[73],"162,160":[73],"163,160":[73],"164,160":[73],"162,161":[73],"163,161":[73],"164,161":[73],"162,162":[73],"163,162":[73],"164,162":[73],"162,163":[73],"163,163":[73],"164,163":[73]},"lvl-127,56":{"128,56":[111],"127,55":[73],"126,56":[111],"127,56":[73],"126,55":[73],"125,56":[73],"125,55":[73],"125,54":[73],"126,54":[73],"125,53":[73],"126,53":[111],"125,52":[73],"126,52":[111],"125,51":[73],"126,51":[111],"125,50":[73,140,139],"126,50":[111],"125,49":[73],"126,49":[111],"125,48":[73],"126,48":[111],"125,47":[73],"126,47":[111],"125,46":[73],"126,46":[111],"125,45":[73],"126,45":[111],"125,44":[73],"126,44":[111],"125,43":[73],"126,43":[111],"125,42":[73],"126,42":[111],"125,41":[73],"126,41":[111],"127,41":[73,143],"128,41":[111],"127,42":[73],"128,42":[111],"127,43":[73],"128,43":[111],"127,44":[73],"128,44":[111],"127,45":[73],"128,45":[111],"127,46":[73],"128,46":[111],"127,47":[73],"128,47":[111],"127,48":[73],"128,48":[111],"127,49":[73],"128,49":[111],"127,50":[73],"128,50":[111],"127,51":[73],"128,51":[111],"127,52":[73],"128,52":[111],"127,53":[73],"128,53":[111],"127,54":[73],"128,54":[73],"128,55":[73]},"lvl-135,56":{"136,56":[73],"135,55":[111],"134,56":[73],"135,56":[73],"134,55":[111],"133,56":[73],"133,55":[73,143],"132,56":[73],"132,55":[111],"132,54":[111],"133,54":[73],"132,53":[111],"133,53":[73],"132,52":[111],"133,52":[73],"132,51":[111],"133,51":[111],"134,51":[111],"135,51":[111],"134,52":[73],"135,52":[73],"134,53":[111],"135,53":[73,140],"134,54":[73],"135,54":[73],"136,54":[73],"137,54":[73],"136,53":[73,140],"136,55":[111],"137,55":[73,143],"138,55":[111],"137,56":[73],"138,56":[73],"139,56":[73],"139,55":[111],"139,54":[111],"139,53":[111],"138,54":[73],"138,53":[73],"138,52":[73],"137,53":[111],"137,52":[73],"137,51":[111],"136,52":[73],"136,51":[111],"138,51":[111],"139,51":[111],"139,52":[111]},"lvl-161,61":{"161,60":[111],"160,61":[73],"161,62":[73],"161,61":[73],"160,62":[73,138],"161,63":[73],"160,63":[73],"159,63":[111],"159,62":[111],"158,63":[111],"158,62":[73,139],"157,63":[111],"157,62":[111],"157,61":[111],"158,61":[73],"157,60":[111],"158,60":[111],"159,60":[111],"160,60":[111],"159,61":[94]},"lvl-130,62":{"131,62":[73,139],"130,61":[73],"130,63":[73],"131,63":[73,143],"130,62":[73],"130,64":[73],"131,64":[73],"132,64":[73],"133,64":[73],"132,63":[73,140],"133,63":[73,143],"132,62":[73,143],"133,62":[73,140],"132,61":[73,140],"133,61":[73,143],"132,60":[73],"131,61":[73,143],"131,60":[73],"130,60":[73],"133,60":[73],"134,60":[73],"135,60":[73],"134,61":[73,140],"135,61":[73,143],"134,62":[73,143],"135,62":[73,140],"134,63":[73,140],"135,63":[73,143],"134,64":[73],"135,64":[73],"136,64":[111],"137,64":[73],"136,63":[73,140],"137,63":[73,140],"136,62":[73,140],"137,62":[73,143],"136,61":[73,140],"137,61":[73,140],"136,60":[73],"137,60":[73],"138,60":[73],"139,60":[73],"138,61":[73,143],"139,61":[73,140],"138,62":[73,140],"139,62":[73,143],"138,63":[73,143],"139,63":[73,140],"138,64":[73],"139,64":[73],"140,64":[111],"141,64":[111],"140,63":[73,143],"141,63":[73],"140,62":[73,140],"141,62":[73,143],"140,61":[73,143],"141,61":[73],"140,60":[73],"141,60":[73],"142,60":[111],"142,61":[73],"142,62":[73],"142,63":[111],"142,64":[111]},"lvl-165,62":{"166,62":[73],"165,61":[73],"165,63":[73,138],"166,63":[73,138],"165,62":[73],"167,63":[111],"168,63":[111],"167,62":[94],"168,62":[94],"167,61":[111],"168,61":[111],"166,61":[73],"169,61":[111],"170,61":[73],"169,62":[73,139],"170,62":[111],"169,63":[111],"170,63":[73]},"lvl-130,66":{"131,66":[111],"130,67":[73],"131,67":[111],"130,66":[73],"130,68":[73,140],"131,68":[111],"130,69":[73],"131,69":[111],"130,70":[111],"131,70":[111],"130,71":[111],"131,71":[94],"130,72":[94],"131,72":[94],"130,73":[94],"131,73":[94],"130,74":[94],"131,74":[94],"130,75":[111],"131,75":[111],"130,76":[73,140],"131,76":[111],"130,77":[73],"131,77":[111],"132,77":[111],"133,77":[73],"132,76":[111],"133,76":[73,140],"132,75":[111],"133,75":[111],"132,74":[94],"133,74":[94],"132,73":[94],"133,73":[94],"132,72":[94],"133,72":[94],"132,71":[94],"133,71":[111],"132,70":[111],"133,70":[111],"132,69":[111],"133,69":[73],"132,68":[111],"133,68":[73,140],"132,67":[111],"133,67":[73],"132,66":[111],"133,66":[73],"134,66":[111],"135,66":[94],"134,67":[111],"135,67":[111],"134,68":[73],"135,68":[73],"134,69":[73],"135,69":[73],"134,70":[73],"135,70":[73],"134,71":[111],"135,71":[73],"134,72":[111],"135,72":[111],"134,73":[111],"135,73":[73],"134,74":[111],"135,74":[111],"134,75":[111],"135,75":[94],"134,76":[111],"135,76":[94],"134,77":[111],"135,77":[94],"136,77":[94],"137,77":[94],"136,76":[94],"137,76":[94],"136,75":[94],"137,75":[94],"136,74":[111],"137,74":[111],"136,73":[73],"137,73":[73],"136,72":[73,143],"137,72":[73,143],"136,71":[73],"137,71":[73,140],"136,70":[73],"137,70":[73],"136,69":[73],"137,69":[111],"136,68":[111],"137,68":[111],"136,67":[111],"137,67":[94],"136,66":[94],"137,66":[94],"138,66":[94],"139,66":[94],"138,67":[94],"139,67":[94],"138,68":[94],"139,68":[111],"138,69":[111],"139,69":[111],"138,70":[111],"139,70":[73],"138,71":[73,143],"139,71":[73,140],"138,72":[73,143],"139,72":[73,143],"138,73":[73,139],"139,73":[73],"138,74":[111],"139,74":[111],"138,75":[94],"139,75":[111],"138,76":[94],"139,76":[111],"138,77":[94],"139,77":[94],"140,77":[111],"141,77":[111],"140,76":[111],"141,76":[73],"140,75":[73],"141,75":[73],"140,74":[73],"141,74":[111],"140,73":[73],"141,73":[111],"140,72":[73,143],"141,72":[111],"140,71":[73],"141,71":[73],"140,70":[73],"141,70":[73],"140,69":[73],"141,69":[73],"140,68":[111],"141,68":[73],"140,67":[111],"141,67":[111],"140,66":[94],"141,66":[94],"142,66":[111],"142,67":[111],"142,68":[73],"142,69":[73],"142,70":[73],"142,71":[111],"142,72":[111],"142,73":[94],"142,74":[111],"142,75":[111],"142,76":[73],"142,77":[111]},"lvl-165,66":{"166,66":[73],"165,65":[73],"165,67":[111],"166,67":[111],"165,66":[73],"165,68":[94],"166,68":[94],"165,69":[94],"166,69":[94],"165,70":[111],"166,70":[111],"167,70":[111],"168,70":[111],"167,69":[111],"168,69":[73],"167,68":[111],"168,68":[73],"167,67":[111],"168,67":[94,140],"167,66":[73],"168,66":[73],"167,65":[73],"168,65":[73],"166,65":[73,143],"169,65":[73],"170,65":[73],"169,66":[111],"170,66":[73],"169,67":[111],"170,67":[73],"169,68":[73],"170,68":[73],"169,69":[73,143],"170,69":[73],"169,70":[111],"170,70":[73,139],"171,70":[111],"172,70":[111],"171,69":[73],"172,69":[111],"171,68":[73],"172,68":[111],"171,67":[73],"172,67":[111],"171,66":[73],"172,66":[111],"171,65":[73],"172,65":[111]},"lvl-126,67":{"126,66":[73,143],"125,67":[73],"126,68":[111],"126,67":[73],"125,68":[111],"126,69":[111],"125,69":[111],"124,69":[111],"124,68":[111],"123,69":[111],"123,68":[111],"122,69":[73],"122,68":[111],"121,69":[73],"121,68":[73],"120,69":[111],"120,68":[111],"119,69":[111],"119,68":[111],"118,69":[111],"118,68":[111],"117,69":[111],"117,68":[111],"117,67":[73],"118,67":[73],"117,66":[73,143],"118,66":[73,140,144],"117,65":[73],"118,65":[73],"117,64":[111],"118,64":[111],"117,63":[73],"118,63":[111],"119,63":[111],"120,63":[111],"119,64":[111],"120,64":[111],"119,65":[73],"120,65":[73],"119,66":[73,140,144],"120,66":[73,140,144],"119,67":[73],"120,67":[73],"121,67":[73],"122,67":[111],"121,66":[73,140,144],"122,66":[73,140],"121,65":[73],"122,65":[111],"121,64":[73],"122,64":[73],"121,63":[73],"122,63":[73],"123,63":[111],"124,63":[111],"123,64":[111],"124,64":[111],"123,65":[111],"124,65":[111],"123,66":[73,140],"124,66":[111],"123,67":[111],"124,67":[111],"125,66":[73],"125,65":[73],"126,65":[73],"125,64":[73],"126,64":[73,139],"125,63":[73],"126,63":[73]},"lvl-161,68":{"161,67":[111],"160,68":[73],"161,68":[73],"160,67":[73],"159,68":[73],"159,67":[73,139],"158,68":[73],"158,67":[73],"157,68":[111],"157,67":[111],"157,66":[94],"158,66":[73,143],"157,65":[111],"158,65":[111],"159,65":[111],"160,65":[111],"159,66":[73],"160,66":[73],"161,66":[73,140],"161,65":[111]},"lvl-161,71":{"161,70":[111],"160,71":[73,143],"161,72":[73],"161,71":[73],"160,72":[73,139],"161,73":[73],"160,73":[73],"159,73":[73],"159,72":[73],"158,73":[111],"158,72":[111],"157,73":[111],"157,72":[111],"157,71":[111],"158,71":[94,140],"157,70":[111],"158,70":[111],"159,70":[111],"160,70":[111],"159,71":[94]},"lvl-126,74":{"126,73":[111],"125,74":[73],"126,75":[73,139],"126,74":[73],"125,75":[111],"124,75":[111],"124,74":[73],"123,75":[111],"123,74":[73],"122,75":[111],"122,74":[73,143],"121,75":[73,139],"121,74":[73],"120,75":[73],"120,74":[73],"119,75":[73],"119,74":[73],"118,75":[111],"118,74":[73],"117,75":[111],"117,74":[73,143],"117,73":[111],"118,73":[73],"117,72":[73,143],"118,72":[73],"117,71":[111],"118,71":[111],"119,71":[111],"120,71":[111],"119,72":[111],"120,72":[111],"119,73":[73,140],"120,73":[73,140],"121,73":[73],"122,73":[111],"121,72":[73],"122,72":[73,143],"121,71":[111],"122,71":[111],"123,71":[111],"124,71":[73],"123,72":[73],"124,72":[73],"123,73":[111],"124,73":[73,140],"125,73":[73,140],"125,72":[73],"126,72":[73],"125,71":[73],"126,71":[111]},"lvl-165,75":{"166,75":[73],"165,74":[111],"165,76":[73,138],"166,76":[73,138],"165,75":[73],"165,77":[73],"166,77":[73],"167,77":[73,138],"168,77":[73],"167,76":[73],"168,76":[111],"167,75":[73],"168,75":[94],"167,74":[73],"168,74":[111],"167,73":[73,140],"166,74":[111],"166,73":[111],"166,72":[111],"165,73":[94],"165,72":[111],"167,72":[73],"168,72":[111],"169,72":[111],"168,73":[111],"169,73":[94],"170,73":[111],"169,74":[111],"170,74":[111],"169,75":[94],"170,75":[94],"169,76":[111],"170,76":[111],"169,77":[94],"170,77":[73,143],"171,77":[73],"172,77":[73],"171,76":[111],"172,76":[111],"171,75":[73],"172,75":[73],"171,74":[73,139],"172,74":[73],"171,73":[73],"172,73":[73],"171,72":[111],"172,72":[111],"170,72":[111],"173,72":[111],"173,73":[111],"173,74":[111],"173,75":[111],"173,76":[73],"173,77":[73]},"lvl-161,76":{"161,75":[73],"160,76":[73,139],"161,77":[73,143],"161,76":[73],"160,77":[73],"161,78":[73],"160,78":[73],"159,78":[73],"159,77":[94],"158,78":[73],"158,77":[73],"157,78":[73],"157,77":[73],"156,78":[73],"156,77":[73],"156,76":[73],"157,76":[73],"156,75":[73],"157,75":[73],"158,75":[73],"159,75":[73],"158,76":[73],"159,76":[94,140],"160,75":[73]},"lvl-126,80":{"126,79":[73,139],"125,80":[73],"126,81":[73],"126,80":[73],"125,81":[111],"124,81":[111],"124,80":[73],"123,81":[111],"123,80":[73],"122,81":[111],"122,80":[111],"121,81":[111],"121,80":[111],"120,81":[111],"120,80":[73],"120,79":[73],"121,79":[111],"120,78":[111],"121,78":[111],"122,78":[111],"123,78":[73],"122,79":[73,140],"123,79":[73,140,144],"124,79":[73,140,144],"125,79":[73,143],"124,78":[73],"125,78":[73],"126,78":[73]},"lvl-165,81":{"166,81":[73],"165,80":[73,138],"165,82":[73,138],"166,82":[73,140],"165,81":[73],"165,83":[73],"166,83":[73],"165,84":[111],"166,84":[73],"167,84":[111],"168,84":[111],"167,83":[73],"168,83":[94],"167,82":[73],"168,82":[111],"167,81":[73],"168,81":[73],"167,80":[111],"168,80":[73],"167,79":[111],"166,80":[73],"166,79":[73],"165,79":[73],"168,79":[73],"169,79":[73],"170,79":[73],"169,80":[73,138],"170,80":[111],"169,81":[73],"170,81":[111],"169,82":[73,143],"170,82":[111],"169,83":[94],"170,83":[94],"169,84":[111],"170,84":[111],"171,84":[111],"172,84":[111],"171,83":[73],"172,83":[111],"171,82":[73,139],"172,82":[111],"171,81":[73],"172,81":[111],"171,80":[111],"172,80":[111],"171,79":[73],"172,79":[73]},"lvl-161,82":{"161,81":[73],"160,82":[111],"161,83":[111],"161,82":[73],"160,83":[111],"161,84":[111],"160,84":[111],"161,85":[73],"160,85":[73],"161,86":[111],"160,86":[111],"159,86":[111],"159,85":[73,143],"158,86":[73],"158,85":[73],"157,86":[73],"157,85":[94],"156,86":[111],"156,85":[73],"155,86":[111],"155,85":[73],"154,86":[111],"154,85":[73],"154,84":[111],"155,84":[111],"154,83":[111],"155,83":[111],"154,82":[73],"155,82":[73],"154,81":[111],"155,81":[73],"154,80":[111],"155,80":[111],"156,80":[111],"157,80":[73],"156,81":[73,140,139],"157,81":[73],"156,82":[111],"157,82":[94],"156,83":[111],"157,83":[73],"156,84":[111],"157,84":[94],"158,84":[111],"159,84":[111],"158,83":[73,138],"159,83":[73],"158,82":[111],"159,82":[73],"158,81":[73],"159,81":[73,138],"158,80":[73],"159,80":[111],"160,80":[111],"161,80":[111],"160,81":[73]},"lvl-126,85":{"126,84":[73,139],"125,85":[73,143],"126,86":[111],"126,85":[73],"125,86":[73],"124,86":[111],"124,85":[73],"123,86":[111],"123,85":[111],"122,86":[73],"122,85":[73],"121,86":[73],"121,85":[73,143],"120,86":[111],"120,85":[73],"119,86":[111],"119,85":[111],"119,84":[111],"120,84":[73],"119,83":[111],"120,83":[111],"121,83":[111],"122,83":[111],"121,84":[73],"122,84":[73,140],"123,84":[73,140],"124,84":[73],"123,83":[111],"124,83":[111],"125,83":[73],"126,83":[73],"125,84":[73]},"lvl-165,88":{"166,88":[73],"165,87":[73],"165,89":[111],"166,89":[73],"165,88":[73],"165,90":[111],"166,90":[73],"165,91":[111],"166,91":[73],"167,91":[73,139],"168,91":[73],"167,90":[73,143],"168,90":[73],"167,89":[73,138],"168,89":[111],"167,88":[73],"168,88":[94],"167,87":[73,138],"168,87":[111],"167,86":[73],"166,87":[73],"166,86":[111],"165,86":[111],"168,86":[111],"169,86":[111],"170,86":[111],"169,87":[111],"170,87":[111],"169,88":[94,140],"170,88":[94],"169,89":[111],"170,89":[111],"169,90":[111],"170,90":[111],"169,91":[73],"170,91":[111],"171,91":[73],"172,91":[73],"171,90":[73,143],"172,90":[73],"171,89":[73],"172,89":[73],"171,88":[73],"172,88":[73],"171,87":[111],"172,87":[111],"171,86":[111],"172,86":[111],"173,86":[111],"173,87":[111],"173,88":[111],"173,89":[111],"173,90":[111],"173,91":[111]},"lvl-130,89":{"131,89":[111],"130,88":[73],"130,90":[111],"131,90":[111],"130,89":[73],"132,90":[94],"133,90":[94],"132,89":[111],"133,89":[94],"132,88":[111],"133,88":[111],"132,87":[73],"131,88":[73],"131,87":[73],"131,86":[73],"130,87":[73],"130,86":[73],"130,85":[111],"131,85":[73],"130,84":[111],"131,84":[111],"130,83":[94],"131,83":[111],"130,82":[94],"131,82":[94],"130,81":[94],"131,81":[94],"130,80":[94],"131,80":[94],"130,79":[111],"131,79":[94],"132,79":[94],"133,79":[94],"132,80":[94],"133,80":[111],"132,81":[94],"133,81":[111],"132,82":[111],"133,82":[111],"132,83":[111],"133,83":[73],"132,84":[73],"133,84":[73],"132,85":[73],"133,85":[73],"132,86":[73],"133,86":[73],"134,86":[111],"133,87":[111],"134,87":[111],"135,87":[94],"134,88":[94],"135,88":[94],"134,89":[94],"135,89":[94],"134,90":[94],"135,90":[94],"136,90":[94],"137,90":[111],"136,89":[94],"137,89":[111],"136,88":[94],"137,88":[94],"136,87":[94],"137,87":[94],"136,86":[94],"137,86":[94],"136,85":[111],"135,86":[111],"135,85":[111],"135,84":[73],"134,85":[73],"134,84":[73],"134,83":[73],"135,83":[73,139],"134,82":[73],"135,82":[73],"134,81":[73],"135,81":[73],"134,80":[111],"135,80":[111],"134,79":[94],"135,79":[111],"136,79":[111],"137,79":[111],"136,80":[73,140],"137,80":[73],"136,81":[111],"137,81":[73],"136,82":[73,143],"137,82":[73],"136,83":[73],"137,83":[111],"136,84":[111],"137,84":[111],"138,84":[94],"137,85":[94],"138,85":[94],"139,85":[94],"138,86":[94],"139,86":[94],"138,87":[94],"139,87":[111],"138,88":[111],"139,88":[111],"138,89":[111],"139,89":[73],"138,90":[73],"139,90":[73],"140,90":[73],"141,90":[73],"140,89":[73],"141,89":[73],"140,88":[73],"141,88":[73],"140,87":[111],"141,87":[73],"140,86":[111],"141,86":[111],"140,85":[94],"141,85":[111],"140,84":[94],"141,84":[94],"140,83":[94],"139,84":[94],"139,83":[94],"139,82":[94],"138,83":[111],"138,82":[111],"138,81":[111],"139,81":[111],"138,80":[73],"139,80":[73],"138,79":[73],"139,79":[73],"140,79":[73],"141,79":[111],"140,80":[111],"141,80":[111],"140,81":[111],"141,81":[94],"140,82":[94],"141,82":[94],"141,83":[94]},"lvl-126,90":{"126,89":[73],"125,90":[73,140],"126,91":[73,139],"126,90":[73],"125,91":[73],"126,92":[111],"125,92":[73],"124,92":[73],"124,91":[73,143],"123,92":[111],"123,91":[111],"123,90":[73],"124,90":[73],"123,89":[111],"124,89":[73,143],"123,88":[111],"124,88":[73],"125,88":[111],"126,88":[111],"125,89":[73,140]},"lvl-161,90":{"161,89":[111],"160,90":[73],"161,91":[111],"161,90":[73],"160,91":[111],"161,92":[111],"160,92":[73],"161,93":[111],"160,93":[111],"159,93":[73],"159,92":[73],"158,93":[73],"158,92":[73,138],"157,93":[73],"157,92":[73],"156,93":[73],"156,92":[73,139],"155,93":[73],"155,92":[73],"154,93":[111],"154,92":[73],"154,91":[111],"155,91":[111],"154,90":[73],"155,90":[73],"154,89":[111],"155,89":[94],"154,88":[111],"155,88":[111],"156,88":[111],"157,88":[73],"156,89":[111],"157,89":[111],"156,90":[73],"157,90":[73],"156,91":[73,143],"157,91":[73,138],"158,91":[73,140,138],"159,91":[73,138],"158,90":[73,138],"159,90":[73],"158,89":[73],"159,89":[73],"158,88":[73],"159,88":[73],"160,88":[111],"161,88":[111],"160,89":[73]},"lvl-130,94":{"131,94":[73],"130,93":[73,140],"131,93":[73],"130,92":[111],"130,94":[73],"131,92":[111],"132,92":[73,143],"133,92":[73],"132,93":[73,139],"133,93":[73],"132,94":[73,140,144],"133,94":[73],"134,94":[73],"135,94":[73],"134,93":[111],"135,93":[111],"134,92":[111],"135,92":[111]},"lvl-126,95":{"126,94":[73],"125,95":[73],"126,96":[73],"126,95":[73],"125,96":[73],"124,96":[111],"124,95":[73,140],"123,96":[73,140],"123,95":[111],"122,96":[73],"122,95":[73,139],"121,96":[73],"121,95":[73],"120,96":[111],"120,95":[73],"119,96":[111],"119,95":[73],"118,96":[111],"118,95":[73],"117,96":[111],"117,95":[73],"116,96":[111],"116,95":[73],"115,96":[73],"115,95":[73],"114,96":[73,143],"114,95":[111],"113,96":[73],"113,95":[73,143],"112,96":[73],"112,95":[73],"111,96":[73],"111,95":[111],"111,94":[111],"112,94":[73],"113,94":[73],"114,94":[73,143],"115,94":[73],"116,94":[111],"117,94":[111],"118,94":[111],"119,94":[111],"120,94":[111],"121,94":[73],"122,94":[73],"123,94":[73,140],"124,94":[73],"125,94":[73]},"lvl-130,98":{"131,98":[73,140],"130,97":[73],"130,99":[73,140],"131,99":[73,140],"130,98":[73,140],"132,99":[73],"133,99":[111],"132,98":[73,143],"133,98":[111],"132,97":[73],"133,97":[73],"132,96":[111],"131,97":[73],"131,96":[111],"130,96":[111],"133,96":[111],"134,96":[111],"135,96":[111],"134,97":[73,140,139],"135,97":[73],"134,98":[73,140],"135,98":[73,140],"134,99":[73,140],"135,99":[73,140],"136,99":[73,140],"137,99":[111],"136,98":[73,140],"137,98":[111],"136,97":[73],"137,97":[73],"136,96":[111],"137,96":[111]},"lvl-126,100":{"126,99":[73],"125,100":[73],"126,101":[73,139],"126,100":[73],"125,101":[73],"126,102":[111],"125,102":[73],"124,102":[111],"124,101":[111],"123,102":[73],"123,101":[111],"122,102":[73],"122,101":[73],"121,102":[73],"121,101":[111],"120,102":[111],"120,101":[111],"119,102":[111],"119,101":[111],"119,100":[111],"120,100":[73],"119,99":[111],"120,99":[73],"119,98":[111],"120,98":[111],"121,98":[73],"122,98":[73],"121,99":[73,140],"122,99":[73],"121,100":[73],"122,100":[73],"123,100":[73],"124,100":[73],"123,99":[111],"124,99":[111],"123,98":[73],"124,98":[111],"125,98":[73,143],"126,98":[111],"125,99":[73]},"lvl-130,103":{"131,103":[73],"130,102":[73,140],"131,102":[73,143],"130,101":[73,140],"130,103":[73],"131,101":[73,143],"132,101":[111],"133,101":[73,139],"132,102":[73],"133,102":[73],"132,103":[111],"133,103":[111],"134,103":[111],"135,103":[111],"134,102":[73],"135,102":[73],"134,101":[73],"135,101":[73],"136,101":[73],"137,101":[111],"136,102":[73],"137,102":[111],"136,103":[111],"137,103":[111]},"lvl-126,107":{"126,106":[111],"125,107":[73],"126,108":[111],"126,107":[73],"125,108":[73],"126,109":[111],"125,109":[73],"126,110":[73],"125,110":[73],"126,111":[111],"125,111":[73],"124,111":[111],"124,110":[73],"123,111":[111],"123,110":[73,139],"122,111":[111],"122,110":[73],"121,111":[73],"121,110":[73],"120,111":[111],"120,110":[73],"119,111":[111],"119,110":[73],"118,111":[73],"118,110":[73],"118,109":[73],"119,109":[111],"118,108":[73],"119,108":[111],"118,107":[73],"119,107":[73],"118,106":[73],"119,106":[111],"118,105":[73],"119,105":[73],"118,104":[73],"119,104":[111],"120,104":[111],"121,104":[73],"120,105":[73],"121,105":[73],"120,106":[111],"121,106":[73],"120,107":[73],"121,107":[73],"120,108":[111],"121,108":[73],"120,109":[111],"121,109":[73],"122,109":[111],"123,109":[111],"122,108":[111],"123,108":[111],"122,107":[73],"123,107":[73],"122,106":[111],"123,106":[73],"122,105":[73],"123,105":[73],"122,104":[111],"123,104":[111],"124,104":[111],"125,104":[73],"124,105":[73],"125,105":[73],"124,106":[111],"125,106":[73],"124,107":[73],"124,108":[111],"124,109":[111],"126,105":[73],"126,104":[111]},"lvl-130,107":{"131,107":[111],"130,106":[73],"131,106":[73,139],"130,105":[73,140],"130,107":[73],"131,105":[73],"132,105":[111],"133,105":[73,143],"132,106":[73],"133,106":[73],"132,107":[111],"133,107":[73],"134,107":[73],"135,107":[111],"134,106":[73],"135,106":[111],"134,105":[73],"135,105":[111]},"lvl-130,110":{"131,110":[73],"130,109":[73],"130,111":[73],"131,111":[73],"130,110":[73,140],"132,111":[73],"133,111":[73,139],"132,110":[73],"133,110":[73],"132,109":[73],"133,109":[73],"131,109":[73],"134,109":[73],"135,109":[73],"134,110":[73],"135,110":[73],"134,111":[73,143],"135,111":[73],"136,111":[73],"136,110":[73],"136,109":[73]},"lvl-130,114":{"131,114":[111],"130,113":[73],"130,115":[73],"131,115":[73],"130,114":[73],"132,115":[73],"133,115":[73],"132,114":[111],"133,114":[111],"132,113":[111],"133,113":[111],"131,113":[111],"134,113":[111],"135,113":[111],"134,114":[111],"135,114":[111],"134,115":[73,139],"135,115":[73],"136,115":[73],"137,115":[73],"136,114":[111],"137,114":[73],"136,113":[111],"137,113":[73]},"lvl-126,115":{"126,114":[73,140],"125,115":[111],"126,116":[73,139],"126,115":[73],"125,116":[73],"124,116":[111],"124,115":[73],"123,116":[111],"123,115":[73],"122,116":[111],"122,115":[111],"122,114":[111],"123,114":[73],"122,113":[111],"123,113":[73],"124,113":[73],"125,113":[73],"124,114":[73,143],"125,114":[111],"126,113":[73]},"lvl-130,118":{"131,118":[73],"130,117":[111],"130,119":[73],"131,119":[73,143],"130,118":[73],"130,120":[111],"131,120":[111],"132,120":[111],"133,120":[111],"132,119":[73],"133,119":[73,140],"132,118":[73],"133,118":[111],"132,117":[111],"133,117":[111],"131,117":[111],"134,117":[111],"135,117":[73,139],"134,118":[73],"135,118":[73],"134,119":[73],"135,119":[73],"134,120":[111],"135,120":[111],"136,120":[111],"137,120":[111],"136,119":[73],"137,119":[111],"136,118":[73],"137,118":[111],"136,117":[111],"137,117":[111]},"lvl-126,119":{"126,118":[73,143],"125,119":[73,139],"126,120":[111],"126,119":[73],"125,120":[111],"124,120":[73],"124,119":[73],"123,120":[111],"123,119":[73,140],"122,120":[111],"122,119":[73],"122,118":[73],"123,118":[73],"124,118":[73],"125,118":[73]},"lvl-126,122":{"125,122":[111],"126,123":[73],"126,122":[73],"125,123":[73],"126,124":[73,139],"125,124":[73],"126,125":[111],"125,125":[111],"124,125":[111],"124,124":[73,143],"123,125":[73],"123,124":[73],"122,125":[111],"122,124":[111],"122,123":[73],"123,123":[73],"122,122":[111],"123,122":[73],"124,122":[111],"124,123":[73,140]},"lvl-130,124":{"131,124":[73],"130,123":[111],"130,125":[111],"131,125":[111],"130,124":[73,140],"132,125":[111],"133,125":[111],"132,124":[73],"133,124":[73],"132,123":[73,143],"133,123":[73],"132,122":[73,139],"131,123":[111],"131,122":[73],"130,122":[111],"133,122":[73],"134,122":[111],"134,123":[111],"134,124":[111],"134,125":[111]},"lvl-68,146":{"69,146":[73],"68,145":[73],"67,146":[73],"68,146":[73],"67,145":[73,138],"66,146":[73],"66,145":[73],"66,144":[73],"67,144":[73],"66,143":[73],"67,143":[73],"66,142":[94],"67,142":[94],"66,141":[94],"67,141":[94],"66,140":[94],"67,140":[94,138],"66,139":[111],"67,139":[111],"66,138":[73,139],"67,138":[73],"66,137":[111],"67,137":[111],"68,137":[111],"69,137":[111],"68,138":[73],"69,138":[111],"68,139":[73],"69,139":[111],"68,140":[94],"69,140":[94],"68,141":[94],"69,141":[94],"68,142":[94],"69,142":[94],"68,143":[73],"69,143":[73],"68,144":[73],"69,144":[73],"70,144":[111],"69,145":[73,145],"70,145":[111],"70,146":[111],"70,143":[111],"70,142":[111],"70,141":[111],"70,140":[111],"70,139":[111],"70,138":[111],"70,137":[111]},"lvl-90,146":{"91,146":[73],"90,145":[73,145],"89,146":[73],"90,146":[73],"89,145":[73,145],"88,146":[73],"88,145":[73],"87,146":[73],"87,145":[73],"86,146":[73],"86,145":[73],"85,146":[73],"85,145":[73],"84,146":[73],"84,145":[73],"83,146":[73],"83,145":[73],"83,144":[73],"84,144":[73],"83,143":[73],"84,143":[73],"83,142":[73],"84,142":[73],"83,141":[73],"84,141":[73],"83,140":[73],"84,140":[73],"83,139":[73],"84,139":[73],"83,138":[73],"84,138":[73],"83,137":[73],"84,137":[73],"85,137":[73],"86,137":[73],"85,138":[73],"86,138":[73],"85,139":[73],"86,139":[73,138],"85,140":[73],"86,140":[73,138],"85,141":[73],"86,141":[73,138],"85,142":[73],"86,142":[73,138],"85,143":[73],"86,143":[73,138],"85,144":[73],"86,144":[73],"87,144":[73],"88,144":[73],"87,143":[73],"88,143":[94],"87,142":[73],"88,142":[94],"87,141":[73],"88,141":[94],"87,140":[73],"88,140":[94],"87,139":[73],"88,139":[94],"87,138":[73],"88,138":[73],"87,137":[73],"88,137":[73],"89,137":[73],"90,137":[73],"89,138":[73],"90,138":[73],"89,139":[94],"90,139":[94],"89,140":[94],"90,140":[94],"89,141":[94],"90,141":[94],"89,142":[94],"90,142":[94],"89,143":[94,138],"90,143":[94],"89,144":[73],"90,144":[73],"91,144":[73],"92,144":[73],"91,143":[94],"91,145":[73],"92,145":[73],"93,145":[73],"92,146":[73],"93,146":[73],"94,146":[73],"95,146":[73],"94,145":[73],"95,145":[73],"94,144":[73],"95,144":[73],"94,143":[73],"93,144":[73],"93,143":[73,138],"93,142":[73],"92,143":[73],"92,142":[73],"92,141":[73],"91,142":[94],"91,141":[94],"91,140":[94],"92,140":[73],"91,139":[94],"92,139":[73],"91,138":[73],"92,138":[73],"91,137":[73],"92,137":[73],"93,137":[73],"94,137":[73],"93,138":[73],"94,138":[73],"93,139":[73,138],"94,139":[73],"93,140":[73],"94,140":[73],"93,141":[73,139],"94,141":[73],"95,141":[73],"94,142":[73],"95,142":[73],"96,142":[73],"95,143":[73],"96,143":[73],"97,143":[73],"96,144":[73],"97,144":[73],"96,145":[73],"97,145":[73],"96,146":[73],"97,146":[73],"98,146":[73],"99,146":[73],"98,145":[73],"99,145":[73],"98,144":[73],"99,144":[73],"98,143":[73],"99,143":[73],"98,142":[73],"99,142":[73],"98,141":[73],"97,142":[73],"97,141":[73],"97,140":[73],"96,141":[73,140,143],"96,140":[73],"96,139":[111],"95,140":[73],"95,139":[73],"95,138":[73],"96,138":[73],"95,137":[73],"96,137":[73],"97,137":[73],"98,137":[73],"97,138":[73],"98,138":[73],"97,139":[111],"98,139":[73],"99,139":[73],"98,140":[73],"99,140":[73],"99,141":[73],"99,138":[73],"99,137":[73]},"lvl-111,146":{"112,146":[73],"111,145":[73,152],"110,146":[111],"111,146":[73],"110,145":[73,150],"109,146":[73],"109,145":[73],"108,146":[73],"108,145":[73],"107,146":[111],"107,145":[73],"106,146":[111],"106,145":[73],"105,146":[111],"105,145":[73],"104,146":[111],"104,145":[73],"104,144":[73],"105,144":[73],"104,143":[94],"105,143":[111],"104,142":[73,140],"105,142":[111],"104,141":[73,140],"105,141":[111],"104,140":[111],"105,140":[111],"106,140":[111],"107,140":[111],"106,141":[73],"107,141":[73],"106,142":[73],"107,142":[73],"106,143":[73,152],"107,143":[73,143],"106,144":[73],"107,144":[73],"108,144":[73],"109,144":[73],"108,143":[111],"109,143":[94],"108,142":[111],"109,142":[94],"108,141":[111],"109,141":[73,140],"108,140":[111],"109,140":[111],"110,140":[111],"111,140":[73],"110,141":[111],"111,141":[73],"110,142":[111],"111,142":[73,152],"110,143":[111],"111,143":[73],"110,144":[73],"111,144":[73],"112,144":[73],"113,144":[73],"112,143":[111],"112,145":[73,152],"113,145":[73],"114,145":[111],"113,146":[73],"114,146":[111],"114,144":[111],"114,143":[111],"114,142":[111],"113,143":[73],"113,142":[73,140],"113,141":[73],"112,142":[111],"112,141":[111],"112,140":[111],"113,140":[73],"114,140":[111],"114,141":[111]},"lvl-118,146":{"119,146":[73],"118,145":[111],"117,146":[73],"118,146":[73],"117,145":[94],"116,146":[73],"116,145":[111],"116,144":[111],"117,144":[73,140],"116,143":[111],"117,143":[73],"116,142":[111],"117,142":[111],"116,141":[111],"117,141":[73],"118,141":[73,139],"119,141":[73],"118,142":[111],"119,142":[111],"118,143":[111],"119,143":[111],"118,144":[111],"119,144":[73],"120,144":[73],"119,145":[73,152],"120,145":[73,154],"121,145":[73,143],"120,146":[73],"121,146":[73],"122,146":[73],"122,145":[111],"122,144":[111],"122,143":[111],"121,144":[73],"121,143":[73],"121,142":[111],"120,143":[111],"120,142":[111],"120,141":[111],"121,141":[111],"122,141":[111],"122,142":[111]},"lvl-130,146":{"130,145":[73],"129,146":[73],"130,146":[73],"129,145":[73],"128,146":[73],"128,145":[73],"127,146":[111],"127,145":[111],"126,146":[73],"126,145":[73],"125,146":[73],"125,145":[73],"125,144":[73,143],"126,144":[73,152],"125,143":[73],"126,143":[73],"125,142":[73],"126,142":[73,139],"127,142":[111],"128,142":[73],"127,143":[111],"128,143":[94,140],"127,144":[73,143],"128,144":[73],"129,144":[73],"130,144":[73],"129,143":[73],"130,143":[73],"129,142":[73],"130,142":[73]},"lvl-135,146":{"136,146":[73],"135,145":[111],"134,146":[73],"135,146":[73],"134,145":[73,143],"133,146":[73],"133,145":[111],"133,144":[73],"134,144":[73],"133,143":[73],"134,143":[73,143],"133,142":[73],"134,142":[111],"135,142":[111],"136,142":[111],"135,143":[73],"136,143":[73,152],"135,144":[94,140],"136,144":[73],"137,144":[73],"136,145":[73,139],"137,145":[111],"137,146":[111],"137,143":[73],"137,142":[111]},"lvl-157,146":{"158,146":[73],"157,145":[111],"156,146":[73],"157,146":[73],"156,145":[111],"155,146":[73],"155,145":[111],"154,146":[73],"154,145":[111],"153,146":[73],"153,145":[111],"152,146":[73],"152,145":[73],"151,146":[111],"151,145":[111],"151,144":[111],"152,144":[73],"151,143":[73],"152,143":[73],"151,142":[111],"152,142":[111],"153,142":[111],"154,142":[111],"153,143":[111],"154,143":[73],"153,144":[111],"154,144":[73],"155,144":[73],"156,144":[73],"155,143":[73,152],"156,143":[73],"155,142":[111],"156,142":[111],"157,142":[111],"158,142":[111],"157,143":[73,140],"158,143":[73],"157,144":[111],"158,144":[111],"158,145":[73,139]},"lvl-172,146":{"173,146":[164],"172,145":[164],"171,146":[164],"172,146":[164],
"171,145":[164],"170,146":[164],"170,145":[164],"170,144":[164],"171,144":[164],"170,143":[164],"171,143":[164],"170,142":[164],"171,142":[164,169],"170,141":[164],"171,141":[164],"170,140":[164],"171,140":[164,169],"170,139":[164],"171,139":[164],"170,138":[111],"171,138":[111],"172,138":[111],"173,138":[111],"172,139":[164],"173,139":[174],"172,140":[164],"173,140":[171],"172,141":[164],"173,141":[164],"172,142":[164,169],"173,142":[164,169],"172,143":[164],"173,143":[164],"172,144":[164,167],"173,144":[164],"174,144":[164],"173,145":[164],"174,145":[164],"175,145":[164],"174,146":[164],"175,146":[164],"176,146":[164],"177,146":[164],"176,145":[164],"177,145":[164],"176,144":[164],"177,144":[164,168],"176,143":[164],"175,144":[164],"175,143":[163],"175,142":[164],"174,143":[164],"174,142":[164,169],"174,141":[164],"175,141":[164],"174,140":[164],"175,140":[164],"174,139":[164],"175,139":[163],"174,138":[111],"175,138":[111],"176,138":[111],"177,138":[164,142],"176,139":[165],"177,139":[164],"176,140":[165],"177,140":[164],"176,141":[164,179],"177,141":[164],"176,142":[164],"177,142":[164],"178,142":[164],"177,143":[164],"178,143":[164],"179,143":[164],"178,144":[164],"179,144":[164,169],"178,145":[164],"179,145":[164],"178,146":[164],"179,146":[164],"180,146":[164],"181,146":[164],"180,145":[164],"181,145":[164],"180,144":[170],"181,144":[174],"180,143":[174],"181,143":[174,167],"180,142":[165],"181,142":[165,167],"180,141":[165],"179,142":[164],"179,141":[164],"179,140":[164,169],"178,141":[164,180],"178,140":[164],"178,139":[164,181],"179,139":[164],"178,138":[164],"179,138":[164],"180,138":[164],"181,138":[164],"180,139":[164],"181,139":[164],"180,140":[164],"181,140":[164],"182,140":[164],"181,141":[165],"182,141":[165],"183,141":[111],"182,142":[165],"183,142":[111],"182,143":[174],"183,143":[111],"182,144":[172],"183,144":[111],"182,145":[164],"183,145":[111],"182,146":[164],"183,146":[111],"183,140":[164],"183,139":[164],"183,138":[111],"182,139":[164],"182,138":[164]},"lvl-77,150":{"78,150":[73],"76,150":[73],"77,151":[73,143],"78,151":[73],"77,150":[73],"76,151":[73],"77,152":[73,143],"78,152":[73],"76,152":[73],"77,153":[111],"78,153":[111],"76,153":[73],"77,154":[111],"78,154":[73],"76,154":[73],"77,155":[111],"78,155":[73],"76,155":[111],"77,156":[73],"78,156":[73],"76,156":[111],"75,156":[73],"75,155":[73],"74,156":[73],"74,155":[73],"74,154":[73],"75,154":[73,140],"74,153":[73],"75,153":[73,140],"74,152":[111],"75,152":[73],"74,151":[111],"75,151":[73],"74,150":[111],"75,150":[111]},"lvl-81,150":{"82,150":[111],"80,150":[111],"81,151":[73],"82,151":[73],"81,150":[73],"80,151":[73],"81,152":[73,140],"82,152":[111],"80,152":[73,139],"81,153":[73],"82,153":[111],"80,153":[111],"83,153":[111],"84,153":[73],"83,152":[111],"84,152":[73,143],"83,151":[73,143],"84,151":[73],"83,150":[111],"84,150":[73,145],"85,150":[111],"86,150":[111],"85,151":[73,140],"86,151":[111],"85,152":[111],"86,152":[111],"85,153":[111],"86,153":[111]},"lvl-95,150":{"96,150":[111],"94,150":[111],"95,151":[73,145],"96,151":[111],"95,150":[73],"94,151":[111],"95,152":[73,140],"96,152":[111],"94,152":[111],"95,153":[73,143],"96,153":[111],"94,153":[111],"95,154":[73],"96,154":[111],"94,154":[111],"95,155":[73],"96,155":[111],"94,155":[73,139],"95,156":[111],"96,156":[111],"94,156":[111],"93,156":[111],"93,155":[73],"92,156":[94],"92,155":[94],"91,156":[111],"91,155":[94],"90,156":[94],"90,155":[94],"89,156":[111],"89,155":[94],"89,154":[94],"90,154":[111],"89,153":[94],"90,153":[94],"89,152":[111],"90,152":[94,140],"89,151":[111],"90,151":[94],"89,150":[111],"90,150":[94],"91,150":[94],"92,150":[94,143],"91,151":[111],"92,151":[94],"91,152":[111],"92,152":[94],"91,153":[94],"92,153":[94],"91,154":[111],"92,154":[94],"93,154":[111],"93,153":[111],"93,152":[111],"93,151":[94],"93,150":[94]},"lvl-104,150":{"105,150":[111],"103,150":[111],"104,151":[73,145],"105,151":[111],"104,150":[73],"103,151":[111],"104,152":[73,140],"105,152":[111],"103,152":[111],"104,153":[73,143],"105,153":[111],"103,153":[111],"104,154":[73],"105,154":[111],"103,154":[111],"104,155":[73],"105,155":[111],"103,155":[73,139],"104,156":[111],"105,156":[111],"103,156":[111],"102,156":[111],"102,155":[73],"102,154":[111],"102,153":[111],"102,152":[111],"102,151":[111],"102,150":[111]},"lvl-131,150":{"132,150":[111],"130,150":[111],"131,151":[73,140,139],"132,151":[111],"131,150":[73],"130,151":[111],"131,152":[73],"132,152":[111],"130,152":[111],"131,153":[73],"132,153":[111],"130,153":[111],"131,154":[73],"132,154":[111],"130,154":[111],"131,155":[73],"132,155":[111],"130,155":[111],"131,156":[73],"132,156":[111],"130,156":[111],"131,157":[73],"132,157":[111],"130,157":[73],"131,158":[73],"132,158":[73],"130,158":[73],"131,159":[111],"132,159":[111],"130,159":[73],"131,160":[111],"132,160":[111],"130,160":[111],"129,160":[111],"129,159":[73],"128,160":[111],"128,159":[111],"127,160":[111],"127,159":[111],"126,160":[111],"126,159":[73],"125,160":[111],"125,159":[73],"125,158":[73],"126,158":[73,143],"125,157":[73],"126,157":[73],"125,156":[73],"126,156":[73,152],"125,155":[73],"126,155":[73],"125,154":[111],"126,154":[73],"125,153":[111],"126,153":[73],"125,152":[73],"126,152":[73],"125,151":[73],"126,151":[73],"125,150":[111],"126,150":[111],"127,150":[111],"128,150":[73],"127,151":[73],"128,151":[73],"127,152":[111],"128,152":[73],"127,153":[111],"128,153":[111],"127,154":[111],"128,154":[111],"127,155":[111],"128,155":[111],"127,156":[111],"128,156":[111],"127,157":[111],"128,157":[73],"127,158":[111],"128,158":[73],"129,158":[73],"129,157":[73],"129,156":[73],"129,155":[73],"129,154":[73],"129,153":[73],"129,152":[73],"129,151":[73],"129,150":[73],"133,160":[111],"133,159":[111],"133,158":[111],"133,157":[111],"133,156":[111],"133,155":[111],"133,154":[111],"133,153":[111],"133,152":[111],"133,151":[111],"133,150":[111]},"lvl-136,150":{"137,150":[73],"135,150":[111],"136,151":[73,152],"137,151":[73],"136,150":[73],"135,151":[111],"136,152":[73],"137,152":[73,139],"135,152":[111],"136,153":[73,140],"137,153":[73],"135,153":[73],"136,154":[111],"137,154":[111],"135,154":[111],"138,154":[111],"139,154":[111],"138,153":[73,143],"139,153":[73],"138,152":[73],"139,152":[73],"138,151":[73],"139,151":[111],"138,150":[111],"139,150":[111]},"lvl-153,150":{"154,150":[73],"152,150":[73],"153,151":[73],"154,151":[73],"153,150":[73],"152,151":[73],"153,152":[111],"154,152":[94],"152,152":[94],"153,153":[111],"154,153":[73],"152,153":[73],"153,154":[111],"154,154":[73],"152,154":[73],"153,155":[73],"154,155":[73,140],"152,155":[73,140],"153,156":[111],"154,156":[111],"152,156":[111],"151,156":[111],"151,155":[111],"150,156":[111],"150,155":[73],"149,156":[111],"149,155":[73],"148,156":[111],"148,155":[73],"148,154":[73],"149,154":[73,152],"148,153":[73],"149,153":[73],"148,152":[111],"149,152":[73],"148,151":[111],"149,151":[73],"148,150":[111],"149,150":[111],"150,150":[111],"151,150":[111],"150,151":[73],"151,151":[73],"150,152":[73,139],"151,152":[111],"150,153":[73],"151,153":[111],"150,154":[73,143],"151,154":[111],"155,156":[111],"155,155":[111],"155,154":[111],"155,153":[111],"155,152":[111],"155,151":[111],"155,150":[111]},"lvl-159,150":{"160,150":[111],"158,150":[111],"159,151":[73],"160,151":[111],"159,150":[73],"158,151":[111],"159,152":[73],"160,152":[73,151],"158,152":[73],"159,153":[111],"160,153":[111],"158,153":[111],"157,153":[111],"157,152":[73],"157,151":[111],"157,150":[94],"161,153":[111],"161,152":[73],"161,151":[111],"161,150":[94]}},us={width:256,height:256},ls={63:"ice",64:"lava",73:"floor",82:"portal_solved",83:"portal_unexplored",84:"portal_unsolved",88:"sign_blocks",91:"sign_sliding",94:"space",111:"wall",113:"controls",126:"sign_danger",127:"time_immune_area",129:"sign_time",136:"sign_bridges",138:"block_basic",139:"block_portal",140:"energy_source",142:"block_portal_on",143:"block_stabilizer",144:"block_stabilizer_on",145:"time_immune_changer",150:"block_portal_ti",151:"block_portal_on_ti",152:"block_stabilizer_ti",153:"block_stabilizer_on_ti",154:"block_basic_ti",163:"water",164:"stone",165:"grass",166:"weeds",167:"watering_can_full",168:"watering_can_empty",169:"seeds",170:"soil_planted",171:"soil_planted_watered",172:"soil_watered",173:"plant_1",174:"soil",175:"light_beam",176:"block_light_up",177:"block_light_down",178:"block_light_left",179:"block_light_right",180:"block_mirror_2",181:"block_mirror_1"},cs={wall:"111",controls:"113",sign_danger:"126",time_immune_area:"127",sign_time:"129",sign_bridges:"136",block_basic:"138",block_portal:"139",energy_source:"140",block_portal_on:"142",block_stabilizer:"143",block_stabilizer_on:"144",time_immune_changer:"145",block_portal_ti:"150",block_portal_on_ti:"151",block_stabilizer_ti:"152",block_stabilizer_on_ti:"153",block_basic_ti:"154",water:"163",stone:"164",grass:"165",weeds:"166",watering_can_full:"167",watering_can_empty:"168",seeds:"169",soil_planted:"170",soil_planted_watered:"171",soil_watered:"172",plant_1:"173",soil:"174",light_beam:"175",block_light_up:"176",block_light_down:"177",block_light_left:"178",block_light_right:"179",block_mirror_2:"180",block_mirror_1:"181",ice:"63",lava:"64",floor:"73",portal_solved:"82",portal_unexplored:"83",portal_unsolved:"84",sign_blocks:"88",sign_sliding:"91",space:"94"},ds={layers:ss,tileSize:us,idToName:ls,nameToId:cs};Ya.system([],function(){function e(){Pt(this,e)}return Tt(e,[{key:"initialize",value:function(){rs.setData(ds),$a.send("loadTiles",{layer:"world"})}},{key:"pre",value:function(){$a.clear("loaded"),$a.process("loadTiles",function(e){rs.loadTiles(e),$a.send("loaded",e)})}}]),e}());var hs=r(function(e,t){!function(t){e.exports=function(){return function e(t,n,r){function o(s,u){if(!n[s]){if(!t[s]){var l="function"==typeof i&&i;if(!u&&l)return l(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[s]={exports:{}};t[s][0].call(d.exports,function(e){var n=t[s][1][e];return o(n||e)},d,d.exports,e,t,n,r)}return n[s].exports}for(var a="function"==typeof i&&i,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function r(){}var o="function"!=typeof Object.create&&"~";r.prototype._events=void 0,r.prototype.listeners=function(e,t){var n=o?o+e:e,i=this._events&&this._events[n];if(t)return!!i;if(!i)return[];if(i.fn)return[i.fn];for(var r=0,a=i.length,s=new Array(a);r<a;r++)s[r]=i[r].fn;return s},r.prototype.emit=function(e,t,n,i,r,a){var s=o?o+e:e;if(!this._events||!this._events[s])return!1;var u,l,c=this._events[s],d=arguments.length;if("function"==typeof c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,i),!0;case 5:return c.fn.call(c.context,t,n,i,r),!0;case 6:return c.fn.call(c.context,t,n,i,r,a),!0}for(l=1,u=new Array(d-1);l<d;l++)u[l-1]=arguments[l];c.fn.apply(c.context,u)}else{var h,f=c.length;for(l=0;l<f;l++)switch(c[l].once&&this.removeListener(e,c[l].fn,void 0,!0),d){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,t);break;case 3:c[l].fn.call(c[l].context,t,n);break;default:if(!u)for(h=1,u=new Array(d-1);h<d;h++)u[h-1]=arguments[h];c[l].fn.apply(c[l].context,u)}}return!0},r.prototype.on=function(e,t,n){var r=new i(t,n||this),a=o?o+e:e;return this._events||(this._events=o?{}:Object.create(null)),this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],r]:this._events[a].push(r):this._events[a]=r,this},r.prototype.once=function(e,t,n){var r=new i(t,n||this,!0),a=o?o+e:e;return this._events||(this._events=o?{}:Object.create(null)),this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],r]:this._events[a].push(r):this._events[a]=r,this},r.prototype.removeListener=function(e,t,n,i){var r=o?o+e:e;if(!this._events||!this._events[r])return this;var a=this._events[r],s=[];if(t)if(a.fn)(a.fn!==t||i&&!a.once||n&&a.context!==n)&&s.push(a);else for(var u=0,l=a.length;u<l;u++)(a[u].fn!==t||i&&!a[u].once||n&&a[u].context!==n)&&s.push(a[u]);return s.length?this._events[r]=1===s.length?s[0]:s:delete this._events[r],this},r.prototype.removeAllListeners=function(e){return this._events?(e?delete this._events[o?o+e:e]:this._events=o?{}:Object.create(null),this):this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prototype.setMaxListeners=function(){return this},r.prefixed=o,void 0!==t&&(t.exports=r)},{}],2:[function(e,t,n){n.__esModule=!0;var i=e("./lib/input.js"),r=function(e){return e&&e.__esModule?e:{default:e}}(i);n.default=r.default,t.exports=n.default},{"./lib/input.js":3}],3:[function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":It(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}n.__esModule=!0;var a=e("eventemitter3"),s=i(a);e("./polyfill.js");var u=e("./touch.js"),l=i(u),c="ontouchstart"in window,d=c?{touchstart:"start",touchmove:"move",touchend:"end",touchcancel:"end"}:{mousedown:"start",mousemove:"move",mouseup:"end"},h=Object.keys(d),f=function(e){function t(){r(this,t),e.call(this),this.touches=new Set,this.actives=new Map,this.tickBound=this.tick.bind(this),this.tickInterval=0,this.pooledTouches=[]}return o(t,e),t.prototype.attach=function(){var e=this;this.attached||(this.attached=!0,this.tickInterval=window.requestAnimationFrame(this.tickBound),h.forEach(function(t){return window.addEventListener(t,e,!1)}))},t.prototype.detach=function(){var e=this;this.attached&&(this.attached=!1,window.cancelAnimationFrame(this.tickInterval),h.forEach(function(t){return window.removeEventListener(t,e,!1)}))},t.prototype.handleEvent=function(e){e.preventDefault();for(var t=d[e.type],n=c?e.changedTouches:[e],i=0,r=n.length;i<r;i++){var o=n[i];if("start"!==t){var a=o.identifier||0;if(this.actives.has(a)){var s=this.actives.get(a);"end"!==t?s.move(o):(s.end(),this.actives.delete(s.id))}}else{var u=this.pooledTouches.pop()||new l.default(this);u.fromTouch(o),this.actives.set(u.id,u),this.touches.add(u)}}},t.prototype.tick=function(){var e=this;this.tickInterval=window.requestAnimationFrame(this.tickBound),this.touches.forEach(function(t){if(t.isFinal)return t.delete(),e.touches.delete(t),void e.pooledTouches.push(t);t.tick()})},t}(s.default);n.default=new f,t.exports=n.default},{"./polyfill.js":4,"./touch.js":5,eventemitter3:1}],4:[function(e,t,n){"performance"in window||(window.performance=window.webkitPerformance||{}),"now"in performance||(performance.now=function(){return Date.now()})},{}],5:[function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":It(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}n.__esModule=!0;var a,s,u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=e("eventemitter3"),c=i(l),d=e("./vec2d.js"),h=i(d),f={BEGAN:"began",MOVED:"moved",STATIONARY:"stationary",ENDED:"ended",CANCELED:"canceled",BEGIN:"willBegin",END:"willEnd"},p=(a={},a[f.BEGIN]=f.BEGAN,a[f.BEGAN]=f.STATIONARY,a[f.END]=f.ENDED,a),v=(s={},s[f.BEGAN]="touchBegan",s[f.STATIONARY]="touchStationary",s[f.MOVED]="touchMoved",s[f.ENDED]="touchEnded",s.deleted="touchDeleted",s),_=function(e){function t(n){r(this,t),e.call(this),this.input=n,this.id=0,this.phase="",this.time=0,this.startTime=0,this.previousTime=0,this.position=h.default.create(0,0),this.startPosition=h.default.create(0,0),this.previousPosition=h.default.create(0,0),this.positions=new Set,this.didUpdate=!1,this.details=null}return o(t,e),t.prototype.fromTouch=function(e){this.id=e.identifier||0,this.startTime=performance.now(),this.time=this.startTime,this.startPosition[0]=e.pageX,this.startPosition[1]=e.pageY,this.position.set(this.startPosition),this.previousPosition.set(this.startPosition),this.phase=f.BEGIN},t.prototype.tick=function(){this.previousTime=this.time,this.time=performance.now();var e=!1;p[this.phase]?(this.phase=p[this.phase],e=!0):this.didMove&&(e=!0,this.phase!==f.MOVED&&(this.phase=f.MOVED)),e&&this.emit(this.phase),this.didUpdate=!1,this.didMove=!1},t.prototype.move=function(e){this.markUpdated(),this.didMove=!0,this.position[0]=e.pageX,this.position[1]=e.pageY,this.positions.add(h.default.create(this.position[0],this.position[1]))},t.prototype.end=function(){this.markUpdated(),this.phase=f.END},t.prototype.markUpdated=function(){this.didUpdate||(this.didUpdate=!0,h.default.freeAll(this.positions),this.previousPosition.set(this.position))},t.prototype.emit=function(t){var n={touch:this};e.prototype.emit.call(this,t,n),this.input.emit(v[t],n)},t.prototype.delete=function(){this.emit("deleted"),this.removeAllListeners(),h.default.freeAll(this.positions),this.details=null},u(t,[{key:"deltaTime",get:function(){return this.time-this.previousTime}},{key:"isFinal",get:function(){return this.phase===f.ENDED}}]),t}(c.default);n.default=_,t.exports=n.default},{"./vec2d.js":6,eventemitter3:1}],6:[function(e,t,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=function(){function e(){i(this,e),this.pool=[]}return e.prototype.create=function(e,t){var n=this.pool.pop()||new Uint32Array(2);return n[0]=e,n[1]=t,n},e.prototype.free=function(e){this.pool.push(e)},e.prototype.freeAll=function(e){e.forEach(this.free,this),e.clear()},e}();n.default=new r,t.exports=n.default},{}]},{},[2])(2)}()}()}),fs=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(hs),ps=r(function(e,t){(function(){var e,n,i,r,o,a,s,u,l,c,d,h,f,p,v,_,y,m,g,b={}.hasOwnProperty,k=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};a={is_unordered:!1,is_counting:!1,is_exclusive:!1,is_solitary:!1,prevent_default:!1,prevent_repeat:!1,normalize_caps_lock:!1},m="meta alt option ctrl shift cmd".split(" "),_="ctrl",e={debug:!1};var w=function(e){var t,n;for(t in e)b.call(e,t)&&!1!==(n=e[t])&&(this[t]=n);this.keys=this.keys||[],this.count=this.count||0};w.prototype.allows_key_repeat=function(){return!this.prevent_repeat&&"function"==typeof this.on_keydown},w.prototype.reset=function(){return this.count=0,this.keyup_fired=null};var x=function(e,t){var n,i;"undefined"!=typeof jQuery&&null!==jQuery&&e instanceof jQuery&&(1!==e.length&&v("Warning: your jQuery selector should have exactly one object."),e=e[0]),this.should_force_event_defaults=this.should_suppress_event_defaults=!1,this.sequence_delay=800,this._registered_combos=[],this._keys_down=[],this._active_combos=[],this._sequence=[],this._sequence_timer=null,this._prevent_capture=!1,this._defaults=t||{};for(n in a)b.call(a,n)&&(i=a[n],this._defaults[n]=this._defaults[n]||i);this.element=e||document.body,n=function(e,t,n){return e.addEventListener?e.addEventListener(t,n):e.attachEvent&&e.attachEvent("on"+t,n),n};var r=this;this.keydown_event=n(this.element,"keydown",function(e){return e=e||window.event,r._receive_input(e,!0),r._bug_catcher(e)});var o=this;this.keyup_event=n(this.element,"keyup",function(e){return e=e||window.event,o._receive_input(e,!1)});var s=this;this.blur_event=n(window,"blur",function(){var e,t,n,i;for(i=s._keys_down,t=0,n=i.length;t<n;t++)e=i[t],s._key_up(e,{});return s._keys_down=[]})};x.prototype.destroy=function(){var e;return e=function(e,t,n){return null!=e.removeEventListener?e.removeEventListener(t,n):null!=e.removeEvent?e.removeEvent("on"+t,n):void 0},e(this.element,"keydown",this.keydown_event),e(this.element,"keyup",this.keyup_event),e(window,"blur",this.blur_event)},x.prototype._bug_catcher=function(e){var t,n;if("cmd"===_&&0<=k.call(this._keys_down,"cmd")&&"cmd"!==(t=r(null!=(n=e.keyCode)?n:e.key))&&"shift"!==t&&"alt"!==t&&"caps"!==t&&"tab"!==t)return this._receive_input(e,!1)},x.prototype._cmd_bug_check=function(e){return!("cmd"===_&&0<=k.call(this._keys_down,"cmd")&&0>k.call(e,"cmd"))},x.prototype._prevent_default=function(e,t){if((t||this.should_suppress_event_defaults)&&!this.should_force_event_defaults&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation))return e.stopPropagation()},x.prototype._get_active_combos=function(e){var t,n;return t=[],n=s(this._keys_down,function(t){return t!==e}),n.push(e),this._match_combo_arrays(n,function(e){return function(n){if(e._cmd_bug_check(n.keys))return t.push(n)}}(this)),this._fuzzy_match_combo_arrays(n,function(e){return function(n){if(!(0<=k.call(t,n))&&!n.is_solitary&&e._cmd_bug_check(n.keys))return t.push(n)}}(this)),t},x.prototype._get_potential_combos=function(e){var t,n,i,r,o;for(n=[],o=this._registered_combos,i=0,r=o.length;i<r;i++)t=o[i],t.is_sequence||0<=k.call(t.keys,e)&&this._cmd_bug_check(t.keys)&&n.push(t);return n},x.prototype._add_to_active_combos=function(e){var t,n,i,r,o,a,s,u,l,c,d;if(a=!1,o=!0,i=!1,0<=k.call(this._active_combos,e))return!0;if(this._active_combos.length)for(r=s=0,c=this._active_combos.length;0<=c?s<c:s>c;r=0<=c?++s:--s)if((t=this._active_combos[r])&&t.is_exclusive&&e.is_exclusive){if(t=t.keys,!a)for(u=0,l=t.length;u<l;u++)if(n=t[u],a=!0,0>k.call(e.keys,n)){a=!1;break}if(o&&!a)for(d=e.keys,u=0,l=d.length;u<l;u++)if(n=d[u],o=!1,0>k.call(t,n)){o=!0;break}a&&(i?null!=(t=this._active_combos.splice(r,1)[0])&&t.reset():(t=this._active_combos.splice(r,1,e)[0],null!=t&&t.reset(),i=!0),o=!1)}return o&&this._active_combos.unshift(e),a||o},x.prototype._remove_from_active_combos=function(e){var t,n,i;for(t=n=0,i=this._active_combos.length;0<=i?n<i:n>i;t=0<=i?++n:--n)if(this._active_combos[t]===e){e=this._active_combos.splice(t,1)[0],e.reset();break}},x.prototype._get_possible_sequences=function(){var e,t,n,i,r,o,a,u,l,c,d,h;for(i=[],c=this._registered_combos,o=0,l=c.length;o<l;o++)for(e=c[o],t=a=1,d=this._sequence.length;1<=d?a<=d:a>=d;t=1<=d?++a:--a)if(r=this._sequence.slice(-t),e.is_sequence){if(0>k.call(e.keys,"shift")&&(r=s(r,function(e){return"shift"!==e}),!r.length))continue;for(t=u=0,h=r.length;0<=h?u<h:u>h;t=0<=h?++u:--u){if(e.keys[t]!==r[t]){n=!1;break}n=!0}n&&i.push(e)}return i},x.prototype._add_key_to_sequence=function(e,t){var n,i,r,o;if(this._sequence.push(e),i=this._get_possible_sequences(),i.length){for(r=0,o=i.length;r<o;r++)n=i[r],this._prevent_default(t,n.prevent_default);if(this._sequence_timer&&clearTimeout(this._sequence_timer),-1<this.sequence_delay){var a=this;this._sequence_timer=setTimeout(function(){return a._sequence=[]},this.sequence_delay)}}else this._sequence=[]},x.prototype._get_sequence=function(e){var t,n,i,r,o,a,u,l,c,d,h,f;for(d=this._registered_combos,a=0,c=d.length;a<c;a++)if(t=d[a],t.is_sequence){for(n=u=1,h=this._sequence.length;1<=h?u<=h:u>=h;n=1<=h?++u:--u)if(o=s(this._sequence,function(e){return 0<=k.call(t.keys,"shift")||"shift"!==e}).slice(-n),t.keys.length===o.length)for(n=l=0,f=o.length;0<=f?l<f:l>f;n=0<=f?++l:--l)if(r=o[n],!(0>k.call(t.keys,"shift")&&"shift"===r||"shift"===e&&0>k.call(t.keys,"shift"))){if(t.keys[n]!==r){i=!1;break}i=!0}if(i)return t.is_exclusive&&(this._sequence=[]),t}return!1},x.prototype._receive_input=function(e,t){var n,i;if(this._prevent_capture)this._keys_down.length&&(this._keys_down=[]);else if(n=r(null!=(i=e.keyCode)?i:e.key),(t||this._keys_down.length||!("alt"===n||n===_))&&n)return t?this._key_down(n,e):this._key_up(n,e)},x.prototype._fire=function(e,t,n,i){if("function"==typeof t["on_"+e]&&this._prevent_default(n,!0!==t["on_"+e].call(t.this,n,t.count,i)),"release"===e&&(t.count=0),"keyup"===e)return t.keyup_fired=!0},x.prototype._match_combo_arrays=function(e,t){var r,o,a,s,u;for(u=this._registered_combos,a=0,s=u.length;a<s;a++)o=u[a],r=e.slice(0),o.normalize_caps_lock&&0<=k.call(r,"caps")&&r.splice(r.indexOf("caps"),1),(!o.is_unordered&&i(r,o.keys)||o.is_unordered&&n(r,o.keys))&&t(o)},x.prototype._fuzzy_match_combo_arrays=function(e,t){var n,i,r,o;for(o=this._registered_combos,i=0,r=o.length;i<r;i++)n=o[i],(!n.is_unordered&&c(n.keys,e)||n.is_unordered&&l(n.keys,e))&&t(n)},x.prototype._keys_remain=function(e){var t,n,i,r;for(r=e.keys,n=0,i=r.length;n<i;n++)if(e=r[n],0<=k.call(this._keys_down,e)){t=!0;break}return t},x.prototype._key_down=function(e,t){var n,i,r,a,s;(n=o(e,t))&&(e=n),this._add_key_to_sequence(e,t),(n=this._get_sequence(e))&&this._fire("keydown",n,t);for(r in y)n=y[r],t[n]&&(r===e||0<=k.call(this._keys_down,r)||this._keys_down.push(r));for(r in y)if(n=y[r],r!==e&&0<=k.call(this._keys_down,r)&&!t[n]&&!("cmd"===r&&"cmd"!==_))for(n=i=0,a=this._keys_down.length;0<=a?i<a:i>a;n=0<=a?++i:--i)this._keys_down[n]===r&&this._keys_down.splice(n,1);for(i=this._get_active_combos(e),r=this._get_potential_combos(e),a=0,s=i.length;a<s;a++)n=i[a],this._handle_combo_down(n,r,e,t);if(r.length)for(i=0,a=r.length;i<a;i++)n=r[i],this._prevent_default(t,n.prevent_default);0>k.call(this._keys_down,e)&&this._keys_down.push(e)},x.prototype._handle_combo_down=function(e,t,n,i){var r,o,a,s,u;if(0>k.call(e.keys,n))return!1;if(this._prevent_default(i,e&&e.prevent_default),r=!1,0<=k.call(this._keys_down,n)&&(r=!0,!e.allows_key_repeat()))return!1;if(a=this._add_to_active_combos(e,n),n=e.keyup_fired=!1,e.is_exclusive)for(s=0,u=t.length;s<u;s++)if(o=t[s],o.is_exclusive&&o.keys.length>e.keys.length){n=!0;break}return!n&&(e.is_counting&&"function"==typeof e.on_keydown&&(e.count+=1),a)?this._fire("keydown",e,i,r):void 0},x.prototype._key_up=function(e,t){var n,i,r,a,s,u;if(n=e,(r=o(e,t))&&(e=r),r=p[n],t.shiftKey?r&&0<=k.call(this._keys_down,r)||(e=n):n&&0<=k.call(this._keys_down,n)||(e=r),(a=this._get_sequence(e))&&this._fire("keyup",a,t),0>k.call(this._keys_down,e))return!1;for(a=s=0,u=this._keys_down.length;0<=u?s<u:s>u;a=0<=u?++s:--s)if((i=this._keys_down[a])===e||i===r||i===n){this._keys_down.splice(a,1);break}for(i=this._active_combos.length,r=[],u=this._active_combos,a=0,s=u.length;a<s;a++)n=u[a],0<=k.call(n.keys,e)&&r.push(n);for(a=0,s=r.length;a<s;a++)n=r[a],this._handle_combo_up(n,t,e);if(1<i)for(s=this._active_combos,i=0,a=s.length;i<a;i++)void 0===(n=s[i])||0<=k.call(r,n)||this._keys_remain(n)||this._remove_from_active_combos(n)},x.prototype._handle_combo_up=function(e,t,i){var r,o;this._prevent_default(t,e&&e.prevent_default),o=this._keys_remain(e),e.keyup_fired||(r=this._keys_down.slice(),r.push(i),e.is_solitary&&!n(r,e.keys))||(this._fire("keyup",e,t),e.is_counting&&"function"==typeof e.on_keyup&&"function"!=typeof e.on_keydown&&(e.count+=1)),o||(this._fire("release",e,t),this._remove_from_active_combos(e))},x.prototype.simple_combo=function(e,t){return this.register_combo({keys:e,on_keydown:t})},x.prototype.counting_combo=function(e,t){return this.register_combo({keys:e,is_counting:!0,is_unordered:!1,on_keydown:t})},x.prototype.sequence_combo=function(e,t){return this.register_combo({keys:e,on_keydown:t,is_sequence:!0,is_exclusive:!0})},x.prototype.register_combo=function(e){var t,n,i;"string"==typeof e.keys&&(e.keys=e.keys.split(" ")),i=this._defaults;for(t in i)b.call(i,t)&&(n=i[t],void 0===e[t]&&(e[t]=n));if(e=new w(e),g(e))return this._registered_combos.push(e),e},x.prototype.register_many=function(e){var t,n,i,r;for(r=[],n=0,i=e.length;n<i;n++)t=e[n],r.push(this.register_combo(t));return r},x.prototype.unregister_combo=function(e){var t,r,o,a,s,u;if(!e)return!1;var l=this;if(r=function(e){var t,n,i,r;for(r=[],t=n=0,i=l._registered_combos.length;0<=i?n<i:n>i;t=0<=i?++n:--n){if(e===l._registered_combos[t]){l._registered_combos.splice(t,1);break}r.push(void 0)}return r},e instanceof w)return r(e);for("string"==typeof e&&(e=e.split(" ")),s=this._registered_combos,u=[],o=0,a=s.length;o<a;o++)null!=(t=s[o])&&(t.is_unordered&&n(e,t.keys)||!t.is_unordered&&i(e,t.keys)?u.push(r(t)):u.push(void 0));return u},x.prototype.unregister_many=function(e){var t,n,i,r;for(r=[],n=0,i=e.length;n<i;n++)t=e[n],r.push(this.unregister_combo(t));return r},x.prototype.get_registered_combos=function(){return this._registered_combos},x.prototype.reset=function(){return this._registered_combos=[]},x.prototype.listen=function(){return this._prevent_capture=!1},x.prototype.stop_listening=function(){return this._prevent_capture=!0},x.prototype.get_meta_key=function(){return _},e.Listener=x,r=function(e){return f[e]},s=function(e,t){var n;if(e.filter)return e.filter(t);var i,r,o;for(o=[],i=0,r=e.length;i<r;i++)n=e[i],t(n)&&o.push(n);return o},n=function(e,t){var n,i,r;if(e.length!==t.length)return!1;for(i=0,r=e.length;i<r;i++)if(n=e[i],!(0<=k.call(t,n)))return!1;return!0},i=function(e,t){var n,i,r;if(e.length!==t.length)return!1;for(n=i=0,r=e.length;0<=r?i<r:i>r;n=0<=r?++i:--i)if(e[n]!==t[n])return!1;return!0},l=function(e,t){var n,i,r;for(i=0,r=e.length;i<r;i++)if(n=e[i],0>k.call(t,n))return!1;return!0},u=Array.prototype.indexOf||function(e,t){var n,i,r;for(n=i=0,r=e.length;0<=r?i<=r:i>=r;n=0<=r?++i:--i)if(e[n]===t)return n;return-1},c=function(e,t){var n,i,r,o;for(r=i=0,o=e.length;r<o;r++){if(n=e[r],!((n=u.call(t,n))>=i))return!1;i=n}return!0},v=function(){if(e.debug)return console.log.apply(console,arguments)},d=function(e){var t,n,i;t=!1;for(i in f)if(n=f[i],e===n){t=!0;break}if(!t)for(i in p)if(n=p[i],e===n){t=!0;break}return t},g=function(e){var t,n,i,r,o,s,l;for(o=!0,e.keys.length||v("You're trying to bind a combo with no keys:",e),n=s=0,l=e.keys.length;0<=l?s<l:s>l;n=0<=l?++s:--s)i=e.keys[n],(t=h[i])&&(i=e.keys[n]=t),"meta"===i&&e.keys.splice(n,1,_),"cmd"===i&&v('Warning: use the "meta" key rather than "cmd" for Windows compatibility');for(l=e.keys,t=0,s=l.length;t<s;t++)i=l[t],d(i)||(v('Do not recognize the key "'+i+'"'),o=!1);if(0<=k.call(e.keys,"meta")||0<=k.call(e.keys,"cmd")){for(t=e.keys.slice(),s=0,l=m.length;s<l;s++)i=m[s],-1<(n=u.call(t,i))&&t.splice(n,1);1<t.length&&(v("META and CMD key combos cannot have more than 1 non-modifier keys",e,t),o=!1)}for(r in e)"undefined"===a[r]&&v("The property "+r+" is not a valid combo property. Your combo has still been registered.");return o},o=function(e,t){var n;return!!t.shiftKey&&(null!=(n=p[e])&&n)},y={cmd:"metaKey",ctrl:"ctrlKey",shift:"shiftKey",alt:"altKey"},h={escape:"esc",control:"ctrl",command:"cmd",break:"pause",windows:"cmd",option:"alt",caps_lock:"caps",apostrophe:"'",semicolon:";",tilde:"~",accent:"`",scroll_lock:"scroll",num_lock:"num"},p={"/":"?",".":">",",":"<","'":'"',";":":","[":"{","]":"}","\\":"|","`":"~","=":"+","-":"_",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")"},f={0:"\\",8:"backspace",9:"tab",12:"num",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"caps",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",44:"print",45:"insert",46:"delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",91:"cmd",92:"cmd",93:"cmd",96:"num_0",97:"num_1",98:"num_2",99:"num_3",100:"num_4",101:"num_5",102:"num_6",103:"num_7",104:"num_8",105:"num_9",106:"num_multiply",107:"num_add",108:"num_enter",109:"num_subtract",110:"num_decimal",111:"num_divide",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",124:"print",144:"num",
145:"scroll",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"`",224:"cmd",225:"alt",57392:"ctrl",63289:"num",59:";",61:"=",173:"-"},e._keycode_dictionary=f,e._is_array_in_array_sorted=c,-1!==navigator.userAgent.indexOf("Mac OS X")&&(_="cmd"),-1!==navigator.userAgent.indexOf("Opera")&&(f[17]="cmd"),null!==t?t.keypress=e:window.keypress=e}).call(this)}),vs=function(){function e(t,n){var i=this;Pt(this,e),this.keys={},n.forEach(function(e){i.keys[e]=!1,t.register_combo({keys:e,on_keydown:function(){i.keys[e]=!0},on_keyup:function(){i.keys[e]=!1},prevent_repeat:!0})})}return Tt(e,[{key:"pressed",value:function(e){return e in this.keys&&this.keys[e]}}]),e}(),_s=function(){function e(t,n,i){Pt(this,e),this.keys=t,this.delays=[0,n,i],this.timers={}}return Tt(e,[{key:"setInitialDelay",value:function(e){this.delays[1]=e}},{key:"setDelay",value:function(e){this.delays[2]=e}},{key:"update",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.keys.forEach(function(r){r in t.timers||(t.timers[r]={state:0,time:0});var o=t.timers[r];if(r in n&&n[r]){var a=t.delays[o.state];o.time+=1e3*e,o.time>=a&&(o.time-=a,o.state>=1&&o.time>a&&(o.time=0),o.state=Math.min(2,o.state+1),"function"==typeof i&&i(r))}else o.state=0,o.time=0})}}]),e}(),ys=60,ms=250,gs=.25,bs=new ps.keypress.Listener;Ya.system([],function(){function e(){Pt(this,e),this.buttons={},this.keys=new vs(bs,["z"]),this.undoTimer=new _s(["z"],ms,ys),bs.simple_combo("esc",function(){$a.send("exitLevel")}),bs.simple_combo("r",function(){$a.send("restart")})}return Tt(e,[{key:"getTexture",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return PIXI.utils.TextureCache[e+(t?"_down":"")+".png"]}},{key:"createButton",value:function(e,t){var n=this,i=new PIXI.Sprite(this.getTexture(e));this.buttons[e]={sprite:i,down:!1},i.buttonMode=!0,i.interactive=!0,i.anchor.set(.5),i.x=96,i.y=96,i.scale.x=.5,i.scale.y=.5;var r=function(r){return function(){n.buttons[e].down=r,i.texture=n.getTexture(e,r),r&&"function"==typeof t&&t(),r?$a.send("buttonFocus"):setTimeout(function(){$a.data.buttonFocus.pop()},200)}};i.on("pointerdown",r(!0)),i.on("pointerup",r(!1)),i.on("pointerupoutside",r(!1)),ts.addChild(i)}},{key:"initialize",value:function(){this.createButton("ui_rewind"),this.createButton("ui_restart",function(){return $a.send("restart")}),this.createButton("ui_exit",function(){return $a.send("exitLevel")}),this.windowResized()}},{key:"windowResized",value:function(){this.buttons.ui_exit.sprite.x=Za.renderer.width-96,this.buttons.ui_restart.sprite.x=Za.renderer.width-256}},{key:"show",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.buttons.ui_exit.sprite.visible=e,this.buttons.ui_restart.sprite.visible=e}},{key:"pre",value:function(e){var t=this;this.undoTimer.update(e,{z:this.keys.pressed("z")||this.buttons.ui_rewind.down},function(e){return $a.send("undo")}),$a.process("windowResized",function(){return t.windowResized()}),$a.loop("loaded",function(e){t.show(!rs.inWorld())}),$a.exists("loaded")&&$a.clear("buttonFocus")}}]),e}()),Ya.system([],function(){function e(){Pt(this,e),this.keys=new vs(bs,["i","o"]),bs.simple_combo("u",function(){os.scale=gs}),bs.simple_combo("p",function(){os.scale=1})}return Tt(e,[{key:"initialize",value:function(){os.scale=gs}},{key:"pre",value:function(e){this.keys.pressed("i")&&(os.scale*=1+1*e),this.keys.pressed("o")&&(os.scale*=1-1*e)}}]),e}()),Ya.system(["inputMovement"],function(){function e(){Pt(this,e),this.currentKey=void 0,this.moveDelta={x:0,y:0},this.lastMoveDelta={x:0,y:0},this.keys={},this.touching=!1,this.id=0,this.initKeyboardInput(),this.initTouchInput()}return Tt(e,[{key:"pre",value:function(){var e=this;if($a.process("resetKeys",function(){e.resetKeys()}),!this.touching){var t=0;this.moveDelta={x:0,y:0},this.currentKey=void 0;for(var n in this.keys){var i=this.keys[n];i.down&&i.lastId>t&&(this.moveDelta.x=i.delta.x,this.moveDelta.y=i.delta.y,this.currentKey=n,t=i.lastId)}0==t&&(this.id=0)}0===this.moveDelta.x&&0===this.moveDelta.y||(this.lastMoveDelta.x=this.moveDelta.x,this.lastMoveDelta.y=this.moveDelta.y)}},{key:"every",value:function(e,t,n){var i=this;e.currentDirection.x=0,e.currentDirection.y=0;var r={};this.currentKey&&(r[this.currentKey]=!0),this.moveTimer.update(n,r,function(n){e.currentDirection.x=i.moveDelta.x,e.currentDirection.y=i.moveDelta.y,t.set("time",i.moveTimer.delays[2]),t.set("direction",{x:i.moveDelta.x,y:i.moveDelta.y})}),e.lastDirection.x=this.lastMoveDelta.x,e.lastDirection.y=this.lastMoveDelta.y}},{key:"makeKey",value:function(e,t){return{delta:{x:e,y:t},down:!1,lastId:0}}},{key:"resetKeys",value:function(){for(var e in this.keys)this.keys[e].down=!1}},{key:"bindKey",value:function(e){var t=this;bs.register_combo({keys:e,on_keydown:function(){t.keys[e].down=!0,t.keys[e].lastId=++t.id},on_keyup:function(){t.keys[e].down=!1},prevent_repeat:!0})}},{key:"initKeyboardInput",value:function(){var e=this;this.keys={w:this.makeKey(0,-1),a:this.makeKey(-1,0),s:this.makeKey(0,1),d:this.makeKey(1,0),up:this.makeKey(0,-1),left:this.makeKey(-1,0),down:this.makeKey(0,1),right:this.makeKey(1,0)};for(var t in this.keys)this.bindKey(t);this.moveTimer=new _s(Object.keys(this.keys),ms,150,function(t){return e.handleMove(t)}),bs.register_combo({keys:"shift",on_keydown:function(){e.moveTimer.setDelay(ys)},on_keyup:function(){e.moveTimer.setDelay(150)},prevent_repeat:!0})}},{key:"initTouchInput",value:function(){var e=this,t=[{key:"right",x:1,y:0},{key:"down",x:0,y:1},{key:"left",x:-1,y:0},{key:"up",x:0,y:-1}],n=function(n){if(!$a.exists("buttonFocus")){var i={x:Ua.gameSize.width/2,y:Ua.gameSize.height/2},r=180*Math.atan2(n[1]-i.y,n[0]-i.x)/Math.PI,o=t[dt(Math.round(dt(r/90,4)),4)];e.touching=!0,e.moveDelta={x:o.x,y:o.y},e.currentKey=o.key}};fs.attach(),fs.on("touchBegan",function(t){n(t.touch.position),t.touch.on("moved",function(e){n(e.touch.position)}),t.touch.on("ended",function(){e.touching=!1})})}}]),e}());var ks=function(){function e(){Pt(this,e),this.actions=[]}return Tt(e,[{key:"push",value:function(e){var t=new ws(e);return t.execute()?(this.actions.push(t),!0):(t.rollback(),!1)}},{key:"pushToLast",value:function(e){if(this.actions.length>0){if(this.actions.top().addChild(e))return!0;this.actions.top().rollbackLast()}return!1}},{key:"pop",value:function(){if(this.actions.length>0){for(var e=!0;e&&this.actions.length>0;)e=!this.actions.top().undo(),this.actions.pop();return!0}return!1}},{key:"reset",value:function(){this.actions=[]}}]),e}(),ws=function(){function e(t){Pt(this,e),this.children=[],this.action=t}return Tt(e,[{key:"execute",value:function(){var e=lt(this.action,"execute",this);return this.addChildren(e)}},{key:"rollback",value:function(){for(;this.children.length>0;)this.children.top().rollback(),this.children.pop();lt(this.action,"rollback",this)}},{key:"rollbackLast",value:function(){this.children.length>0&&(this.children.top().rollback(),this.children.pop())}},{key:"rollbackIfOptional",value:function(){return!!this.action.optional&&(this.rollback(),!0)}},{key:"undo",value:function(){for(var e=!1,t=this.children.length-1;t>=0;--t){this.children[t].undo()&&(e=!0)}var n=lt(this.action,"undo",this);return e||n}},{key:"addChild",value:function(t){var n=new e(t);return this.children.push(n),n.execute()}},{key:"addChildren",value:function(e){if(!1===e)return this.rollbackIfOptional();if("object"===(void 0===e?"undefined":It(e))&&void 0===e.length&&(e=[e]),e&&e.length>0){var t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value;if(!this.addChild(a))return this.rollbackIfOptional()}}catch(e){n=!0,i=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw i}}}return!0}}]),e}(),xs=["data/audio.ogg","data/audio.m4a"],As={block_activated_reversed:[0,730.8163265306123],block_activated:[2e3,730.8163265306123],block_deactivated_reversed:[4e3,901.6099773242629],block_deactivated:[6e3,901.6099773242629],block_slide_reversed:[8e3,243.80952380952436],block_slide:[1e4,243.80952380952436],build_bridge_reversed:[12e3,458.8888888888896],build_bridge:[14e3,458.8888888888896],"player_walk_floor.0":[16e3,201.72335600906877],"player_walk_floor.1":[18e3,174.14965986394648],"player_walk_floor.2":[2e4,204.62585034013614],"player_walk_floor.3":[22e3,193.01587301587375],"player_walk_floor.4":[24e3,184.30839002267518],"player_walk_floor.5":[26e3,206.07709750566983],"player_walk_floor.6":[28e3,184.30839002267518],"player_walk_floor.7":[3e4,142.94784580498998],"player_walk_floor_reversed.0":[32e3,201.72335600906877],"player_walk_floor_reversed.1":[34e3,174.14965986394293],"player_walk_floor_reversed.2":[36e3,204.62585034013614],"player_walk_floor_reversed.3":[38e3,193.01587301587375],"player_walk_floor_reversed.4":[4e4,184.30839002267874],"player_walk_floor_reversed.5":[42e3,206.07709750566983],"player_walk_floor_reversed.6":[44e3,184.30839002267874],"player_walk_floor_reversed.7":[46e3,142.94784580498998],"player_walk_grass.0":[48e3,247.43764172335858],"player_walk_grass.1":[5e4,246.71201814059174],"player_walk_grass.2":[52e3,208.9795918367372],"player_walk_grass.3":[54e3,240.18140589569015],"player_walk_grass.4":[56e3,235.8276643990962],"player_walk_grass.5":[58e3,219.86394557823274],"player_walk_grass.6":[6e4,240.18140589569015],"player_walk_grass.7":[62e3,224.94331065759354],"player_walk_grass_reversed.0":[64e3,247.43764172335148],"player_walk_grass_reversed.1":[66e3,246.71201814058463],"player_walk_grass_reversed.2":[68e3,208.9795918367372],"player_walk_grass_reversed.3":[7e4,240.18140589569725],"player_walk_grass_reversed.4":[72e3,235.8276643990962],"player_walk_grass_reversed.5":[74e3,219.86394557822564],"player_walk_grass_reversed.6":[76e3,240.18140589569725],"player_walk_grass_reversed.7":[78e3,224.94331065759354],"player_walk_water.0":[8e4,175.60090702947662],"player_walk_water.1":[82e3,238.00453514739672],"player_walk_water.2":[84e3,233.65079365079566],"player_walk_water.3":[86e3,354.1043083900206],"player_walk_water.4":[88e3,171.24716553287556],"player_walk_water.5":[9e4,127.34693877551706],"player_walk_water.6":[92e3,130.61224489796075],"player_walk_water.7":[94e3,157.46031746031974],"player_walk_water_reversed.0":[96e3,175.60090702947662],"player_walk_water_reversed.1":[98e3,238.00453514739672],"player_walk_water_reversed.2":[1e5,233.65079365079566],"player_walk_water_reversed.3":[102e3,354.1043083900206],"player_walk_water_reversed.4":[104e3,171.24716553287556],"player_walk_water_reversed.5":[106e3,127.34693877551706],"player_walk_water_reversed.6":[108e3,130.61224489796075],"player_walk_water_reversed.7":[11e4,157.46031746031974],portal_active_reversed:[112e3,4736.870748299324],portal_active:[118e3,4736.870748299324]},Ss={src:xs,sprite:As},zs=r(function(e,t){!function(){var e=function(){this.init()};e.prototype={init:function(){var e=this||n;return e._counter=1e3,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.mobileAutoEnable=!0,e._setup(),e},volume:function(e){var t=this||n;if(e=parseFloat(e),t.ctx||c(),void 0!==e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&(t.masterGain.gain.value=e);for(var i=0;i<t._howls.length;i++)if(!t._howls[i]._webAudio)for(var r=t._howls[i]._getSoundIds(),o=0;o<r.length;o++){var a=t._howls[i]._soundById(r[o]);a&&a._node&&(a._node.volume=a._volume*e)}return t}return t._volume},mute:function(e){var t=this||n;t.ctx||c(),t._muted=e,t.usingWebAudio&&(t.masterGain.gain.value=e?0:t._volume);for(var i=0;i<t._howls.length;i++)if(!t._howls[i]._webAudio)for(var r=t._howls[i]._getSoundIds(),o=0;o<r.length;o++){var a=t._howls[i]._soundById(r[o]);a&&a._node&&(a._node.muted=!!e||a._muted)}return t},unload:function(){for(var e=this||n,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,c()),e},codecs:function(e){return(this||n)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||n;if(e.state=e.ctx?e.ctx.state||"running":"running",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{var t=new Audio;void 0===t.oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{var t=new Audio;t.muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||n,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!t||"function"!=typeof t.canPlayType)return e;var i=t.canPlayType("audio/mpeg;").replace(/^no$/,""),r=e._navigator&&e._navigator.userAgent.match(/OPR\/([0-6].)/g),o=r&&parseInt(r[0].split("/")[1],10)<33;return e._codecs={mp3:!(o||!i&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!i,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_enableMobileAudio:function(){var e=this||n,t=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(e._navigator&&e._navigator.userAgent),i=!!("ontouchend"in window||e._navigator&&e._navigator.maxTouchPoints>0||e._navigator&&e._navigator.msMaxTouchPoints>0);if(!e._mobileEnabled&&e.ctx&&(t||i)){e._mobileEnabled=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var r=function t(){n._autoResume();var i=e.ctx.createBufferSource();i.buffer=e._scratchBuffer,i.connect(e.ctx.destination),void 0===i.start?i.noteOn(0):i.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),i.onended=function(){i.disconnect(0),e._mobileEnabled=!0,e.mobileAutoEnable=!1,document.removeEventListener("touchstart",t,!0),document.removeEventListener("touchend",t,!0)}};return document.addEventListener("touchstart",r,!0),document.addEventListener("touchend",r,!0),e}},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&n.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var i=0;i<e._howls[t]._sounds.length;i++)if(!e._howls[t]._sounds[i]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){e.autoSuspend&&(e._suspendTimer=null,e.state="suspending",e.ctx.suspend().then(function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())}))},3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&n.usingWebAudio)return"running"===e.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state?(e.ctx.resume().then(function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var n=new e,i=function(e){var t=this;if(!e.src||0===e.src.length)return void console.error("An array of source files must be passed with any new Howl.");t.init(e)};i.prototype={init:function(e){var t=this;return n.ctx||c(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhrWithCredentials=e.xhrWithCredentials||!1,t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onresume=[],t._webAudio=n.usingWebAudio&&!t._html5,void 0!==n.ctx&&n.ctx&&n.mobileAutoEnable&&n._enableMobileAudio(),n._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&t.load(),t},load:function(){var e=this,t=null;if(n.noAudio)return void e._emit("loaderror",null,"No audio support.");"string"==typeof e._src&&(e._src=[e._src]);for(var i=0;i<e._src.length;i++){var o,s;if(e._format&&e._format[i])o=e._format[i];else{if("string"!=typeof(s=e._src[i])){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}o=/^data:audio\/([^;,]+);/i.exec(s),o||(o=/\.([^.]+)$/.exec(s.split("?",1)[0])),o&&(o=o[1].toLowerCase())}if(o||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),o&&n.codecs(o)){t=e._src[i];break}}return t?(e._src=t,e._state="loading","https:"===window.location.protocol&&"http:"===t.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new r(e),e._webAudio&&a(e),e):void e._emit("loaderror",null,"No codec support for selected audio sources.")},play:function(e,t){var i=this,r=null;if("number"==typeof e)r=e,e=null;else{if("string"==typeof e&&"loaded"===i._state&&!i._sprite[e])return null;if(void 0===e){e="__default";for(var o=0,a=0;a<i._sounds.length;a++)i._sounds[a]._paused&&!i._sounds[a]._ended&&(o++,r=i._sounds[a]._id);1===o?e=null:r=null}}var s=r?i._soundById(r):i._inactiveSound();if(!s)return null;if(r&&!e&&(e=s._sprite||"__default"),"loaded"!==i._state){s._sprite=e,s._ended=!1;var u=s._id;return i._queue.push({event:"play",action:function(){i.play(u)}}),u}if(r&&!s._paused)return t||setTimeout(function(){i._emit("play",s._id)},0),s._id;i._webAudio&&n._autoResume();var l=Math.max(0,s._seek>0?s._seek:i._sprite[e][0]/1e3),c=Math.max(0,(i._sprite[e][0]+i._sprite[e][1])/1e3-l),d=1e3*c/Math.abs(s._rate);s._paused=!1,s._ended=!1,s._sprite=e,s._seek=l,s._start=i._sprite[e][0]/1e3,s._stop=(i._sprite[e][0]+i._sprite[e][1])/1e3,s._loop=!(!s._loop&&!i._sprite[e][2]);var h=s._node;if(i._webAudio){var f=function(){i._refreshBuffer(s);var e=s._muted||i._muted?0:s._volume;h.gain.setValueAtTime(e,n.ctx.currentTime),s._playStart=n.ctx.currentTime,void 0===h.bufferSource.start?s._loop?h.bufferSource.noteGrainOn(0,l,86400):h.bufferSource.noteGrainOn(0,l,c):s._loop?h.bufferSource.start(0,l,86400):h.bufferSource.start(0,l,c),d!==1/0&&(i._endTimers[s._id]=setTimeout(i._ended.bind(i,s),d)),t||setTimeout(function(){i._emit("play",s._id)},0)};"running"===n.state?f():(i.once("resume",f),i._clearTimer(s._id))}else{var p=function(){h.currentTime=l,h.muted=s._muted||i._muted||n._muted||h.muted,h.volume=s._volume*n.volume(),h.playbackRate=s._rate;try{if(h.play(),h.paused)return void i._emit("playerror",s._id,"Playback was unable to start. This is most commonly an issue on mobile devices where playback was not within a user interaction.");d!==1/0&&(i._endTimers[s._id]=setTimeout(i._ended.bind(i,s),d)),t||i._emit("play",s._id)}catch(e){i._emit("playerror",s._id,e)}},v=window&&window.ejecta||!h.readyState&&n._navigator.isCocoonJS;if(4===h.readyState||v)p();else{var _=function e(){p(),h.removeEventListener(n._canPlayEvent,e,!1)};h.addEventListener(n._canPlayEvent,_,!1),i._clearTimer(s._id)}}return s._id},pause:function(e){var t=this;if("loaded"!==t._state)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var n=t._getSoundIds(e),i=0;i<n.length;i++){t._clearTimer(n[i]);var r=t._soundById(n[i]);if(r&&!r._paused&&(r._seek=t.seek(n[i]),r._rateSeek=0,r._paused=!0,t._stopFade(n[i]),r._node))if(t._webAudio){if(!r._node.bufferSource)continue;void 0===r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),t._cleanBuffer(r._node)}else isNaN(r._node.duration)&&r._node.duration!==1/0||r._node.pause();arguments[1]||t._emit("pause",r?r._id:null)}return t},stop:function(e,t){var n=this;if("loaded"!==n._state)return n._queue.push({event:"stop",action:function(){n.stop(e)}}),n;for(var i=n._getSoundIds(e),r=0;r<i.length;r++){n._clearTimer(i[r]);var o=n._soundById(i[r]);o&&(o._seek=o._start||0,o._rateSeek=0,o._paused=!0,o._ended=!0,n._stopFade(i[r]),o._node&&(n._webAudio?o._node.bufferSource&&(void 0===o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),n._cleanBuffer(o._node)):isNaN(o._node.duration)&&o._node.duration!==1/0||(o._node.currentTime=o._start||0,o._node.pause())),t||n._emit("stop",o._id))}return n},mute:function(e,t){var i=this;if("loaded"!==i._state)return i._queue.push({event:"mute",action:function(){i.mute(e,t)}}),i;if(void 0===t){if("boolean"!=typeof e)return i._muted;i._muted=e}for(var r=i._getSoundIds(t),o=0;o<r.length;o++){var a=i._soundById(r[o]);a&&(a._muted=e,i._webAudio&&a._node?a._node.gain.setValueAtTime(e?0:a._volume,n.ctx.currentTime):a._node&&(a._node.muted=!!n._muted||e),i._emit("mute",a._id))}return i},volume:function(){var e,t,i=this,r=arguments;if(0===r.length)return i._volume;if(1===r.length||2===r.length&&void 0===r[1]){i._getSoundIds().indexOf(r[0])>=0?t=parseInt(r[0],10):e=parseFloat(r[0])}else r.length>=2&&(e=parseFloat(r[0]),t=parseInt(r[1],10));var o;if(!(void 0!==e&&e>=0&&e<=1))return o=t?i._soundById(t):i._sounds[0],o?o._volume:0;if("loaded"!==i._state)return i._queue.push({event:"volume",action:function(){i.volume.apply(i,r)}}),i;void 0===t&&(i._volume=e),t=i._getSoundIds(t);for(var a=0;a<t.length;a++)(o=i._soundById(t[a]))&&(o._volume=e,r[2]||i._stopFade(t[a]),i._webAudio&&o._node&&!o._muted?o._node.gain.setValueAtTime(e,n.ctx.currentTime):o._node&&!o._muted&&(o._node.volume=e*n.volume()),i._emit("volume",o._id));return i},fade:function(e,t,i,r){var o=this;if("loaded"!==o._state)return o._queue.push({event:"fade",action:function(){o.fade(e,t,i,r)}}),o;o.volume(e,r);for(var a=o._getSoundIds(r),s=0;s<a.length;s++){var u=o._soundById(a[s]);if(u){if(r||o._stopFade(a[s]),o._webAudio&&!u._muted){var l=n.ctx.currentTime,c=l+i/1e3;u._volume=e,u._node.gain.setValueAtTime(e,l),u._node.gain.linearRampToValueAtTime(t,c)}o._startFadeInterval(u,e,t,i,a[s])}}return o},_startFadeInterval:function(e,t,n,i,r){var o=this,a=t,s=t>n?"out":"in",u=Math.abs(t-n),l=u/.01,c=l>0?i/l:i;c<4&&(l=Math.ceil(l/(4/c)),c=4),e._interval=setInterval(function(){l>0&&(a+="in"===s?.01:-.01),a=Math.max(0,a),a=Math.min(1,a),a=Math.round(100*a)/100,o._webAudio?(void 0===r&&(o._volume=a),e._volume=a):o.volume(a,e._id,!0),(n<t&&a<=n||n>t&&a>=n)&&(clearInterval(e._interval),e._interval=null,o.volume(n,e._id),o._emit("fade",e._id))},c)},_stopFade:function(e){var t=this,i=t._soundById(e);return i&&i._interval&&(t._webAudio&&i._node.gain.cancelScheduledValues(n.ctx.currentTime),clearInterval(i._interval),i._interval=null,t._emit("fade",e)),t},loop:function(){var e,t,n,i=this,r=arguments;if(0===r.length)return i._loop;if(1===r.length){if("boolean"!=typeof r[0])return!!(n=i._soundById(parseInt(r[0],10)))&&n._loop;e=r[0],i._loop=e}else 2===r.length&&(e=r[0],t=parseInt(r[1],10));for(var o=i._getSoundIds(t),a=0;a<o.length;a++)(n=i._soundById(o[a]))&&(n._loop=e,i._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=e,e&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop)));return i},rate:function(){var e,t,i=this,r=arguments;if(0===r.length)t=i._sounds[0]._id;else if(1===r.length){var o=i._getSoundIds(),a=o.indexOf(r[0]);a>=0?t=parseInt(r[0],10):e=parseFloat(r[0])}else 2===r.length&&(e=parseFloat(r[0]),t=parseInt(r[1],10));var s;if("number"!=typeof e)return s=i._soundById(t),s?s._rate:i._rate;if("loaded"!==i._state)return i._queue.push({event:"rate",action:function(){i.rate.apply(i,r)}}),i;void 0===t&&(i._rate=e),t=i._getSoundIds(t);for(var u=0;u<t.length;u++)if(s=i._soundById(t[u])){s._rateSeek=i.seek(t[u]),s._playStart=i._webAudio?n.ctx.currentTime:s._playStart,s._rate=e,i._webAudio&&s._node&&s._node.bufferSource?s._node.bufferSource.playbackRate.value=e:s._node&&(s._node.playbackRate=e);var l=i.seek(t[u]),c=(i._sprite[s._sprite][0]+i._sprite[s._sprite][1])/1e3-l,d=1e3*c/Math.abs(s._rate);!i._endTimers[t[u]]&&s._paused||(i._clearTimer(t[u]),i._endTimers[t[u]]=setTimeout(i._ended.bind(i,s),d)),i._emit("rate",s._id)}return i},seek:function(){var e,t,i=this,r=arguments;if(0===r.length)t=i._sounds[0]._id;else if(1===r.length){var o=i._getSoundIds(),a=o.indexOf(r[0]);a>=0?t=parseInt(r[0],10):i._sounds.length&&(t=i._sounds[0]._id,e=parseFloat(r[0]))}else 2===r.length&&(e=parseFloat(r[0]),t=parseInt(r[1],10));if(void 0===t)return i;if("loaded"!==i._state)return i._queue.push({event:"seek",action:function(){i.seek.apply(i,r)}}),i;var s=i._soundById(t);if(s){if(!("number"==typeof e&&e>=0)){if(i._webAudio){var u=i.playing(t)?n.ctx.currentTime-s._playStart:0,l=s._rateSeek?s._rateSeek-s._seek:0;return s._seek+(l+u*Math.abs(s._rate))}return s._node.currentTime}var c=i.playing(t);c&&i.pause(t,!0),s._seek=e,s._ended=!1,i._clearTimer(t),c&&i.play(t,!0),!i._webAudio&&s._node&&(s._node.currentTime=e),i._emit("seek",t)}return i},playing:function(e){var t=this;if("number"==typeof e){var n=t._soundById(e);return!!n&&!n._paused}for(var i=0;i<t._sounds.length;i++)if(!t._sounds[i]._paused)return!0;return!1},duration:function(e){var t=this,n=t._duration,i=t._soundById(e);return i&&(n=t._sprite[i._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,i=0;i<t.length;i++){if(t[i]._paused||e.stop(t[i]._id),!e._webAudio){/MSIE |Trident\//.test(n._navigator&&n._navigator.userAgent)||(t[i]._node.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"),t[i]._node.removeEventListener("error",t[i]._errorFn,!1),t[i]._node.removeEventListener(n._canPlayEvent,t[i]._loadFn,!1)}delete t[i]._node,e._clearTimer(t[i]._id);var r=n._howls.indexOf(e);r>=0&&n._howls.splice(r,1)}var a=!0;for(i=0;i<n._howls.length;i++)if(n._howls[i]._src===e._src){a=!1;break}return o&&a&&delete o[e._src],n.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,n,i){var r=this,o=r["_on"+e];return"function"==typeof t&&o.push(i?{id:n,fn:t,once:i}:{id:n,fn:t}),r},off:function(e,t,n){var i=this,r=i["_on"+e],o=0;if("number"==typeof t&&(n=t,t=null),t||n)for(o=0;o<r.length;o++){var a=n===r[o].id;if(t===r[o].fn&&a||!t&&a){r.splice(o,1);break}}else if(e)i["_on"+e]=[];else{var s=Object.keys(i);for(o=0;o<s.length;o++)0===s[o].indexOf("_on")&&Array.isArray(i[s[o]])&&(i[s[o]]=[])}return i},once:function(e,t,n){var i=this;return i.on(e,t,n,1),i},_emit:function(e,t,n){for(var i=this,r=i["_on"+e],o=r.length-1;o>=0;o--)r[o].id&&r[o].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,n)}.bind(i,r[o].fn),0),r[o].once&&i.off(e,r[o].fn,r[o].id));return i},_loadQueue:function(){var e=this;if(e._queue.length>0){var t=e._queue[0];e.once(t.event,function(){e._queue.shift(),e._loadQueue()}),t.action()}return e},_ended:function(e){var t=this,i=e._sprite;if(!t._webAudio&&e._node&&!e._node.paused)return setTimeout(t._ended.bind(t,e),100),t;var r=!(!e._loop&&!t._sprite[i][2]);if(t._emit("end",e._id),!t._webAudio&&r&&t.stop(e._id,!0).play(e._id),t._webAudio&&r){t._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=n.ctx.currentTime;var o=1e3*(e._stop-e._start)/Math.abs(e._rate);t._endTimers[e._id]=setTimeout(t._ended.bind(t,e),o)}return t._webAudio&&!r&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,t._clearTimer(e._id),t._cleanBuffer(e._node),n._autoSuspend()),t._webAudio||r||t.stop(e._id),t},_clearTimer:function(e){var t=this;return t._endTimers[e]&&(clearTimeout(t._endTimers[e]),delete t._endTimers[e]),t},_soundById:function(e){for(var t=this,n=0;n<t._sounds.length;n++)if(e===t._sounds[n]._id)return t._sounds[n];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new r(e)},_drain:function(){var e=this,t=e._pool,n=0,i=0;if(!(e._sounds.length<t)){for(i=0;i<e._sounds.length;i++)e._sounds[i]._ended&&n++;for(i=e._sounds.length-1;i>=0;i--){if(n<=t)return;e._sounds[i]._ended&&(e._webAudio&&e._sounds[i]._node&&e._sounds[i]._node.disconnect(0),e._sounds.splice(i,1),n--)}}},_getSoundIds:function(e){var t=this;if(void 0===e){for(var n=[],i=0;i<t._sounds.length;i++)n.push(t._sounds[i]._id);return n}return[e]},_refreshBuffer:function(e){var t=this;return e._node.bufferSource=n.ctx.createBufferSource(),e._node.bufferSource.buffer=o[t._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop),e._node.bufferSource.playbackRate.value=e._rate,t},_cleanBuffer:function(e){var t=this;if(t._scratchBuffer){e.bufferSource.onended=null,e.bufferSource.disconnect(0);try{e.bufferSource.buffer=t._scratchBuffer}catch(e){}}return e.bufferSource=null,t}};var r=function(e){this._parent=e,this.init()};r.prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++n._counter,t._sounds.push(e),e.create(),e},create:function(){var e=this,t=e._parent,i=n._muted||e._muted||e._parent._muted?0:e._volume;return t._webAudio?(e._node=void 0===n.ctx.createGain?n.ctx.createGainNode():n.ctx.createGain(),e._node.gain.setValueAtTime(i,n.ctx.currentTime),e._node.paused=!0,e._node.connect(n.masterGain)):(e._node=new Audio,e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(n._canPlayEvent,e._loadFn,!1),e._node.src=t._src,e._node.preload="auto",e._node.volume=i*n.volume(),e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++n._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,t=e._parent;t._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue()),e._node.removeEventListener(n._canPlayEvent,e._loadFn,!1)}};var o={},a=function(e){var t=e._src;if(o[t])return e._duration=o[t].duration,void l(e);if(/^data:[^;]+;base64,/.test(t)){for(var n=atob(t.split(",")[1]),i=new Uint8Array(n.length),r=0;r<n.length;++r)i[r]=n.charCodeAt(r);u(i.buffer,e)}else{var a=new XMLHttpRequest;a.open("GET",t,!0),a.withCredentials=e._xhrWithCredentials,a.responseType="arraybuffer",a.onload=function(){var t=(a.status+"")[0];if("0"!==t&&"2"!==t&&"3"!==t)return void e._emit("loaderror",null,"Failed loading audio file with status: "+a.status+".");u(a.response,e)},a.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete o[t],e.load())},s(a)}
},s=function(e){try{e.send()}catch(t){e.onerror()}},u=function(e,t){n.ctx.decodeAudioData(e,function(e){e&&t._sounds.length>0&&(o[t._src]=e,l(t,e))},function(){t._emit("loaderror",null,"Decoding audio data failed.")})},l=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},c=function(){try{"undefined"!=typeof AudioContext?n.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?n.ctx=new webkitAudioContext:n.usingWebAudio=!1}catch(e){n.usingWebAudio=!1}var e=/iP(hone|od|ad)/.test(n._navigator&&n._navigator.platform),t=n._navigator&&n._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),i=t?parseInt(t[1],10):null;if(e&&i&&i<9){var r=/safari/.test(n._navigator&&n._navigator.userAgent.toLowerCase());(n._navigator&&n._navigator.standalone&&!r||n._navigator&&!n._navigator.standalone&&!r)&&(n.usingWebAudio=!1)}n.usingWebAudio&&(n.masterGain=void 0===n.ctx.createGain?n.ctx.createGainNode():n.ctx.createGain(),n.masterGain.gain.value=n._muted?0:1,n.masterGain.connect(n.ctx.destination)),n._setup()};t.Howler=n,t.Howl=i,"undefined"!=typeof window?(window.HowlerGlobal=e,window.Howler=n,window.Howl=i,window.Sound=r):"undefined"!=typeof global&&(global.HowlerGlobal=e,global.Howler=n,global.Howl=i,global.Sound=r)}(),function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;for(var n=t._howls.length-1;n>=0;n--)t._howls[n].stereo(e);return t},HowlerGlobal.prototype.pos=function(e,t,n){var i=this;return i.ctx&&i.ctx.listener?(t="number"!=typeof t?i._pos[1]:t,n="number"!=typeof n?i._pos[2]:n,"number"!=typeof e?i._pos:(i._pos=[e,t,n],i.ctx.listener.setPosition(i._pos[0],i._pos[1],i._pos[2]),i)):i},HowlerGlobal.prototype.orientation=function(e,t,n,i,r,o){var a=this;if(!a.ctx||!a.ctx.listener)return a;var s=a._orientation;return t="number"!=typeof t?s[1]:t,n="number"!=typeof n?s[2]:n,i="number"!=typeof i?s[3]:i,r="number"!=typeof r?s[4]:r,o="number"!=typeof o?s[5]:o,"number"!=typeof e?s:(a._orientation=[e,t,n,i,r,o],a.ctx.listener.setOrientation(e,t,n,i,r,o),a)},Howl.prototype.init=function(e){return function(t){var n=this;return n._orientation=t.orientation||[1,0,0],n._stereo=t.stereo||null,n._pos=t.pos||null,n._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},n._onstereo=t.onstereo?[{fn:t.onstereo}]:[],n._onpos=t.onpos?[{fn:t.onpos}]:[],n._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,n){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"stereo",action:function(){i.stereo(t,n)}}),i;var r=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===n){if("number"!=typeof t)return i._stereo;i._stereo=t,i._pos=[t,0,0]}for(var o=i._getSoundIds(n),a=0;a<o.length;a++){var s=i._soundById(o[a]);if(s){if("number"!=typeof t)return s._stereo;s._stereo=t,s._pos=[t,0,0],s._node&&(s._pannerAttr.panningModel="equalpower",s._panner&&s._panner.pan||e(s,r),"spatial"===r?s._panner.setPosition(t,0,0):s._panner.pan.value=t),i._emit("stereo",s._id)}}return i},Howl.prototype.pos=function(t,n,i,r){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"pos",action:function(){o.pos(t,n,i,r)}}),o;if(n="number"!=typeof n?0:n,i="number"!=typeof i?-.5:i,void 0===r){if("number"!=typeof t)return o._pos;o._pos=[t,n,i]}for(var a=o._getSoundIds(r),s=0;s<a.length;s++){var u=o._soundById(a[s]);if(u){if("number"!=typeof t)return u._pos;u._pos=[t,n,i],u._node&&(u._panner&&!u._panner.pan||e(u,"spatial"),u._panner.setPosition(t,n,i)),o._emit("pos",u._id)}}return o},Howl.prototype.orientation=function(t,n,i,r){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"orientation",action:function(){o.orientation(t,n,i,r)}}),o;if(n="number"!=typeof n?o._orientation[1]:n,i="number"!=typeof i?o._orientation[2]:i,void 0===r){if("number"!=typeof t)return o._orientation;o._orientation=[t,n,i]}for(var a=o._getSoundIds(r),s=0;s<a.length;s++){var u=o._soundById(a[s]);if(u){if("number"!=typeof t)return u._orientation;u._orientation=[t,n,i],u._node&&(u._panner||(u._pos||(u._pos=o._pos||[0,0,-.5]),e(u,"spatial")),u._panner.setOrientation(t,n,i)),o._emit("orientation",u._id)}}return o},Howl.prototype.pannerAttr=function(){var t,n,i,r=this,o=arguments;if(!r._webAudio)return r;if(0===o.length)return r._pannerAttr;if(1===o.length){if("object"!==It(o[0]))return i=r._soundById(parseInt(o[0],10)),i?i._pannerAttr:r._pannerAttr;t=o[0],void 0===n&&(t.pannerAttr||(t.pannerAttr={coneInnerAngle:t.coneInnerAngle,coneOuterAngle:t.coneOuterAngle,coneOuterGain:t.coneOuterGain,distanceModel:t.distanceModel,maxDistance:t.maxDistance,refDistance:t.refDistance,rolloffFactor:t.rolloffFactor,panningModel:t.panningModel}),r._pannerAttr={coneInnerAngle:void 0!==t.pannerAttr.coneInnerAngle?t.pannerAttr.coneInnerAngle:r._coneInnerAngle,coneOuterAngle:void 0!==t.pannerAttr.coneOuterAngle?t.pannerAttr.coneOuterAngle:r._coneOuterAngle,coneOuterGain:void 0!==t.pannerAttr.coneOuterGain?t.pannerAttr.coneOuterGain:r._coneOuterGain,distanceModel:void 0!==t.pannerAttr.distanceModel?t.pannerAttr.distanceModel:r._distanceModel,maxDistance:void 0!==t.pannerAttr.maxDistance?t.pannerAttr.maxDistance:r._maxDistance,refDistance:void 0!==t.pannerAttr.refDistance?t.pannerAttr.refDistance:r._refDistance,rolloffFactor:void 0!==t.pannerAttr.rolloffFactor?t.pannerAttr.rolloffFactor:r._rolloffFactor,panningModel:void 0!==t.pannerAttr.panningModel?t.pannerAttr.panningModel:r._panningModel})}else 2===o.length&&(t=o[0],n=parseInt(o[1],10));for(var a=r._getSoundIds(n),s=0;s<a.length;s++)if(i=r._soundById(a[s])){var u=i._pannerAttr;u={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:u.coneInnerAngle,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:u.coneOuterAngle,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:u.coneOuterGain,distanceModel:void 0!==t.distanceModel?t.distanceModel:u.distanceModel,maxDistance:void 0!==t.maxDistance?t.maxDistance:u.maxDistance,refDistance:void 0!==t.refDistance?t.refDistance:u.refDistance,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:u.rolloffFactor,panningModel:void 0!==t.panningModel?t.panningModel:u.panningModel};var l=i._panner;l?(l.coneInnerAngle=u.coneInnerAngle,l.coneOuterAngle=u.coneOuterAngle,l.coneOuterGain=u.coneOuterGain,l.distanceModel=u.distanceModel,l.maxDistance=u.maxDistance,l.refDistance=u.refDistance,l.rolloffFactor=u.rolloffFactor,l.panningModel=u.panningModel):(i._pos||(i._pos=r._pos||[0,0,-.5]),e(i,"spatial"))}return r},Sound.prototype.init=function(e){return function(){var t=this,n=t._parent;t._orientation=n._orientation,t._stereo=n._stereo,t._pos=n._pos,t._pannerAttr=n._pannerAttr,e.call(this),t._stereo?n.stereo(t._stereo):t._pos&&n.pos(t._pos[0],t._pos[1],t._pos[2],t._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this,n=t._parent;return t._orientation=n._orientation,t._pos=n._pos,t._pannerAttr=n._pannerAttr,e.call(this)}}(Sound.prototype.reset);var e=function(e,t){t=t||"spatial","spatial"===t?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.value=e._stereo),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id)}}()}),Os=function(){function e(){Pt(this,e),this.variations=this.findVariations(Ss)}return Tt(e,[{key:"findVariations",value:function(){var e={};for(var t in Ss.sprite){var n=t.split(".");if(n.length>=2){var i=n.pop(),r=n.join(".");e[r]?e[r].push(i):e[r]=[i]}else e[t]=[]}return e}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.variations[e+(t?"_reversed":"")];if(n&&n.length>0)return _t(n)}},{key:"name",value:function(e,t){return e+(arguments.length>2&&void 0!==arguments[2]&&arguments[2]?"_reversed":"")+(t?"."+t:"")}}]),e}(),Is=function(){function e(){Pt(this,e),this.variations=new Os,this.howler=new zs.Howl(Ss),this.queue=[],this.frameId=0}return Tt(e,[{key:"play",value:function(){++this.frameId;var e=!0,t=!1,n=void 0;try{for(var i,r=this.queue[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var o=i.value;o&&this.howler.play(o)}}catch(e){t=!0,n=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw n}}this.queue=[]}},{key:"add",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t=t||this.variations.get(e,n),this.queue.push(this.variations.name(e,t,n)),!n)return this.createReversedSoundCallback(e,t,this.frameId,this.queue.length-1)}},{key:"createReversedSoundCallback",value:function(e,t,n,i){var r=this;return function(){r.frameId===n?delete r.queue[i]:r.add(e,t,!0)}}}]),e}(),Ps=new Is,Ts=function(){function e(t,n){Pt(this,e),this.entity=t,this.timeEntity=n||t,this.timeImmune=gt(this.timeEntity)}return Tt(e,[{key:"undo",value:function(){return!this.timeImmune&&!gt(this.timeEntity)&&!!lt(this,"rollback")}},{key:"redo",value:function(){this.timeImmune||gt(this.timeEntity)||lt(this,"execute")}}]),e}(),Es=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.entity));return n.event=e,n}return jt(t,e),Tt(t,[{key:"invokeLogicType",value:function(e,t,n,i,r){var o=Object.assign({},this.event,{baseEntity:i}),a=new e(o);if(r)return!!t.addChild(a)||(t.rollbackLast(),!1);n.push(a)}},{key:"invokeLogicComponent",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!i||n.toString()!==i.toString()){var o=n.get("logic");if(o&&this.event.type in o){var a=o[this.event.type];if("function"==typeof a)return this.invokeLogicType(a,e,t,n,r);if(Array.isArray(a)){var s=!0,u=!1,l=void 0;try{for(var c,d=a[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;if(!1===this.invokeLogicType(h,e,t,n,r))return!1}}catch(e){u=!0,l=e}finally{try{!s&&d.return&&d.return()}finally{if(u)throw l}}}}}return!0}},{key:"execute",value:function(e){var t=[],n=this.event.entity;if(this.event.position){var i=is.getSorted(this.event.position),r=!0,o=!1,a=void 0;try{for(var s,u=i[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var l=s.value;this.invokeLogicComponent(e,t,l,n)}}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}}else this.invokeLogicComponent(e,t,this.event.entity,void 0);return t}}]),t}(Ts),js=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.entity));return n.event=e,n.entity=e.entity,n.direction=e.direction,n}return jt(t,e),Tt(t,[{key:"execute",value:function(){var e=this.entity.get("position"),t=this.entity.get("direction");return this.oldPosition={x:e.x,y:e.y},t&&(this.oldDirection={x:t.x,y:t.y}),e.set(e.x+this.direction.x,e.y+this.direction.y),t&&(t.x=this.direction.x,t.y=this.direction.y),1!==is.get(e).size&&(this.event.suppressEvents||this.event.entity.has("suppressEvents")?void 0:[new Es({type:"exit",position:this.oldPosition,newPosition:{x:e.x,y:e.y},direction:this.direction,entity:this.entity}),new Es({type:"moved",from:this.oldPosition,to:{x:e.x,y:e.y},direction:this.direction,entity:this.entity,movedBy:this.event.movedBy}),new Es({type:"enter",position:{x:e.x,y:e.y},oldPosition:this.oldPosition,direction:this.direction,entity:this.entity})])}},{key:"rollback",value:function(){var e=this.entity.get("position"),t=this.entity.get("direction");return e&&e.set(e.x-this.direction.x,e.y-this.direction.y),t&&(t.x=this.oldDirection.x,t.y=this.oldDirection.y),!0}}]),t}(Ts),Ms=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.entity=e,n}return jt(t,e),Tt(t,[{key:"execute",value:function(){is.remove(this.entity),this.entity.has("sprite")&&this.entity.get("sprite").onRemove(),this.entity.detach()}},{key:"rollback",value:function(){return this.entity.attach(Ya),this.entity.has("sprite")&&this.entity.get("sprite").onCreated(),is.update(this.entity),!0}}]),t}(Ts),Ds=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,void 0));return n.event=e,n}return jt(t,e),Tt(t,[{key:"execute",value:function(){var e={name:this.event.create,position:{x:this.event.at.x,y:this.event.at.y},spritePosition:rs.getVisualPosition(this.event.at),layer:5};this.entity=rs.createEntity(e,this.event.zIndex||10),Dt(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"entity",this.entity,this),lt(this.event,"thenCall",this.entity)}},{key:"rollback",value:function(){return this.entity.destroy(),!0}}]),t}(Ts),Cs=function(){function e(t){Pt(this,e),this.event=t}return Tt(e,[{key:"execute",value:function(){var e=[],t=is.find.apply(is,[this.event.position,void 0].concat(Ct(this.event.has)));return t&&e.push(new Ms(t)),e}}]),e}(),Ls=function(e){function t(e,n){Pt(this,t);var i=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.baseEntity=e,i.entityToAttach=n,i.platform=e.get("platform"),i.attachable=n.get("attachable"),i}return jt(t,e),Tt(t,[{key:"execute",value:function(){this.platform&&this.attachable&&(this.originalAttached=this.attachable.attached,this.originalHolding=this.platform.holding,this.attachable.attached=this.baseEntity,this.platform.holding=this.entityToAttach,this.entityToAttach.has("inputMovement")&&(this.baseEntity.set("inputMovement"),this.entityToAttach.remove("inputMovement")))}},{key:"rollback",value:function(){if(this.platform&&this.attachable)return this.attachable.attached=this.originalAttached,this.platform.holding=this.originalHolding,this.baseEntity.has("inputMovement")&&(this.baseEntity.remove("inputMovement"),this.entityToAttach.set("inputMovement")),!0}}]),t}(Ts),Bs=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.baseEntity=e,n.platform=e.get("platform"),n.attachable=n.platform.holding.get("attachable"),n}return jt(t,e),Tt(t,[{key:"execute",value:function(){this.platform&&this.attachable&&(this.originalAttached=this.attachable.attached,this.originalHolding=this.platform.holding,this.originalAttached&&this.originalAttached.has("inputMovement")&&(this.originalHolding.set("inputMovement"),this.originalAttached.remove("inputMovement")),this.attachable.attached=void 0,this.platform.holding=void 0)}},{key:"rollback",value:function(){if(this.platform&&this.attachable)return this.originalHolding&&this.originalHolding.has("inputMovement")&&(this.originalHolding.remove("inputMovement"),this.originalAttached.set("inputMovement")),this.attachable.attached=this.originalAttached,this.platform.holding=this.originalHolding,!0}}]),t}(Ts),Fs=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.baseEntity));return n.event=e,n}return jt(t,e),Tt(t,[{key:"move",value:function(e){var t=this.event.entity.get("time"),n=new js({entity:this.event.baseEntity,direction:this.event.direction,movedBy:this.event.entity});return n.optional=e,[new qs(this.event.baseEntity,"time",void 0,t),n,new qs(this.event.baseEntity,"time",void 0,t)]}},{key:"getFutureBlockPosition",value:function(){return is.getWrapped({x:this.event.position.x+this.event.direction.x,y:this.event.position.y+this.event.direction.y})}},{key:"execute",value:function(){var e=is.find(this.event.oldPosition,void 0,"terrain");if(this.event.baseEntity.has("floats")&&this.event.baseEntity.get("floats").floating){if(e&&"space"===e.get("terrain")&&!e.has("bridged")){var t=is.find(this.event.position,void 0,"terrain"),n=is.find(this.getFutureBlockPosition(),void 0,"terrain");return!(!n||"space"!==n.get("terrain")||!this.event.entity.has("pushes"))&&[new Ns(t,"bridged",this.event.baseEntity)].concat(Ct(this.move()))}return!0}return!!this.event.entity.has("pushes")&&this.move(this.event.baseEntity.has("enterable"))}}]),t}(Ts),Ws=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.baseEntity));return n.event=e,n}return jt(t,e),Tt(t,[{key:"execute",value:function(){return new Rs("block_slide",this.event.baseEntity)}}]),t}(Ts),Gs=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.baseEntity));return n.event=e,n}return jt(t,e),Tt(t,[{key:"execute",value:function(){return this.event.baseEntity.has("floats")&&this.event.baseEntity.get("floats").floating}}]),t}(Ts),qs=function(e){function t(e,n,i,r,o){Pt(this,t);var a=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o));return a.component=n,a.property=i,a.value=r,a.previous=i?e.get(n)[i]:e.get(n),a}return jt(t,e),Tt(t,[{key:"execute",value:function(){this.property?this.entity.get(this.component)[this.property]=this.value:this.entity.set(this.component,this.value)}},{key:"rollback",value:function(){return this.property?this.entity.get(this.component)[this.property]=this.previous:this.previous?this.entity.set(this.component,this.previous):this.entity.remove(this.component),!0}}]),t}(Ts),Rs=(function(e){function t(e,n,i){Pt(this,t);var r=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i));r.name=n;var o=e.get("sprite");return o&&(r.previous=o.name),r}jt(t,e),Tt(t,[{key:"execute",value:function(){var e=this.entity.get("sprite");e&&e.set(this.name)}},{key:"rollback",value:function(){var e=this.entity.get("sprite");if(e)return e.set(this.previous)}}])}(Ts),function(e){function t(e){var n;Pt(this,t);for(var i=arguments.length,r=Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];var a=Mt(this,(n=t.__proto__||Object.getPrototypeOf(t)).call.apply(n,[this].concat(r)));return a.sound=e,a}return jt(t,e),Tt(t,[{key:"execute",value:function(){this.playReversed=Ps.add(this.sound)}},{key:"rollback",value:function(){return this.playReversed(),!0}}]),t}(Ts)),Ns=function(e){function t(e,n){var i;Pt(this,t);for(var r=arguments.length,o=Array(r>2?r-2:0),a=2;a<r;a++)o[a-2]=arguments[a];var s=Mt(this,(i=t.__proto__||Object.getPrototypeOf(t)).call.apply(i,[this].concat(o)));return s.entity=e,s.component=n,s}return jt(t,e),Tt(t,[{key:"execute",value:function(){this.entity&&(this.previous=this.entity.get(this.component),this.entity.remove(this.component))}},{key:"rollback",value:function(){if(this.entity)return this.entity.set(this.component,this.previous),!0}}]),t}(Ts);Ya.system([],function(){function e(){Pt(this,e),this.actionStack=new ks}return Tt(e,[{key:"move",value:function(e,t,n){if(0!==t.x||0!==t.y)return this.actionStack[n](new js({entity:e,direction:{x:t.x,y:t.y}}))}},{key:"handleMovement",value:function(e){var t=e.get("forcedMovement"),n=e.get("inputMovement");if(t){if(!e.has("tween")){var i=this.move(e,t.direction,"pushToLast");!1===i&&e.remove("forcedMovement")}}else n&&this.move(e,n.currentDirection,"push")}},{key:"pre",value:function(){var e=this;$a.loop("loaded",function(t){e.actionStack.reset()}),$a.process("undo",function(){e.actionStack.pop()});var t=new Set,n=Ya.every(["position","forcedMovement"]),i=Ya.every(["position","inputMovement"]),r=!0,o=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var l=s.value;t.add(l.toString())}}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}var c=!0,d=!1,h=void 0;try{for(var f,p=i[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var v=f.value;t.add(v.toString())}}catch(e){d=!0,h=e}finally{try{!c&&p.return&&p.return()}finally{if(d)throw h}}var _=!0,y=!1,m=void 0;try{for(var g,b=t[Symbol.iterator]();!(_=(g=b.next()).done);_=!0){var k=g.value,w=Ya.entities[k];w&&w.valid()&&this.handleMovement(w)}}catch(e){y=!0,m=e}finally{try{!_&&b.return&&b.return()}finally{if(y)throw m}}}}]),e}()),Ya.system(["sprite","direction","directionSprite"],function(){function e(){Pt(this,e)}return Tt(e,[{key:"every",value:function(e,t,n){var i=n.directions[at(t)]||n.directions.default;i&&e.set(i)}}]),e}());var Us=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.baseEntity));return n.event=e,n}return jt(t,e),Tt(t,[{key:"execute",value:function(){this.event.baseEntity.has("inWorld")&&kt(this.event.to);var e=yt(is,this.event.to);return new Rs("player_walk_"+e,this.event.baseEntity)}},{key:"rollback",value:function(){if(this.event.baseEntity.has("inWorld"))return kt(this.event.from),!0}}]),t}(Ts);Ya.system([],function(){function e(){Pt(this,e)}return Tt(e,[{key:"initialize",value:function(){this.player=this.createPlayer(bt(),!0)}},{key:"pre",value:function(){var e=this;$a.process("resetPlayer",function(t){e.player.destroy(),e.player=e.createPlayer(t.position)})}},{key:"createPlayer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=rs.getVisualPosition(e),i=Ya.entity();return i.set("player").set("inputMovement").set("position",e.x,e.y).set("sprite",ns,"player_down",30,n).set("cameraFollows").set("pushes").set("presses").set("attachable").set("swims").set("waterSupply").set("direction",{x:0,y:1}).set("directionSprite",{default:"player_down","0,1":"player_down","1,0":"player_right","0,-1":"player_up","-1,0":"player_left"}).set("logic",{moved:Us}),(t||rs.inWorld())&&i.set("inWorld"),i}}]),e}());var Hs=function(e){function t(e){return Pt(this,t),Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.baseEntity))}return jt(t,e),Tt(t,[{key:"execute",value:function(){return!1}}]),t}(Ts);Ya.system(["computeWallShape"],function(){function e(){Pt(this,e)}return Tt(e,[{key:"initialize",value:function(){var e=this;rs.loadOnWorld("wall"),rs.register(["wall"],function(t,n){e.createWallEntity(t)})}},{key:"createWallEntity",value:function(e){e.set("blocksMovement").set("wall").set("computeWallShape").set("logic",{enter:Hs})}},{key:"every",value:function(e,t){var n=wt(t,"wall",[0,-1],[1,0],[0,1],[-1,0]),i=n.map(function(e,t){return e?"trbl"[t]:null}).filter(function(e){return e}).join(""),r="wall_"+(i||"none");t.get("sprite").set(r),t.remove("computeWallShape")}}]),e}());var Vs=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.baseEntity));return n.event=e,n}return jt(t,e),Tt(t,[{key:"execute",value:function(){return!0}}]),t}(Ts),Ks=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.baseEntity));return n.event=e,n}return jt(t,e),Tt(t,[{key:"execute",value:function(){if(this.event.entity.has("floats")&&!this.event.baseEntity.has("bridged"))return[new qs(this.event.entity,"floats","floating",!0),new qs(this.event.entity,"sprite","zIndex",18),new qs(this.event.baseEntity,"bridged",void 0,void 0,this.event.entity),new Rs("build_bridge",this.event.entity)];var e=is.find(this.event.oldPosition,void 0,"terrain"),t=e?e.get("terrain"):"floor";return!(!this.event.baseEntity.has("bridged")||"space"===t&&!e.has("bridged"))||("space"===t&&!e.has("bridged")||this.event.entity.has("vehicle"))}}]),t}(Ts),Xs=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.baseEntity));return n.event=e,n}return jt(t,e),Tt(t,[{key:"execute",value:function(){return!!this.event.baseEntity.has("bridged")||"space"===yt(is,this.event.newPosition)}}]),t}(Ts),$s=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.baseEntity));return n.event=e,n}return jt(t,e),Tt(t,[{key:"execute",value:function(){return!this.event.entity.has("player")&&(this.event.entity.has("platform")?void 0:new Ms(this.event.entity))}}]),t}(Ts),Js=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.baseEntity));return n.event=e,n}return jt(t,e),Tt(t,[{key:"execute",value:function(){this.event.entity.set("forcedMovement",this.event.direction)}},{key:"rollback",value:function(){return this.event.entity.remove("forcedMovement"),!0}}]),t}(Ts),Qs=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.baseEntity));return n.event=e,n.direction=void 0,n}return jt(t,e),Tt(t,[{key:"execute",value:function(){var e=this.event.entity.get("forcedMovement");e&&(this.direction=e.direction,this.event.entity.remove("forcedMovement"))}},{key:"rollback",value:function(){if(this.direction)return this.event.entity.set("forcedMovement",this.direction),!0}}]),t}(Ts),Ys=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.baseEntity));return n.event=e,n}return jt(t,e),Tt(t,[{key:"execute",value:function(){return!0}}]),t}(Ts);Ya.system([],function(){function e(){Pt(this,e)}return Tt(e,[{key:"initialize",value:function(){rs.register(["floor"],function(e){e.set("terrain","floor"),e.set("logic",{enter:Vs})}),rs.register(["space"],function(e){e.set("terrain","space"),e.get("sprite").zIndex=21,e.set("logic",{enter:Ks,exit:Xs})}),rs.register(["lava"],function(e){e.set("terrain","lava"),e.set("logic",{enter:$s})}),rs.register(["ice"],function(e){e.set("terrain","ice"),e.set("logic",{exit:Qs,enter:Js})}),rs.register(["grass"],function(e){e.set("terrain","grass"),e.set("logic",{enter:Ys})})}}]),e}());var Zs=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.baseEntity));return n.event=e,n}return jt(t,e),Tt(t,[{key:"execute",value:function(){return!0}}]),t}(Ts),eu=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.baseEntity));return n.event=e,n}return jt(t,e),Tt(t,[{key:"execute",value:function(){return!0}}]),t}(Ts);Ya.system([],function(){function e(){Pt(this,e)}return Tt(e,[{key:"initialize",value:function(){rs.middleware(function(e){var t=e.entity,n=e.tile;if(n.name.startsWith("soil_")){t.set("terrain","soil"),t.set("logic",{exit:eu,enter:Zs});var i=n.name.split("_"),r=parseInt(i[2],10)||0,o="watered"===i[3];t.set("watered",o),t.set("plantedSeeds",r)}})}}]),e}());var tu=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.entity));return n.event=e,n}return jt(t,e),Tt(t,[{key:"execute",value:function(){var e=this.event.entity.get("waterSupply");e&&(this.previous=e.refill())}},{key:"rollback",value:function(){var e=this.event.entity.get("waterSupply");e&&void 0!==this.previous&&e.refill(this.previous)}}]),t}(Ts),nu=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.entity));return n.event=e,n}return jt(t,e),Tt(t,[{key:"execute",value:function(){var e=this.event.entity.get("waterSupply");e&&(this.previous=e.current,this.previousMax=e.max,++e.max,this.event.full&&++e.current)}},{key:"rollback",value:function(){var e=this.event.entity.get("waterSupply");e&&void 0!==this.previousMax&&(e.current=this.previous,e.max=this.previousMax)}}]),t}(Ts),iu=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.baseEntity));return n.event=e,n}return jt(t,e),Tt(t,[{key:"execute",value:function(){return console.log("EnterWater"),!!this.event.entity.has("swims")&&(console.log("RefillWaterSupply"),new tu(this.event))}}]),t}(Ts),ru=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.baseEntity));return n.event=e,n}return jt(t,e),Tt(t,[{key:"execute",value:function(){return console.log("EnterWateringCan"),!!this.event.entity.has("waterSupply")&&(console.log("IncreaseMaxWaterSupply"),[new nu({entity:this.event.entity,full:!!this.event.baseEntity.get("wateringCan")}),new Ms(this.event.baseEntity)])}}]),t}(Ts);Ya.system([],function(){function e(){Pt(this,e)}return Tt(e,[{key:"initialize",value:function(){rs.register(["water"],function(e){e.set("terrain","water"),e.set("logic",{enter:iu})}),rs.register(["watering_can_full","watering_can_empty"],function(e,t){e.set("wateringCan","watering_can_full"===t.name),e.set("logic",{enter:ru})})}}]),e}()),Ya.system([],function(){function e(){Pt(this,e)}return Tt(e,[{key:"initialize",value:function(){rs.register(["seeds"],function(e){e.set("logic",{enter:Fs,exit:Gs})})}}]),e}()),Ya.system([],function(){function e(){Pt(this,e),this.currentPuzzle=null,this.lastPuzzle=null}return Tt(e,[{key:"pre",value:function(){var e=this;$a.process("restart",function(){e.enterLevel(e.currentPuzzle)}),$a.process("enterLevel",function(t){e.enterLevel(t)}),$a.process("exitLevel",function(t){e.exitLevel(t)})}},{key:"enterLevel",value:function(e){e&&($a.send("loadTiles",{layer:e.layer,puzzle:e}),this.currentPuzzle=e,$a.send("resetPlayer",{position:this.currentPuzzle.position}))}},{key:"exitLevel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.currentPuzzle&&($a.send("resetPlayer",{position:this.currentPuzzle.position}),"portal_solved"!==this.currentPuzzle.state&&(this.currentPuzzle.state=e?"portal_solved":"portal_unsolved"),$a.send("updatePuzzlePortal",{layer:this.currentPuzzle.layer,state:this.currentPuzzle.state}),$a.send("loadTiles",{layer:"world",puzzle:this.currentPuzzle}),this.currentPuzzle=null)}}]),e}());var ou=function(){function e(t){Pt(this,e),this.event=t}return Tt(e,[{key:"execute",value:function(){if(this.event.entity.has("player")){var e=this.event.baseEntity.get("puzzlePortal").puzzle;$a.send("enterLevel",e)}}},{key:"rollback",value:function(){return $a.send("exitLevel"),!0}}]),e}();Ya.system(["puzzlePortal"],function(){function e(){Pt(this,e)}return Tt(e,[{key:"initialize",value:function(){rs.register(["portal_unexplored","portal_unsolved","portal_solved"],function(e,t){var n="lvl-"+t.id;t.name=as.get(n,t.name),e.get("sprite").set(t.name),e.get("sprite").zIndex=8,e.set("puzzlePortal",{layer:n,position:t.position,state:t.name,tileId:t.id}).set("logic",{enter:ou})})}},{key:"pre",value:function(){as.update()}}]),e}());var au=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.baseEntity));return n.event=e,n.platform=n.event.baseEntity.get("platform"),n}return jt(t,e),Tt(t,[{key:"execute",value:function(){var e=this,t=[];return this.platform.holding&&t.push(new js({entity:this.platform.holding,direction:this.event.direction,suppressEvents:!0})),this.event.movedBy||t.push(new Ds({create:"pollution",at:this.event.from,thenCall:function(t){return e.createPollution(t)}})),t}},{key:"createPollution",value:function(e){e.set("pollution"),e.set("logic",{enter:function(){function e(){Pt(this,e)}return Tt(e,[{key:"execute",value:function(){return!1}}]),e}()})}}]),t}(Ts),su=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.baseEntity));return n.event=e,n.platform=n.event.baseEntity.get("platform"),n}return jt(t,e),Tt(t,[{key:"execute",value:function(e){var t=void 0;if(this.event.entity.has("pushes")){if(t=e.addChild(new js({entity:this.event.baseEntity,direction:this.event.direction,movedBy:this.event.entity})))return!0;e.rollbackLast()}var n=this.event.entity.get("platform");if(!1===t&&n&&n.holding&&n.holding.has("player")){
var i=[];return this.platform.holding&&(i.push(new Bs(this.event.baseEntity)),i.push(new js({entity:this.platform.holding,direction:this.event.direction}))),i.push(new Bs(this.event.entity)),i.push(new Ls(this.event.baseEntity,n.holding)),i.push(new js({entity:this.event.entity,direction:{x:-this.event.direction.x,y:-this.event.direction.y},suppressEvents:!0})),i.push(new Cs({position:this.event.oldPosition,has:["pollution"]})),i}if(!1===t&&this.event.entity.has("attachable")){var r=[];return this.platform.holding&&(r.push(new Bs(this.event.baseEntity)),r.push(new js({entity:this.platform.holding,direction:this.event.direction}))),r.push(new Ls(this.event.baseEntity,this.event.entity)),r}return!1}}]),t}(Ts);Ya.system([],function(){function e(){Pt(this,e)}return Tt(e,[{key:"initialize",value:function(){var e=this;rs.register(["vehicle"],function(t,n){e.createVehicle(t,n)})}},{key:"createVehicle",value:function(e,t){e.set("vehicle").set("platform").set("pushes").set("goal",!0).set("logic",{moved:au,enter:su}),e.get("sprite").zIndex=27}}]),e}());var uu=function(){function e(t){Pt(this,e),this.event=t}return Tt(e,[{key:"execute",value:function(){this.event.entity.has("timeImmune")||(this.event.entity.set("timeImmune"),this.event.baseEntity.destroy())}}]),e}();Ya.system([],function(){function e(){Pt(this,e)}return Tt(e,[{key:"initialize",value:function(){rs.middleware(function(e){var t=e.entity,n=e.tile;n.name.endsWith("_ti")&&(t.set("timeImmune",!0),n.name=n.name.slice(0,-"_ti".length))}),rs.register(["time_immune_changer"],function(e,t){e.set("timeImmuneChanger"),e.set("logic",{enter:uu})})}}]),e}());var lu=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.event=e,n.goal=n.event.baseEntity.get("goal"),n.previousState=n.goal.solved,n.buttonGoal=xt(n.event.to),n}return jt(t,e),Tt(t,[{key:"execute",value:function(){var e=[];return this.goal.solved!==this.buttonGoal&&e.push(new Rs(this.buttonGoal?"block_activated":"block_deactivated",this.event.baseEntity)),this.goal.solved=this.buttonGoal,[Et(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",this).call(this)].concat(e)}},{key:"rollback",value:function(){if(this.goal.solved!==this.previousState)return this.goal.solved=this.previousState,!0}}]),t}(Ws);Ya.system([],function(){function e(){Pt(this,e)}return Tt(e,[{key:"initialize",value:function(){var e=this;rs.register(["block_basic"],function(t,n){e.createBlockEntity(t,n)}),rs.register(["block_stabilizer","block_stabilizer_on"],function(t,n){e.createBlockEntity(t,n),t.set("goal",xt(t.get("position")),"block_stabilizer","block_stabilizer_on"),t.set("usesEnergy"),t.get("logic").moved=lu})}},{key:"createBlockEntity",value:function(e,t){e.set("block").set("floats"),e.get("sprite").zIndex=25,e.set("logic",{enter:Fs,moved:Ws,exit:Gs})}}]),e}());var cu={down:{x:0,y:1},right:{x:1,y:0},up:{x:0,y:-1},left:{x:-1,y:0}};Ya.system([],function(){function e(){Pt(this,e)}return Tt(e,[{key:"initialize",value:function(){rs.register(["block_mirror_1","block_mirror_2"],function(e){e.set("logic",{enter:Fs,exit:Gs})}),rs.register(["light_beam"],function(e){e.set("light")}),rs.middleware(function(e){var t=e.entity,n=e.tile;if(n.name.startsWith("block_light_")){t.set("logic",{enter:Fs,exit:Gs});var i=n.name.split("_"),r=i[2];t.set("emitsLight",cu[r])}})}}]),e}());var du=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.baseEntity));return n.event=e,n}return jt(t,e),Tt(t,[{key:"solved",value:function(){return this.event.entity.has("player")&&this.event.baseEntity.get("puzzleGoal").completed}},{key:"execute",value:function(e){this.solved()&&$a.send("exitLevelAttempt")}},{key:"rollback",value:function(){this.solved()&&$a.clear("exitLevelAttempt")}}]),t}(Ts),hu=function(e){function t(e){Pt(this,t);var n=Mt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.baseEntity));return n.event=e,n}return jt(t,e),Tt(t,[{key:"execute",value:function(){$a.exists("exitLevelAttempt")&&(this.old=$a.data.exitLevelAttempt,$a.clear("exitLevelAttempt"))}},{key:"rollback",value:function(){this.old&&($a.data.exitLevelAttempt=this.old)}}]),t}(Ts);Ya.system(["puzzleGoal"],function(){function e(){Pt(this,e),this.solved=!0}return Tt(e,[{key:"initialize",value:function(){var e=this;rs.register(["block_portal","block_portal_on"],function(t,n){var i="block_portal_on"===n.name;t.set("block").set("floats").set("puzzleGoal",i).set("logic",{enter:[du,Fs],moved:[Ws,hu],exit:Gs}),t.get("sprite").zIndex=25,e.setEnterable(t,i)})}},{key:"setEnterable",value:function(e,t){t?e.set("enterable"):e.remove("enterable")}},{key:"pre",value:function(){var e=this;this.solved=!0,Ya.every(["goal"],function(t,n){t.solved||(e.solved=!1)})}},{key:"every",value:function(e,t){if(e.completed!==this.solved){e.completed=this.solved;var n=t.get("sprite");n&&n.set(e.completed?"block_portal_on":"block_portal"),this.setEnterable(t,this.solved)}}},{key:"post",value:function(){var e=this;$a.process("exitLevelAttempt",function(){setTimeout(function(){e.solved&&$a.send("exitLevel",!0)},300)})}}]),e}()),Ya.system([],function(){function e(){Pt(this,e)}return Tt(e,[{key:"initialize",value:function(){rs.register(["energy_source"],function(e,t){e.set("energySource"),e.get("sprite").zIndex=15})}}]),e}()),Ya.system([],function(){function e(){Pt(this,e)}return Tt(e,[{key:"pre",value:function(){Ps.play()}}]),e}()),Ya.system(["sprite","position","positionChanged"],function(){function e(){Pt(this,e)}return Tt(e,[{key:"every",value:function(e,t,n,i){var r=i.get("time")||60,o=rs.getVisualPosition(t),a=void 0;if(t.previous&&(Math.abs(t.x-t.previous.x)>1||Math.abs(t.y-t.previous.y)>1)){var s={x:t.previous.x>t.x?-1:t.previous.x<t.x?1:0,y:t.previous.y>t.y?-1:t.previous.y<t.y?1:0};a={x:t.x+s.x,y:t.y+s.y},a=rs.getVisualPosition(a)}i.set("tween",a,o,r),i.remove("positionChanged"),t.previous={x:t.x,y:t.y}}}]),e}()),Ya.system(["tween"],function(){function e(){Pt(this,e)}return Tt(e,[{key:"every",value:function(e,t,n){e.update(1e3*n,function(){t.remove("time")})}}]),e}()),Ya.system(["cameraFollows","sprite"],function(){function e(){Pt(this,e)}return Tt(e,[{key:"every",value:function(e,t,n){var i=t.sprite.position;$a.exists("updateCamera")&&(e.update(),$a.clear("updateCamera")),this.centerCamera(i,e),e.center=!1,i.x>e.deadzone.x+e.deadzone.width&&(e.deadzone.x=i.x-e.deadzone.width),i.x<e.deadzone.x&&(e.deadzone.x=i.x),i.y>e.deadzone.y+e.deadzone.height&&(e.deadzone.y=i.y-e.deadzone.height),i.y<e.deadzone.y&&(e.deadzone.y=i.y);es.x,es.y;os.bounds&&(es.x=(-e.deadzone.x+e.borderSize.x+os.bounds.x)*es.scale.x,es.y=(-e.deadzone.y+e.borderSize.y+os.bounds.y)*es.scale.y)}},{key:"centerCamera",value:function(e,t){t.deadzone.x=e.x-t.deadzone.width/2,t.deadzone.y=e.y-t.deadzone.height/2}}]),e}());Ya.system([],function(){function e(){Pt(this,e)}return Tt(e,[{key:"initialize",value:function(){var e=this;this.previousWorldScale=os.scale,this.lastInWorld=!0,window.onresize=function(t){rs.layer&&e.handleResize()}}},{key:"pre",value:function(){var e=this;$a.loop("loaded",function(t){var n=rs.inWorld();n?e.scaleWorld():e.scalePuzzle(),e.lastInWorld=n})}},{key:"handleResize",value:function(){Ua.update(),Za.renderer.resize(Ua.gameSize.width,Ua.gameSize.height),$a.send("updateCamera"),$a.send("windowResized")}},{key:"scalePuzzle",value:function(){this.lastInWorld&&(this.previousWorldScale=os.scale),Ua.update();var e=Ua.puzzleSize,t=Ua.gameSize,n=t.width/t.height,i=e.width/e.height;os.scale=n<i?t.width/e.width*.75:t.height/e.height*.75}},{key:"scaleWorld",value:function(){os.scale=this.previousWorldScale}}]),e}()),Ya.system([],function(){function e(){Pt(this,e)}return Tt(e,[{key:"pre",value:function(){!$a.exists("loaded")&&this.bounds||(this.bounds=ns.getBucket(1).getBounds()),os.update(this.bounds),$a.exists("loaded")&&(os.fullUpdate=!0)}}]),e}()),window.onload=At}();
